<apex:page showHeader="false" sidebar="false" renderAs="pdf" controller="AMS_VoucherPDFGeneratorController" applyBodyTag="false" >
    <apex:stylesheet value="{!$Resource.voucherpdfgeneratorpage}"/>
    <apex:variable value="{!0}" var="rowNum"/>
    <apex:repeat value="{!vouchersToPrintList}" var="voucher">
        <apex:outputPanel rendered="{!MOD(rowNum, 3) == 0}" layout="none">
            <div id="page" style="min-height: 291mm; border: 1mm solid none;">
        </apex:outputPanel>
            <div id="voucherContent" style="width: 99%; height: 95mm; border: 1mm solid none; display: block;">
                <div id="voucherAddress" style="width: 50%; display: block; float:left;">                    
                    <div id="street" style="margin-left: 32.79mm;margin-top: 39.29mm;">
                        <apex:outputText value="{0}-{1} {2}">
                        	<apex:param value="{!LEFT(voucher.Voucher_Information__r.Account__r.IATACode__c, 2)}"/>
                        	<apex:param value="{!RIGHT(LEFT(voucher.Voucher_Information__r.Account__r.IATACode__c, 3), 2)}"/>
                        	<apex:param value="{!RIGHT(LEFT(voucher.Voucher_Information__r.Account__r.IATACode__c, 7), 4)}"/>
                        </apex:outputText>                           
                    </div>
                    <div id="city" style="margin-left: 32.79mm;">
                        <apex:outputText value="{!voucher.Voucher_Information__r.Account__r.Name}"/>
                    </div>
                    <div id="state" style="margin-left: 32.79mm;">
                        <apex:outputText value="{!voucher.Voucher_Information__r.Account__r.BillingStreet}"/>
                    </div>
                    <div id="postalCode" style="margin-left: 32.79mm;"> 
                        <apex:outputText value="{!voucher.Voucher_Information__r.Account__r.BillingPostalCode} {!voucher.Voucher_Information__r.Account__r.BillingCity}"/>
                    </div>
					<div id="country" style="margin-left: 32.79mm;">
                        <apex:outputText value="{!voucher.Voucher_Information__r.Account__r.BillingCountry}"/>
                    </div>
                </div>
                <div id="voucherInfo">
                    <div id="voucherYear" style="margin-top: 33.58mm; margin-left:159.04mm; position: absolute;">
                        <apex:outputText value="{!voucher.Voucher_Information__r.Year__c}"/>
                    </div>
                    <div id="voucherName" style="margin-top: 47.13mm; margin-left:151.21mm; position: absolute;">
                        <apex:outputText value="{!voucher.Name}"/>
                    </div>
                    <div id="voucherNumber" style="margin-top: 61.45mm; margin-left:151.21mm; position: absolute;">
                    	<apex:outputText style="white-space:nowrap;" value="{!voucher.SequenceNumber__c}"/>
                    </div>
                </div>
            </div>
        <apex:outputPanel rendered="{!MOD(rowNum, 3) == 2}" layout="none">
            </div>
            <div style="page-break-after:always;"/>
        </apex:outputPanel> 
        <apex:variable var="rowNum" value="{!rowNum + 1}"/>        
    </apex:repeat>
</apex:page>