<apex:page controller="ANG_ConversionToolController" showHeader="true" tabStyle="ANG_Conversion_Tool__tab">

	<apex:sectionHeader title="Agencies migration tool: exception management" />   
	<apex:PageBlock id="pb"  >
		<apex:pageBlockSection title="Exception management" collapsible="false" id="Overview"  rendered="true" columns="1">
			<h1>Hierarchies with branches abroad</h1>
			<br />
			The system identified some hierarchies containing branches abroad. There are an exception because the Multicountry accreditation type is not supported yet.
			<br /><br />
			<h1>Workaround</h1>
			<br />
			The system will convert all the hierarchies selected by the Use applying the following rules:
			<ul>
				<li>Branches abroad will be converted in AE but they may have the flag "Is New Gen Agency" set to false!</li>
				<li>The location class will not be changed for any Agency so the flag "Is New Gen Agency" may still be false for some agencies</li>
			</ul>
		</apex:pageBlockSection>
		
		<apex:pageBlockSection title="{!DetailMessage}, ISO country: {!selectedCountryName}" collapsible="true" id="exList"  rendered="true" columns="1">
		<br /><br />
			<apex:form >
				<table style="width:60%;padding: 0px;border: 0px;border-spacing: 0px;">
					<tr>
						<td>		
							<apex:pageBlockTable value="{!DetailTable}" var="tbl" frame="vsides" >
								<apex:column headerValue="Select/Unselect all">
									<apex:facet name="header">
										<apex:inputCheckbox onclick="checkAll(this,'checkedone')"/>
									</apex:facet>
									<apex:inputCheckbox value="{!tbl.selected}" id="checkedone" />
								</apex:column>
								<apex:column headerValue="Hierarchy Top Parent">
									<apex:outputLink value="/{!tbl.struct.topParentId}" id="accLink">{!tbl.struct.nameTopParent}</apex:outputLink>
								</apex:column>
								<apex:column value="{!tbl.struct.iataCodeTopParent}" headerValue="IATA Code Top Parent" />
							</apex:pageBlockTable>
						</td>
					</tr>
					
					<tr>
						<td >
						<br /><br /><br /><br /><br /><br />	
						</td>
					</tr>
					<tr>
						<td style="border:0px #dddddd;text-align:center">
							<apex:commandButton action="{!migrateSelectedHierarchies}" value="Migrate selected hierarchies" rendered="true"  />
                            <apex:commandButton action="{!backToMainPage}" value="Back to the main page" rendered="true"  />
						</td>
					</tr>
				</table>			
		
			</apex:form>
		</apex:pageBlockSection>
		
	</apex:PageBlock>


<script type="text/javascript">
    function checkAll(cb,cbid)
        {
            var inputElem = document.getElementsByTagName("input");                     
            for(var i=0; i<inputElem.length; i++)
            {             
                 if(inputElem[i].id.indexOf(cbid)!=-1){                                        
                    inputElem[i].checked = cb.checked;
                }
            }
        }
</script>

		

</apex:page>