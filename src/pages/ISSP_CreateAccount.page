<apex:page controller="ISSP_Registration"  showHeader="false" sidebar="false" standardStylesheets="false" language="{!lang}">
	<style>
		.errorMessage {
			font-size: 10px;
			margin: 0px;
		}
		
		.errorBox {
			border-color: #d00;
			box-shadow: 0 0 0 3px rgba(221,0,0,.1) inset;
		}
	</style>

<head>
    <title>{!IF(communityName=='CNS','CNS','IATA')}</title>
 </head>

 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
 <apex:stylesheet value="{!URLFOR($Resource.ValidationEngine, 'css/validationEngine.jquery.css')}" />
 <script type="text/javascript">
    var $j = jQuery.noConflict();
    
 	/*iec functions - start*/	
	function isStateRequired(country) {
    	return country == 'Canada' || country == 'United States' || country == 'Venezuela' || country == 'Australia' || country == 'Brazil';
   	}
   	
	function isZipCodeApplicable(country) {    	
   		return !countriesWithoutZipCode.has(country.toUpperCase());
   	}
   	
  	function addListeners() {
		$j('#billingstreet textarea').on('keyup', function() {
			var value = $j('#billingstreet textarea').val();
			if(value.length >= 70) {
				var elem = $('#addressStreetMSG').detach();
				elem.insertBefore($j('#billingstreet textarea'));
				$('#addressStreetMSG .formErrorContent').text('{!$Label.IEC_LimitCharacters}');						
				$('#addressStreetMSG').show();
			} else if($('#addressStreetMSG').css('display') != 'none') {
				$('#addressStreetMSG').hide();
			}	
		});
		$j('#shippingstreet textarea').on('keyup', function() {
			var value = $j('#shippingstreet textarea').val();
			var pattern = new RegExp('\\b[P|p]*(OST|ost)*\\.*\\s*[O|o|0]*(ffice|FFICE)*\\.*\\s*[B|b][O|o|0][X|x]\\s*\\d*\\b');  
			var elem = $('#addressStreetMSG').detach();
			elem.insertBefore($j('#shippingstreet textarea'));
			if(value.length >= 70) {
				$('#addressStreetMSG .formErrorContent').text('{!$Label.IEC_LimitCharacters}');						
				$('#addressStreetMSG').show();
			} else if(value.match(pattern)) {
				$('#addressStreetMSG .formErrorContent').text('{!$Label.IEC_PO_BOX_MSG}');						
				$('#addressStreetMSG').show();
			} else if($('#addressStreetMSG').css('display') != 'none') {
				$('#addressStreetMSG').hide();
			}
		});
		$j('#billingstreet textarea').blur(function() {
			$('#addressStreetMSG').hide();
		});
		$j('#shippingstreet textarea').blur(function() {
			$('#addressStreetMSG').hide();
		});
		
		$j('.billingstate').change(function() {
			if($j('select[id*="drpdwnBState"]').val() != $j('#billingstate input').val()) {
				$j('select[id*="drpdwnBState"]').val($j('#billingstate input').val());
			}
		});
		
		$j('.shippingstate').change(function() {
			if($j('select[id*="drpdwnSState"]').val() != $j('#shippingstate input').val()) {
				$j('select[id*="drpdwnSState"]').val($j('#shippingstate input').val());
			}
		});		

	}
	
	function copyToAccBState() {
		$j('#billingstate input').val($j('select[id*="drpdwnBState"]').val());
	}
	
	function copyToAccSState() {
		$j('#shippingstate input').val($j('select[id*="drpdwnSState"]').val());
	}
	
	function modifyUIForm() {
		$j('#billingstreet textarea').prop("maxlength","70");
		$j('#shippingstreet textarea').prop("maxlength","70");
		var elem = $j('#divToMove').detach();
		elem.insertAfter("#shippingcountry");
		$j('#shippingcountry').hide();
		$j('[id*="drpdwnCountry"]').val($j('#shippingcountry input').val());
		$j('[id*="drpdwnCountry"]').on("change", function() {
			$j('#shippingcountry input').val($j('[id*="drpdwnCountry"]').val());
			var country = this.value;
			if(isZipCodeApplicable(country)) {
				$j('#shippingpostalcode input').removeAttr('placeholder', 'N/A');
	            $j('#shippingpostalcode input').removeAttr('disabled', true);	 
			} else {
				$j('#shippingpostalcode input').val('');
				$j('#shippingpostalcode input').prop('placeholder', 'N/A');
	            $j('#shippingpostalcode input').prop('disabled', true);	 
			}
			shippingListStates();
		});
		setBillingStatesDrpDown();
		setShippingStatesDrpDown();
	}
	
	function shippingListStates() {
		var country = $j('#shippingcountry input').val();
		if(country == 'Brazil' || country == 'United States' || country == 'Canada' || country == 'Australia' || country == 'Venezuela') {
			$j("#drpdwnSState").empty();
			$j("#drpdwnSState").addClass('rec');
			$j("#drpdwnSState").append("<option value=''>--Select One--</option>");
			if(country == 'Brazil' && mapStates.BR)	{
				$j.each(mapStates.BR, function(k, v) {$j('select[id*="drpdwnSState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'United States' && mapStates.US) {
				$j.each(mapStates.US, function(k, v) {$j('select[id*="drpdwnSState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'Canada' && mapStates.CA) {
				$j.each(mapStates.CA, function(k, v) {$j('select[id*="drpdwnSState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'Australia' && mapStates.AU) {
				$j.each(mapStates.AU, function(k, v) {$j('select[id*="drpdwnSState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'Venezuela' && mapStates.VE) {
				$j.each(mapStates.VE, function(k, v) {$j('select[id*="drpdwnSState"]').append($j("<option></option>").attr("value", v).text(v));});
			}
			$j('#shippingstate input').hide();
			$j('#divToMove3').show();	
			$j('.shippingstate').change(function() {
				if($j('select[id*="drpdwnSState"]').val() != $j('#shippingstate input').val()) {
					$j('select[id*="drpdwnSState"]').val($j('#shippingstate input').val());
				}
			});	
		} else {
			$j("#drpdwnSState").empty();
			$j("#drpdwnSState").removeClass('rec');
			$j('#shippingstate input').val('');
			$j('#shippingstate input').show();
			$j('#divToMove3').hide();			
		}
	}
	
	function replaceShippingTXT(node) {
		if (node.nodeType == 3) {
			node.data = node.data.replace(/Shipping/g, "Delivery");
	  	}
	  	if (node.nodeType == 1 && node.nodeName != "SCRIPT") {
	    	for (var i = 0; i < node.childNodes.length; i++) {
	      		replaceShippingTXT(node.childNodes[i]);
	    	}
	  	}
	}
	
	function validateNewCompany() {
		$j('#recFields').hide();
		var element = $j('input[id*="iecNewAccount"]');
		if(!element.val()) {
			$j('#recFields').show();
			element.parent().addClass('has-error');
			return false;
		}
		return true;
	}
	
	function setBillingStatesDrpDown() {
		var country = $j('#billingcountry input').val();
		if(country == 'Brazil' || country == 'United States' || country == 'Canada' || country == 'Australia' || country == 'Venezuela') {
			$j('#billingstate input').hide();
			var elem = $j('#divToMove2').detach();
			elem.insertAfter("#billingstate");
			$j('#billingstate input').hide();
			$j('#divToMove2').show();
		
			if(country == 'Brazil' && mapStates.BR)	{
				$j.each(mapStates.BR, function(k, v) {$j('select[id*="drpdwnBState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'United States' && mapStates.US) {
				$j.each(mapStates.US, function(k, v) {$j('select[id*="drpdwnBState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'Canada' && mapStates.CA) {
				$j.each(mapStates.CA, function(k, v) {$j('select[id*="drpdwnBState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'Australia' && mapStates.AU) {
				$j.each(mapStates.AU, function(k, v) {$j('select[id*="drpdwnBState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'Venezuela' && mapStates.VE) {
				$j.each(mapStates.VE, function(k, v) {$j('select[id*="drpdwnBState"]').append($j("<option></option>").attr("value", v).text(v));});
			}
		} else {
			$j("#drpdwnBState").removeClass('rec');
		}
	}
	
	function setShippingStatesDrpDown() {
		var country = $j('#shippingcountry input').val();
		if(country == 'Brazil' || country == 'United States' || country == 'Canada' || country == 'Australia' || country == 'Venezuela') {
			$j('#shippingstate input').hide();
			var elem = $j('#divToMove3').detach();
			elem.insertAfter("#shippingstate");
			$j('#shippingstate input').hide();
			$j('#divToMove3').show();
		
			if(country == 'Brazil' && mapStates.BR)	{
				$j.each(mapStates.BR, function(k, v) {$j('select[id*="drpdwnSState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'United States' && mapStates.US) {
				$j.each(mapStates.US, function(k, v) {$j('select[id*="drpdwnSState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'Canada' && mapStates.CA) {
				$j.each(mapStates.CA, function(k, v) {$j('select[id*="drpdwnSState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'Australia' && mapStates.AU) {
				$j.each(mapStates.AU, function(k, v) {$j('select[id*="drpdwnSState"]').append($j("<option></option>").attr("value", v).text(v));});
			} else if(country == 'Venezuela' && mapStates.VE) {
				$j.each(mapStates.VE, function(k, v) {$j('select[id*="drpdwnSState"]').append($j("<option></option>").attr("value", v).text(v));});
			}
			
			$j('.shippingstate').change(function() {
				if($j('select[id*="drpdwnSState"]').val() != $j('#shippingstate input').val()) {
					$j('select[id*="drpdwnSState"]').val($j('#shippingstate input').val());
				}
			});	
		}
	}
	
	function replaceAutoCompleteAddressDoctor() {
		try {
			var f = attachAutoComplete.toString();
			f = f.replace('dseJQ("<li>")', '(fieldName.indexOf(\'Shipping\') != -1 ? dseJQ("<li>").attr("onclick", "forceStateChangeShipping(\'"+item["shippingstate"].trim()+"\')") : dseJQ("<li>").attr("onclick", "forceStateChangeBilling(\'"+item["billingstate"].trim()+"\')"))');
			attachAutoComplete = new Function('component','fieldName','minlen','delay','inputFldGrp','fastComplete','ruleNumber','ruleInstance','clicktoverify', f.substring(f.indexOf('{')+1,f.lastIndexOf('}')));
		} catch(e) {
			console.log(e);
		}
	}
	
	function forceStateChangeShipping(c) {
		try {			
			$j('#drpdwnSState').val(c);
		} catch(e) {
			console.log(e);
		}
	}
	
	function forceStateChangeBilling(c) {
		try {
			$j('#drpdwnBState').val(c);
		} catch(e) {
			console.log(e);
		}
	}
	/*iec functions - end*/
	
	var countriesWithoutZipCode;
	var defCountry;
	var mapStates;
    $j(document).ready(function() {
        console.log('fsd '+'{!preventAddressDoctorService}');
        if('{!preventAddressDoctorService}'=='false') {
            $j("#shippingcountry").find("input").val("{!searchCountryName}");
            $j("#shippingcountry").find("input").attr('readonly', true);
            $j("#billingcountry").find("input").val("{!searchCountryName}");
            $j("#billingcountry").find("input").attr('readonly', true);
            $j("#billingcity").parent().siblings('.col-lg-5').find("label").append( "<span class='required'>*</span>" );
            $j("#billingstreet").parent().siblings('.col-lg-5').find("label").append( "<span class='required'>*</span>" );
            $j("#billingcountry").parent().siblings('.col-lg-5').find("label").append( "<span class='required'>*</span>" );
            $j("#email__c").parent().siblings('.col-lg-6').find("label").html('').append( "<span class='required'></span>{!$Label.ISSP_Office_Email}" );
            $j(".billingcity").addClass('rec');
            $j(".billingstreet").addClass('rec');
            $j(".billingcountry").addClass('rec');
            $j(".req").change(function() {
                copyBillingAddress();
            });
            $j(".labelText").hide();
            $j("#phone").hide();
            
            //TC: remove address validation boxes
            if("{!sRefererCommunity}"=="iec") {
            	$j('input[id*="accountName"]').removeAttr('required');
            	replaceShippingTXT(document.body);
	            $j(".elementBAddressToHide").hide();  
	            $j(".elementSAddressToHide").hide();     
	            $j(".elementToHide").hide(); 
	            $j(".elementEmailToHide").hide();
	            $j('#shippingcountry input').removeAttr("readonly");
	            
	            countriesWithoutZipCode = new Set({!countriesNamesWithoutZipCode});
	            mapStates = {!isoStates};
	            defCountry = $j('#billingcountry input').val();
	            addListeners();  
	            
	            modifyUIForm();
	            replaceAutoCompleteAddressDoctor();
	            
	            //TC: set mandatory fields by country 
	            var country = "{!searchCountryName}";     

	            if(country && "{!requiredZipCode}" == "false") {
	            	$j('#billingpostalcode input').prop('placeholder', 'N/A');
	            	$j('#billingpostalcode input').prop('disabled', true);	       
	            	$j('#shippingpostalcode input').prop('placeholder', 'N/A');
	            	$j('#shippingpostalcode input').prop('disabled', true);	     	
	            } else {                   
		            $j("#billingpostalcode").parent().siblings('.col-lg-5').find("label").append( "<span class='required'>*</span>" );	            
		            $j(".billingpostalcode").addClass('rec');		            	            
	            }
	            
	            if(country == 'Canada' || country == 'United States' || country == 'Venezuela' || country == 'Australia' || country == 'Brazil') {
	            	$j("#billingstate").parent().siblings('.col-lg-5').find("label").append( "<span class='required'>*</span>" );
	         	    $j(".billingstate").addClass('rec');            	
	            }
            }
        }


    });
  </script>
  

 
  <apex:composition template="{!templatename}">
    <apex:define name="body">
    <div class="registration_page row" id="CreateAccount">
    
        <div id="RegistrationDiv" class="col-lg-2">
        </div> 
        
        
        
        <div id = "PanelDiv" class="panel panel-default col-lg-8">
            <div>
                <h3 class="panel-title" id="top"> {!$Label.ISSP_Registration_RegistrationProcess}</h3>
            </div>
            <div id="pleaseWait1" style="display:none" >
                <h3 class="panel-heading" style="background-color:white;font-size:18px;font-family:Arial"> {!$Label.ISSP_PleaseWait}</h3>
            </div>
            <apex:outputPanel id="searchPanel" >
            <Script>
            var $j = jQuery;
            $j('#IATACode').popover({placement:'top',trigger:'click',html:true,content:'{!JSENCODE($Label.ISSP_Registration_IATACode_Bubble)}',title:''});
            $j('#Country').popover({placement:'top',trigger:'click',html:true,content:'{!JSENCODE($Label.ISSP_Registration_Country_Bubble)}',title:''});
            $j('#IATACodeAirline').popover({placement:'top',trigger:'click',html:true,content:'{!JSENCODE($Label.ISSP_Registration_IATACode_Bubble)}',title:''});
            $j('#CountryAirline').popover({placement:'top',trigger:'click',html:true,content:'{!JSENCODE($Label.ISSP_Registration_Country_Bubble)}',title:''});
            $j('#DesignatorCodeBubble').popover({placement:'top',trigger:'click',html:true,content:'{!JSENCODE($Label.ISSP_Registration_Designator_Bubble)}',title:''});    
            </Script>
            <apex:form styleclass="login_box" forceSSL="true">
                <div class="alert alert-danger" id="errorBox" style="display:{!if(errorMessage.size==0,'none','')}">
                    <strong>{!$Label.ISSP_Error} </strong>
                    <apex:repeat value="{!errorMessage}" var="er" id="theRepeat">
                        <p><apex:outputText value="{!er}" escape="false" /></p>
                    </apex:repeat>
                </div> 
                
                <div class="formError" id="addressStreetMSG" style="width: 180px; opacity: 0.87; position: absolute; top: 0px; left: 16.4px; right: initial; margin-top: -74px; display: none;">
					<div class="formErrorContent"></div>
					<div class="formErrorArrow">
						<div class="line10"><!-- --></div>
						<div class="line9"><!-- --></div>
						<div class="line8"><!-- --></div>
						<div class="line7"><!-- --></div>
						<div class="line6"><!-- --></div>
						<div class="line5"><!-- --></div>
						<div class="line4"><!-- --></div>
						<div class="line3"><!-- --></div>
						<div class="line2"><!-- --></div>	
						<div class="line1"><!-- --></div>
					</div>
				</div>
                
                
                <div id="recFields" class="alert alert-danger" style="display:none">
                    <strong>{!$Label.ISSP_fill_required_fields}</strong>
                    <span></span>
                </div>
                
                <div id="iec_div_errors" class="alert alert-danger" style="display:none">
                	<strong>{!$Label.ISSP_Error} </strong>
                	<div>
                		<div id="iec_pobox_error">
                			<li>{!$Label.IEC_PO_BOX_ERROR}</li>
                		</div>
                		<div id="iec_rec_fields">
                			<li>{!$Label.IEC_fill_required_fields}</li>
                		</div>
                	</div>
                	<span></span>
                </div>
        
                <div class="panel panel-default row" id="searchForm">
                    <div>
                        <h3 class="panel-title">{!$Label.ISSP_SearchAccount}</h3>
                    </div>
                    
                    <apex:actionFunction action="{!selectType}" name="selectType" status="changeData" />
                    <apex:actionFunction action="{!checkSearchIataCode}" name="checkSearchIataCode" reRender="searchPanel" status="changeData" />
                    <apex:actionFunction action="{!checkAgencyType}" name="checkAgencyType" reRender="searchPanel" status="changeData" />
                    <apex:actionFunction action="{!checkSearchDesignatorCode}" name="checkSearchDesignatorCode" status="changeData" />
                    <apex:actionFunction action="{!changeShippingCountry}" reRender="ShippingAddress" name="changeShippingCountry" status="changeData">
                    	<apex:param id="param_s_country" name="param_s_country" value=""/>
                    </apex:actionFunction>
                    
                    <div class="form-group" id="TypeOfCustomer">
                        <label for="exampleInputEmail1"><span class="required">*</span>{!$Label.ISSP_Type_of_Customer}</label>
                        <apex:selectList styleclass="form-control rec" id="TypeSelect" value="{!selectedCustomerType}" onchange="selectType()" size="1" required="true" >
                        <apex:selectOptions value="{!CustomerTypeList}" />
                        <!-- 
                            <apex:selectOption itemValue="" itemLabel=" - Select the Type of your Company - "/>
                            <apex:selectOption itemValue="Airline" itemLabel="Airline"/>
                            <apex:selectOption itemValue="GloballSalesAgent" itemLabel="General Sales Agent"/>
                            <apex:selectOption itemValue="Agency" itemLabel="Agency"/>
                            <apex:selectOption itemValue="NonIATAAgent" itemLabel="Non IATA Agent"/>
                            <apex:selectOption itemValue="TIESS" itemLabel="TIESS"/>
                            <apex:selectOption itemValue="OtherCompany" itemLabel="Other Company"/>
                            <apex:selectOption itemValue="GeneralPublic" itemLabel="General public"/>
                         -->
                        </apex:selectList>
                        <div class="hiddenerror" style="display: none;">
                            <p class="errormsg" style="line-height: 26px;">{!$Label.ISSP_Registration_Error_TypeofCustomer}</p>
                        </div>             
                    </div>
                    
                    <!-- TF - SP10 - If airline, ask if has Airline Designator --> 
                    <div class="form-group" style="display:{!IF(AND(isAirline, sRefererCommunity != 'iec'),'','none')}">
                        <label class="control-label" for="inputError"><span class="required">*</span>{!$Label.ISSP_Designator_Code_Question}</label>
                        <apex:selectRadio style="width:15%" value="{!toSearchDesignatorCodeString}" onchange="checkSearchDesignatorCode()" >
                            <apex:selectOptions value="{!iataCodeQuestion}"/>
                        </apex:selectRadio>
                    </div>
                    
                    <!-- TF - SP10 - If airline, search for Airline Designator -->
                    <apex:outputPanel layout="none" rendered="{!sRefererCommunity != 'iec'}">
	                    <div class="form-group" id="DesignatorCode" style="display:{!IF(toSearchDesignatorCode,'','none')}">
	                        <label class="control-label" for="inputError">{!$Label.ISSP_Designator_Code}</label>
	                        <apex:outputPanel layout="none" rendered="{!sRefererCommunity != 'iec'}">
	                        	<img src="/img/msg_icons/info16.png" style="vertical-align:middle; margin-left:3px" id="DesignatorCodeBubble" />
	                        </apex:outputPanel>
	                        <apex:inputText styleclass="form-control" value="{!searchDesignatorCode}"/>
	                    </div>
                    </apex:outputPanel>
                    
                    <!-- TF - SP10 - If airline, search for IATA Code -->
                    <div class="form-group" style="display:{!IF(toSearchDesignatorCode,'','none')}">
                        <label class="" for="inputError">{!$ObjectType.Account.fields.IATACode__c.Label}</label>
                        <apex:outputPanel layout="none" rendered="{!sRefererCommunity != 'iec'}">
                        	<img src="/img/msg_icons/info16.png" style="vertical-align:middle; margin-left:3px" id="IATACodeAirline" />
                        </apex:outputPanel>
                        <apex:inputText styleclass="form-control" value="{!searchIATACodeAirline}" id="iataCodeInputAirline" />
                    </div>
                    
                    <!-- TF - SP10 - If airline, search for Country -->
                    <div class="form-group" style="display:{!IF(toSearchDesignatorCode,'','none')}"> 
                        <label class="control-label"  for="inputError"><span class="required">*</span>{!$Label.ISSP_CompanyLocation}</label>
                        <apex:outputPanel layout="none" rendered="{!sRefererCommunity != 'iec'}">
                        	<img src="/img/msg_icons/info16.png" style="vertical-align:middle; margin-left:3px" id="CountryAirline" />
                        </apex:outputPanel>
                        <apex:selectList styleclass="form-control {!IF(toSearchDesignatorCode,'recSearch','')}" value="{!searchCountryAirline}" size="1" >
                            <apex:selectOption itemValue="" itemLabel="{!$Label.ISSP_Registration_CountryNone}"/>
                            <apex:selectOptions value="{!ISOCountry}"/>
                        </apex:selectList>
                    </div>
                    
                    <apex:outputPanel layout="none" rendered="{!AND(sRefererCommunity == 'iec', isAirline)}">
                    	<div class="form-group">
                    		<label class="control-label">{!$Label.IEC_CompanyName}</label>
                    		<apex:inputText styleclass="form-control" value="{!companyName}"/>
                    	</div>
                    </apex:outputPanel>

                    
                    
                                    
                    <apex:outputPanel layout="none" rendered="{!AND(isAgency, sRefererCommunity != 'iec')}">
                    	<!-- TF - SP08 - If agency, ask if Cargo or Agent --> 
	                    <div class="form-group" style="display:{!IF(OR(isAgency, isNotIATA),'','none')}">
	                        <label class="control-label" for="inputError"><span class="required">*</span>{!$Label.ISSP_Select_Agency_Type}</label>
	                        <apex:selectRadio style="width:25%" value="{!cargoTravel}" onchange="checkAgencyType()" >
	                            <apex:selectOptions value="{!cargoTravelOptions}"/>
	                        </apex:selectRadio>
	                    </div>
	                    
	                    <!-- TF - SP08 - If agency, ask if has IATA Code --> 
	                    <div class="form-group" style="display:{!IF(agencyTypeSelected,'','none')}">
	                        <label class="control-label" for="inputError"><span class="required">*</span>{!$Label.ISSP_IATA_Code_Question}</label>
	                        <apex:selectRadio style="width:15%" value="{!toSearchIataCodeString}" onchange="checkSearchIataCode()" >
	                            <apex:selectOptions value="{!iataCodeQuestion}"/>
	                        </apex:selectRadio>
	                    </div>
                    </apex:outputPanel> 
                    <div class="form-group" style="display:{!IF(showSearchCountry,'','none')}"> 
                        <label class="control-label"  for="inputError" style="{!if(isGeneral==true,'display:none;','')}"><span class="required">*</span>{!$Label.ISSP_CompanyLocation}</label>
                        <label class="control-label"  for="inputError" style="{!if(isGeneral==true,'','display:none;')}"><span class="required">*</span>{!$Label.GeneralPublicLocation}</label>
                        <apex:outputPanel layout="none" rendered="{!sRefererCommunity != 'iec'}">
                        	<img src="/img/msg_icons/info16.png" style="vertical-align:middle; margin-left:3px" id="Country" />
                        </apex:outputPanel>
                        <apex:selectList styleclass="form-control {!IF(showSearchCountry,'recSearch','')} searchCountry" value="{!searchCountry}" size="1" > <!-- onchange="saveCountryName()"> -->
                            <apex:selectOption itemValue="" itemLabel="{!$Label.ISSP_Registration_CountryNone}"/>
                            <apex:selectOptions value="{!ISOCountry}"/>
                        </apex:selectList>
                        <!-- <apex:inputSecret styleclass="form-control countryName" value="{!searchCountryName}" style="display:none"/> -->
                    </div>
                    <div class="form-group" style="display:{!IF(showSearchIataCode,'','none')}">
                        <label class="" for="inputError">
                        	<apex:outputPanel layout="none" rendered="{!sRefererCommunity != 'iec'}">
                        		<span class="required">*</span>
                        	</apex:outputPanel>{!$ObjectType.Account.fields.IATACode__c.Label}
                        </label>
                        <apex:outputPanel layout="none" rendered="{!sRefererCommunity != 'iec'}">
                        	<img src="/img/msg_icons/info16.png" style="vertical-align:middle; margin-left:3px" id="IATACode" />
                        </apex:outputPanel>
                        <apex:inputText styleclass="form-control {!IF(AND(showSearchIataCode, sRefererCommunity != 'iec'),'recSearch','')}" value="{!searchIATACode}" id="iataCodeInput" />
                    </div>
                    <apex:outputPanel layout="none" rendered="{!AND(sRefererCommunity == 'iec', isAgency)}">
                    	<div class="form-group">
                    		<label class="control-label">{!$Label.IEC_CompanyName}</label>
                    		<apex:inputText styleclass="form-control" value="{!companyName}"/>
                    	</div>
                    </apex:outputPanel>
                    <div class="form-group" id="CompanyName" style="display:{!IF(showSearchCompName,'','none')}">
                        <label class="control-label" for="inputError"><span class="required">*</span>{!$Label.ISSP_CompanyName} {!$Label.ISSP_Company_Name_Search_Format}</label>
                        <apex:inputText styleclass="form-control {!IF(showSearchCompName,'recSearch','')} len3" value="{!searchCompanyName}"/>
                    </div>
                    <!-- 
                    <div class="form-group" id="TiessCode" style="display:{!IF(showSearchTiess,'','none')}">
                        <label class="" for="inputError"><span class="required">*</span>{!$ObjectType.Account.fields.TIESS_Code__c.Label} {!$Label.ISSP_TIESS_Code_Search_Format}</label>
                        <apex:inputText styleclass="form-control {!IF(showSearchTiess,'recSearch','')} TiessCode len3" value="{!searchTiess}"/>
                    </div>
                     -->
                    <div class="form-group">
                        <apex:actionstatus id="changeData">
                            <apex:facet name="start">
                                <div class="waitingSearchDiv" id="el_loading" style="background-color: #fbfbfb;
                                    height: 100%;opacity:0.65;width:100%;">
                                    <div class="waitingHolder" style="top: 74.2px; width: 91px;">
                                        <img class="waitingImage" src="/img/loading.gif" title="Please Wait..." />
                                        <span class="waitingDescription">Please wait...</span>
                                    </div>
                                </div>
                            </apex:facet>
                        </apex:actionstatus>
                    </div>
                    
                    <div class="form-group col-lg-3">
                    </div>
                    <div class="form-group col-lg-6" style="display:{!IF(doSearch,'','none')}" >
                        <apex:commandButton styleclass="btn_iata btn-lg btn-block btn-success2" onClick="if(!validateSearch())return false;" action="{!searchAccount}" value="{!$Label.ISSP_Search}" id="search" />
                    </div>
                    <div class="form-group col-lg-6">
                        <!-- <apex:inputHidden value="{!selectedAccId}" id="selectedAccId" /> -->
                        <apex:inputSecret value="{!selectedAccId2}" style="display:none" styleClass="accId" id="selectedAccId"/>
                    </div>
                </div>
                
                
                
                <!-- Shown if matching account is found -->
                <div class="panel panel-default row" style="display:{!IF(accountFound,'','none')}" id="searchResults">
                    <h4>{!$Label.ISSP_Results}</h4>
                    <!-- 
                    <apex:selectRadio value="{!selectedAccId}" layout="pageDirection" >
                        <apex:selectOptions value="{!accListRadio}" />
                    </apex:selectRadio>
                      -->
                      
                     
                      
                    <apex:repeat value="{!accList}" var="acc">
                        <div class="form-group input-group">
                            <span class="input-group-addon">
                                <input type="radio" name="group1" value="{!acc.Id}" style = "{!IF (AND (isOther, accList.size > 0, acc.IATACode__c == 'Create New Account'), 'display:none;','')}" onChange="selectAccId('{!$Component.selectedAccId}')"/>
                                <input type="radio" name="group1" value="Create New Account" style = "{!IF (AND (isOther, accList.size > 0, acc.IATACode__c == 'Create New Account'), '','display:none;')}" onChange="selectAccId('{!$Component.selectedAccId}')"/>
                            </span>
                            <span class="form-control" style="display: -webkit-inline-flex;height: auto">
                                <label class="control-label"  for="inputError">{!acc.Name}</label>&nbsp;
                                <span style="margin-right: 5px">
                                    <apex:outPuttext value="({!acc.IATACode__c})" rendered="{!AND(isAirline, toSearchDesignatorCode, acc.IATACode__c != '')}" />
                                </span>
                                <span style="margin-right: 5px">
                                    <apex:outPutfield value="{!acc.BillingStreet}" rendered="{!acc.Name!=$Label.ISSP_Create_New_Other_Account}"/>
                                </span>
                                <span style="margin-right: 5px">
                                    <apex:outPutfield value="{!acc.BillingCity}" rendered="{!acc.Name!=$Label.ISSP_Create_New_Other_Account}"/>
                                </span>
                                <span style="margin-right: 5px">
                                    <apex:outPutfield value="{!acc.BillingCountry}" rendered="{!acc.Name!=$Label.ISSP_Create_New_Other_Account}"/>
                                </span>
                                <span style="margin-right: 5px">
                                    <apex:outPuttext value="({!acc.RecordType.Name})" rendered="{!AND(isAirline, toSearchDesignatorCode)}" />
                                </span>
                            </span>
                        </div>
                    </apex:repeat>
                    <span style="{!if(showcreateother==true,'display:none','')}">
                        <i>{!$Label.ISSP_NoteWhenAccountFound}</i>
                    </span>
                </div>
                
                <!-- Shown if matching account is not found but airline HQ exists-->
                <div class="panel panel-default row" style="display:{!IF(hqFound,'','none')}" id="searchResultsHQ">
                    <h4>{!$Label.ISSP_Results}</h4>
                    <div class="form-group input-group">
                        <span class="input-group-addon">
                        </span>
                        <span class="form-control" style="display: -webkit-inline-flex;height: auto">
                            <label class="control-label"  for="inputError">{!hqAccount.Name}</label>&nbsp;
                            <span style="margin-right: 5px">
                                <apex:outPutfield value="{!hqAccount.Field_Head_Office__c}" />
                            </span>
                        </span>
                    </div>
                    <!-- 
                    <span>
                        <i><apex:outputText value="{!$Label.ISSP_NoRecordsFoundBranch}" escape="false" /></i>
                    </span>
                     -->
                </div>
                
                <div id="onegpa" class="alert alert-info" style="{!IF(onegpa!=true,'display:none','')}" >
                    <p style = "font-size:14px;"> {!$Label.ISSP_FoundGeneralPublic}</p>
                </div>    
                
                
                <div class="panel panel-default row" style="display:{!IF(showCreateAccount,'none','')}" id="submitAccountButtons1" >
                     <div class="col-md-6">
                        <apex:commandButton styleclass="btn_iata btn-lg btn-block btn-success2"  immediate="true" action="{!backToContactPage}" value="{!$Label.ISSP_Back}" id="back1"/>
                     </div>
                     
                     
                     
                     <div class="col-md-6"> 

                      <input type="button" class="btn_iata btn-lg btn-block btn-success2" onClick="showCreateAccountForm()"
                        value="{!$Label.ISSP_Create_New_Other_Account}"
                        id="OtherCreateAccount"
                        style="display:none"
                        />
                     
                        <!-- <apex:commandButton styleclass="btn_iata btn-lg btn-block btn-success2 submitExistAccount" onClick="if(!validateSelectAccount())return false;blockme2();" action="{!register}" value="{!$Label.site.submit}" style="display:none" rendered="{!accountFound}" /> -->
                        <apex:commandButton styleclass="btn_iata btn-lg btn-block btn-success2 submitExistAccount" onClick="blockme2();" action="{!register}" value="{!$Label.site.submit}" style="display:none" rendered="{!accountFound}" />
                            <!-- <apex:param name="selectedAccId" value="{!selectedAccId}" assignTo="{!selectedAccId}" />
                        </apex:commandButton> -->
                        <apex:commandButton styleclass="btn_iata btn-lg btn-block btn-success2 nextAsGP" onClick="if(!validateGPForm()){return false;} blockme2();" action="{!nextAsGP}" value="{!$Label.ISSP_Next}" rendered="{!showNextAsGP}"/>
                    </div>                    
                    
                </div> 
    
                </apex:form>
                </apex:outputPanel>
                
                
               <apex:form id="newAccount" rendered="{!IF(OR(showCreateAccount,showcreateother),true,false)}"> 
               <div style="display:none" id="createAccountForm">
                <div class="panel panel-default row" id="companyInfo">
                    <div class="panel-heading">
                        <h3 class="panel-title">{!$Label.ISSP_CompanyInformation}</h3>
                    </div>
                    <div class="form-group col-lg-6" style="display:{!IF(!createBranch,'','none')}">
                        <label for="exampleInputEmail1">{!IF(sRefererCommunity == 'iec',$Label.IEC_AccountName ,$ObjectType.Account.fields.Legal_name__c.Label)}</label><span class="required">*</span>
                        <apex:inputField styleclass="form-control rec"  id="accountName" value="{!acc.Name}" rendered="{!!createBranch}" />
                    </div>
                    <div class="form-group col-lg-6" style="display:{!IF(createBranch,'','none')}">
                        <label for="exampleInputEmail1">{!$ObjectType.Account.fields.Legal_name__c.Label}</label><span class="required">*</span>
                        <apex:outputText styleclass="form-control"  id="accountNameRO" value="{!acc.Name}" rendered="{!createBranch}" />
                    </div>
                    <div class="form-group col-lg-6">
                        <label for="exampleInputEmail1">{!$ObjectType.Account.fields.Sector__c.Label}</label><span class="required">*</span>
                        <!-- <apex:inputField styleclass="form-control rec" id="sector" value="{!acc.Sector__c}" onfocus="removeSectorValues('{!selectedCustomerType}', '{!$Component.sector}')" rendered="{!!hqFound}" /> -->
                        <div style="display:{!IF(AND(isAirline, sRefererCommunity != 'iec'),'none','')}" >
                        <apex:inputField styleclass="form-control rec" id="sector" value="{!acc.Sector__c}" rendered="{!OR(sRefererCommunity == 'iec', AND(!hqFound, !createAgency))}" />
                        </div>
                        <apex:outputText styleclass="form-control" id="sectorHQ" value="{!hqAccount.Sector__c}" rendered="{!AND(hqFound, !createAgency)}" />
                        <apex:outputText styleclass="form-control" id="sectorAgency" value="{!acc.Sector__c}" rendered="{!AND(!hqFound, createAgency)}" />
                        <apex:outputText styleclass="form-control" id="sectorAirline" value="{!acc.Sector__c}" rendered="{!AND(isAirline, !toSearchDesignatorCode)}" />
                    </div>
                    <apex:outputPanel layout="none" rendered="{!sRefererCommunity == 'iec'}">
	                    <div class="form-group col-lg-6" >
	                        <label for="exampleInputEmail1"><span class="required"></span>{!$ObjectType.Account.fields.TradeName__c.Label}</label>
	                        <apex:inputField id="tradeNameIEC" styleclass="form-control"  value="{!acc.TradeName__c}"/>
	                    </div>
                    </apex:outputPanel>
                    <!-- 
                    <div class="form-group col-lg-6" style="display:{!IF(AND(!showSearchIataCode, createAgency),'','none')}" >
                        <label for="exampleInputEmail1"><span class="required">*</span>{!$ObjectType.Account.fields.TradeName__c.Label}</label>
                        <apex:inputField id="tradeNameAgency" styleclass="form-control rec"  value="{!acc.TradeName__c}" rendered="{!AND(!showSearchIataCode, createAgency)}" />
                    </div>
                    <div class="form-group col-lg-6" style="display:{!IF(AND(!showSearchIataCode, !createAgency),'','none')}" >
                        <label for="exampleInputEmail1"><span class="required"></span>{!$ObjectType.Account.fields.TradeName__c.Label}</label>
                        <apex:inputField id="tradeNameOther" styleclass="form-control"  value="{!acc.TradeName__c}" rendered="{!AND(!showSearchIataCode, !createAgency)}" />
                    </div>
                     -->
                    <apex:outputPanel layout="none" rendered="{!sRefererCommunity != 'iec'}">
	                    <div class="form-group col-lg-6" style="display:{!IF(!showSearchIataCode,'','none')}" >
	                        <label for="exampleInputEmail1"><span class="required"></span>{!$ObjectType.Account.fields.TradeName__c.Label}</label>
	                        <apex:inputField id="tradeNameOther" styleclass="form-control"  value="{!acc.TradeName__c}" rendered="{!AND(!showSearchIataCode)}" />
	                    </div>
                    </apex:outputPanel>
                    <div class="form-group col-lg-6" style="display:{!IF(AND(showSearchIataCode, sRefererCommunity != 'iec'),'','none')}" >
                        <label for="exampleInputEmail1"><span class="required">*</span>{!$ObjectType.Account.fields.IATACode__c.Label}</label>
                        <apex:outputText styleclass="form-control" value="{!searchIATACode}"/>
                    </div>
                    <apex:outputPanel layout="none" rendered="{!AND(!hqFound, !createAgency)}" >
                    <div class="form-group col-lg-6" id="theCategoryMainDiv" >
                        <label for="exampleInputEmail1">{!$ObjectType.Account.fields.Category__c.Label}</label><span class="required">*</span>
                        <div class="form-control">
                        <apex:inputField styleclass="form-control rec" id="categoryField" value="{!acc.Category__c}" onchange="showCategory('categoryDiv1', 'categoryDiv2', '{!$Component.categoryField}', '{!$Component.categoryOther}');" />
                        </div>
                    </div>
                    </apex:outputPanel>
                    <apex:outputPanel layout="block" rendered="{!AND(hqFound, !createAgency)}" >
                    <div class="form-group col-lg-6">
                        <label for="exampleInputEmail1"><span class="required">*</span>{!$ObjectType.Account.fields.Category__c.Label}</label>
                        <apex:outputText styleclass="form-control" id="categoryFieldHQ" value="{!hqAccount.Category__c}" />
                    </div>
                    </apex:outputPanel>
                    <!-- TF - SP08 -->
                    <apex:outputPanel layout="block" rendered="{!AND(!hqFound, createAgency)}" >
                    <div class="form-group col-lg-6">
                        <label for="exampleInputEmail1"><span class="required">*</span>{!$ObjectType.Account.fields.Category__c.Label}</label>
                        <apex:outputText styleclass="form-control" id="categoryFieldAgency" value="{!acc.Category__c}" />
                    </div>
                    </apex:outputPanel>
                    <div class="form-group col-lg-6" id="categoryDiv1" style="display:none" >
                    </div>
                    <div class="form-group col-lg-6" id="categoryDiv2" style="display:none" >
                        <label for="exampleInputEmail1"><span class="required">*</span>{!$ObjectType.Account.fields.Category_Other_Value__c.Label}</label>
                        <apex:inputText styleclass="form-control rec" style="display:none" id="categoryOther" value="{!acc.Category_Other_Value__c}"/>
                    </div>
                    <apex:outputPanel layout="none" rendered="{!sRefererCommunity != 'iec'}">
	                    <div class="form-group col-lg-6" style="display:{!IF(showSearchIataCode,'','none')}" >
	                        <label for="exampleInputEmail1"><span class="required"></span>{!$ObjectType.Account.fields.TradeName__c.Label}</label>
	                        <apex:inputField id="tradeNameBranch" styleclass="form-control"  value="{!acc.TradeName__c}" rendered="{!AND(showSearchIataCode)}" />
	                    </div>
                    </apex:outputPanel>
                    <!-- 
                    <div class="form-group col-lg-6">
                        <label for="exampleInputEmail1"><span class="required"></span>{!$ObjectType.Account.fields.TradeName__c.Label}</label>
                        <apex:inputField styleclass="form-control"  value="{!acc.TradeName__c}"/>
                    </div>
                     -->
                </div>
                      
                      
                  
                <div class="panel panel-default row" style="display:{!IF(or(showCreateAccount,showcreateother),'','none')}" id="otherAccountFields">
                      <div class="panel-heading">
                        <h3 class="panel-title">{!$Label.ISSP_CompanyAddressInformation}</h3>
                        
                      </div>
<!--                        <h3 id="addressmessage" class="panel-heading" style="background-color:white;font-size:14px;font-weight:bold;"><apex:outputText value="{!$Label.AddressDoctorValidate}" escape="false" /></h3> -->
                       <!-- <p><apex:outputText value="{!validateaddresserror}" escape="false" /></p> -->
                      <div class="form-group col-lg-6" style="display:{!IF(preventAddressDoctorService==false,'','none')}">
                      </div>
                      <div class="form-group col-lg-6" style="display:{!IF(preventAddressDoctorService==false,'','none')}">
                        <input type="checkbox" name="vehicle" id="copyCheckBox" onChange="copyBillingAddress()"/>
                        <label for="exampleInputEmail1">{!$Label.ISSP_CopyBillingAddress}</label> 
                        <apex:outputPanel layout="none" rendered="{!sRefererCommunity == 'iec'}">
                        	<p style="color: #C90435; font-size: 14px; margin-left: 19px;">{!$Label.IEC_PO_BOX_MSG}</p>
                        </apex:outputPanel>
                      </div>
                      <div class="form-group col-lg-6">
	                      <DSE:DS_DataQuality id="BillingAddress"
	                        RecordRef="{!acc}"
	                        FieldGroupName="Billing Address"
	                        Edit="true"
	                        FormGroupStyle="form-group"
	                        RowStyle="row"
	                        LabelStyle="col-lg-5"
	                        InputStyle="col-lg-6"
	                        StatusStyle="{!IF(sRefererCommunity == 'iec','elementBAddressToHide', 'col-lg-1 col-md-1 col-sm-1 col-xs-1')}"
	                        FormControlStyle="form-control req" rendered="{!preventAddressDoctorService==false}">
	                      </DSE:DS_DataQuality>
	                      <apex:outputPanel layout="none" rendered="{!sRefererCommunity == 'iec'}">
	                      		<div id="divToMove2" class="col-lg-6" style="display: none;">
	                      			<select class="form-control rec" id="drpdwnBState" onchange="copyToAccBState();">
	                      				<option value="">--Select One--</option>
	                      			</select>                		 	
	                        	</div>
                       	  </apex:outputPanel>	
                      </div>
                      <div class="form-group col-lg-6">
	                      <apex:outputPanel id="shippingAddressArea" layout="none">                 
		                      <DSE:DS_DataQuality id="ShippingAddress"
		                        RecordRef="{!acc}"
		                        FieldGroupName="Shipping Address"
		                        Edit="true"
		                        FormGroupStyle="form-group"
		                        RowStyle="row"
		                        LabelStyle="col-lg-5"
		                        InputStyle="col-lg-6"
		                        StatusStyle="{!IF(sRefererCommunity == 'iec','elementSAddressToHide', 'col-lg-1 col-md-1 col-sm-1 col-xs-1')}"                        
		                        FormControlStyle="form-control" rendered="{!preventAddressDoctorService==false}">
		                      </DSE:DS_DataQuality>
		                      	<apex:outputPanel layout="none" rendered="{!sRefererCommunity == 'iec'}">
		                      		<div id="divToMove" class="col-lg-6">
				                      	<apex:selectList styleclass="form-control" id="drpdwnCountry" value="{!acc.ShippingCountry}" size="1" >	                            	
			                            	<apex:selectOptions value="{!shpCountry}"/>	
			                        	</apex:selectList>
		                        	</div>
		                        	<div id="divToMove3" class="col-lg-6" style="display: none;">
		                      			<select class="form-control rec" id="drpdwnSState" onchange="copyToAccSState();">
		                      				<option value="">--Select One--</option>
		                      			</select>                		 	
		                        	</div>
	                        	</apex:outputPanel>		                                       
	                      </apex:outputPanel>
                      </div>
                        <apex:inputHidden value="{!acc.Phone}" id="businessphone"/>
                        <apex:inputHidden value="{!acc.Mobile__c}" id="businessmobile"/>
                        <apex:inputHidden value="{!acc.Fax}" id="businessfax"/>
                      
                      <div class="form-group col-lg-7" id="Phoneone">
                        <label for="exampleInputEmail1" >{!$Label.ISSP_Office_Phone} <span class="required">*</span></label><br/>
                            <apex:inputField id="businessphoneinput" styleclass="form-control rec"  value="{!acc.PhoneNational__c}" onblur="setInternationalPhoneNo('phone');$j('.phone').change();"/>

                            <DSE:DS_DataQuality id="phoneinput"
                                RecordRef="{!acc}"
                                FieldGroupName="Phone"
                                Edit="true"
                                FormGroupStyle="form-group"
                                RowStyle="row"
                                LabelStyle="col-lg-6 labelText"
                                InputStyle="col-lg-9"
                                StatusStyle="{!IF(sRefererCommunity == 'iec','elementToHide', 'col-lg-1 col-md-1 col-sm-1 col-xs-1 statusBox')}"
                                FormControlStyle="form-control national" rendered="{!preventAddressDoctorService==false}">
                              </DSE:DS_DataQuality>
                      </div>
                        
                      
                      <div class="form-group col-lg-7" id="Phonetwo">
                        <label for="exampleInputEmail1" >{!$Label.ISSP_Office_Mobile}</label><span class="required"></span><br/>
                        <apex:inputField id="businessmobileinput" styleclass="form-control"  value="{!acc.MobileNational__c}" onblur="setInternationalPhoneNo('mobile');"/>
                      </div>

                      <!-- <div class="form-group col-lg-6" id="DSEPhone">
                          <DSE:DS_DataQuality id="phoneinput"
                            RecordRef="{!acc}"
                            FieldGroupName="Phone"
                            Edit="true"
                            FormGroupStyle="form-group"
                            RowStyle="row"
                            LabelStyle="col-lg-6 labelText"
                            InputStyle="col-lg-9"
                            StatusStyle="col-lg-1 col-md-1 col-sm-1 col-xs-1 statusBox"
                            FormControlStyle="form-control national" rendered="{!preventAddressDoctorService==false}">
                          </DSE:DS_DataQuality>
                      </div> -->
                    
                      <div class="form-group col-lg-7" id="Phonethree">
                        <label for="exampleInputEmail1" >{!$Label.ISSP_Office_Fax}</label><span class="required"></span><br/>
                            <apex:inputField id="businessfaxinput" styleclass="form-control"  value="{!acc.FAXNational__c}" onblur="setInternationalPhoneNo('fax');"/>
                      </div>

                      <div class="clearfix"></div>

                      <div class="form-group col-lg-6" id="Website">
                        <label for="exampleInputEmail1"><span class="required"></span>{!$ObjectType.Account.fields.Website.Label}</label>
                            <apex:inputField styleclass="form-control"  value="{!acc.Website}"/>
                      </div>
                      
                      <div class="form-group col-lg-6" id="FormEmail">
                          <DSE:DS_DataQuality id="emailinput"
                            RecordRef="{!acc}"
                            FieldGroupName="Email"
                            Edit="true"
                            FormGroupStyle="form-group"
                            RowStyle="row"
                            LabelStyle="col-lg-6"
                            InputStyle="col-lg-11"
                            StatusStyle="{!IF(sRefererCommunity == 'iec','elementEmailToHide', 'col-lg-1 col-md-1 col-sm-1 col-xs-1')}"
                            FormControlStyle="form-control" rendered="{!preventAddressDoctorService==false}">
                          </DSE:DS_DataQuality>
                      </div>
                   
                  
                  </div>
                  <!-- 
                  <div class="panel panel-default row">
                      <div class="panel-heading">
                          <h3 class="panel-title">{!$Label.ISSP_AdditionalInfo}</h3>
                      </div>
                      <div class="form-group col-lg-12">
                        <label for="exampleInputEmail1"><span class="required"></span></label>
                            <apex:inputField styleclass="form-control"  value="{!acc.description}"/>
                      </div>
                  </div>
                   -->
               </div>
               
               
        
                <div class="panel panel-default row" style="display:{!IF(accountFound,'none','')}" id="submitAccountButtons">
                    <div class="alert alert-info" id="infoBox" style="display:{!if(infoMessage.size==0,'none','')};margin-top:-9%">
                        <apex:repeat value="{!infoMessage}" var="er" id="theRepeat2">
                            <p><apex:outputText value="{!er}" escape="false" /></p>
                        </apex:repeat>
                    </div>
                    
                
                    <div class="col-md-6">
                         
                        <apex:commandButton styleclass="btn_iata btn-lg btn-block btn-success2" immediate="true" action="{!backToContactPage}" value="{!$Label.ISSP_Back}" id="back"/>
                        <apex:commandButton styleclass="btn_iata btn-lg btn-block btn-success2" immediate="true" action="{!backToAccountPage}" value="{!$Label.ISSP_Back}" id="back2" style="display:none"/>
                        <!--<apex:commandButton styleclass="btn_iata btn-lg btn-block btn-success2" onclick = "checkvar()" value="{!$Label.ISSP_Back}" id="back"/>  -->
                        
                        <apex:commandButton styleclass="btn_iata btn-lg btn-block btn-success2"  action="{!backToContactPage}" value="{!$Label.ISSP_Back}" id="backOth" style="display:none;"/>
                    </div>
                    <div class="col-md-6">
                      <input type="button" class="btn_iata btn-lg btn-block btn-success2" onClick="showCreateAccountForm()"
                        value="{!IF(sRefererCommunity == 'iec', $Label.ISSP_Create_New_Other_Account, 
                        		 IF(createBranch, $Label.ISSP_Create_New_Airline_Branch,
                                 IF(isAirline, $Label.ISSP_Create_New_Airline,
                                 IF(isNotIATA, $Label.ISSP_Create_New_Agency,
                                 IF(isOther, $Label.ISSP_Create_New_Other_Account,
                                 IF(showCreateStandardAirline, $Label.ISSP_NoRecordsFoundCreateStandardAirline,
                                 $Label.ISSP_Next
                                 ))))))}"
                        id="btnShowCreateAccount"
                        style="display:{!if(or(showCreateAccount,showCreateOther),'','none')}"
                        />
                      <apex:commandButton styleclass="btn_iata btn-lg btn-block btn-success2 submitNewAccount" onClick="if(!validateNewAccount('{!$Component.categoryField}')) {return false;}blockme();" action="{!register}" value="{!$Label.site.submit}" id="submit" style="display:none" />
                    </div> 
                </div>
                <div id="pleaseWait2" style="display:none" >
                    <h3 class="panel-heading" style="background-color:white;font-size:18px;font-family:Arial"> {!$Label.ISSP_PleaseWait}</h3>
                </div>
               <script src="{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/build/js/intlTelInput.js')}"></script>  
        <script>
        var natphone = $j("input[name='{!$Component.newAccount.businessphoneinput}']");
        var phone = $j(".phone");
        
        natphone.intlTelInput({
            defaultCountry: '{!searchCountryISOCode}',
            nationalMode: true,
            preferredCountries: [""],
            numberType: "FIXED_LINE",
          utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
        });
                        
        var natmobile = $j("input[name='{!$Component.newAccount.businessmobileinput}']");
        var mobile = $j("input[name='{!$Component.newAccount.businessmobile}']");
        
         natmobile.intlTelInput({
            defaultCountry: '{!searchCountryISOCode}',
            nationalMode: true,
            preferredCountries: [""],
            numberType: "MOBILE",
            utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
        });
  
        var natfax = $j("input[name='{!$Component.newAccount.businessfaxinput}']");
        var fax = $j("input[name='{!$Component.newAccount.businessfax}']");
    
         natfax.intlTelInput({
            defaultCountry: '{!searchCountryISOCode}',
            nationalMode: true,
            preferredCountries: [""],
            numberType: "FIXED_LINE",
            utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
        });
        
        function setInternationalPhoneNo(p) {
            if(p=='phone') {
                phone.val(natphone.intlTelInput("getNumber"));
            } else if(p=='mobile') {
                mobile.val(natmobile.intlTelInput("getNumber"));
            } else {
                fax.val(natfax.intlTelInput("getNumber"));
            }
        }
        
        
          
      </script>
   </apex:form> 
        </div>
    </div>
    
              
<Script>    

        var type = '{!selectedCustomerType}';
        
        if (type=='Airline' || type=='NonIATAAgent') {
            $j(".selectCountry").val('{!searchCountry}');
            $j('.selectCountry').attr('readonly', true);
        }
        
        
        function validateGPForm() {
        	if("{!sRefererCommunity}" == "iec") {
        		return validateSearch();
        	} else {
        		return true;
        	}
        }

        function selectAccId(theAccId){
            
            var accId = $j('input[name="group1"]:checked').val();
            
            //Standard functioning
            if (accId != 'Create New Account') {    
                
                $j('.accId').val(accId);
                //document.getElementById(theAccId).val = accId;
                $j('.submitExistAccount').show();
                $j('.OtherCreateAccount').hide();
                document.getElementById('OtherCreateAccount').style.display = 'none';
            }
            
            //Exception: other company - show 'dummy' account to create a new one
            else if (accId == 'Create New Account') {
                
                $j('.accId').val("OTHER");
                $j('.submitExistAccount').hide();
                $j('.OtherCreateAccount').show();
                document.getElementById('OtherCreateAccount').style.display = 'block';
            }
            
        }
            
        if({!accList.size}==1) {
            if ({!!showNextAsGP}){
                $j('#searchResults input[name="group1"]').first().prop("checked", true);
                $j('.submitExistAccount').show();
                //selectAccId();
            }
        }

        function validateSearch(){
            var flag = true;
            $j('#recFields').hide();
            $j('.recSearch').each(function (){
                $j(this).parents('.form-group').removeClass('has-error');
                if(!$j(this).val() || ($j(this).hasClass('len3') && $j(this).val().length<3)){
                    flag = false;
                    $j(this).parents('.form-group').addClass('has-error');
                }
            })
            if(flag == false){
                $j('#recFields').show();
            }
            return flag;
        }
        
        function validateSelectAccount(){
            if ($j('.accId').val()!='') {
                return true;
            }
            else {
                // should be selected anyway
                $j('.accId').parents('.form-group').addClass('has-error');
                return false;
            }
        }
        
    function checkShippingAddress() {
    	var country = $j('#shippingcountry input').val() ? $j('#shippingcountry input').val().toUpperCase() : "";
    	var stateReq = country == 'CANADA' || country == 'UNITED STATES' || country == 'VENEZUELA' || country == 'AUSTRALIA' || country == 'BRAZIL';
    	var postalCodeReq = isZipCodeApplicable(country);
    	var sstreet = $j("#shippingstreet").find("textarea");
    	var scity = $j("#shippingcity").find("input");
    	var sstate = $j("#shippingstate").find("input");
        var scode = $j("#shippingpostalcode").find("input");
        var totAddress = sstreet.val() + scity.val() + scode.val() + (stateReq ? sstate.val() : '');
        var isValid = true;  
        var isPoBox = false;   
        var pattern = new RegExp('\\b[P|p]*(OST|ost)*\\.*\\s*[O|o|0]*(ffice|FFICE)*\\.*\\s*[B|b][O|o|0][X|x]\\s*\\d*\\b');   
        $j('#poBoxError').hide();
    	if(!isBlank(totAddress)) {
    		$j(sstreet.parents('.form-group')[0]).removeClass('has-error');
    		if(isBlank(sstreet.val())) {
    			isValid = false;
    			$j(sstreet.parents('.form-group')[0]).addClass('has-error');    			
    		} else {
    			if(sstreet.val().match(pattern)) {    				
    				$j(sstreet.parents('.form-group')[0]).addClass('has-error');
    				isPoBox = true;
    			}
    		}
    		$j(scity.parents('.form-group')[0]).removeClass('has-error');
    		if(isBlank(scity.val())) {
    			isValid = false;
    			$j(scity.parents('.form-group')[0]).addClass('has-error');   
    		}   
    		$j(scode.parents('.form-group')[0]).removeClass('has-error');
    		if(isBlank(scode.val()) && postalCodeReq) {
    			isValid = false;
    			$j(scode.parents('.form-group')[0]).addClass('has-error');   
    		}
    		$j(sstate.parents('.form-group')[0]).removeClass('has-error');
    		if(isBlank(sstate.val()) && stateReq) {
    			isValid = false;
    			$j(sstate.parents('.form-group')[0]).addClass('has-error');   	
    		}	
    	}
    	
    	if(!isValid) {
    		$j('#iec_div_errors').show();
    		$j('#iec_rec_fields').show();
    	}   
    	
    	if(isPoBox) {
    		$j('#iec_div_errors').show(); 		
    		$j('#iec_pobox_error').show();
    	}
    	
    	return isValid && !isPoBox; 	
    }
    
    function validateNewAccount_iec(categoryField) {
    	//EM: If state empty for those 5 countries
        var country = "{!searchCountryName}";
        //alert("Country: " +country);
       
        var flag = true;
       	$j('#iec_div_errors').hide();
       	$j('#iec_pobox_error').hide();
       	$j('#iec_rec_fields').hide();
        
        var shippingAddressValid = checkShippingAddress();
        
        var myCategoryField = document.getElementById(categoryField);
        
        if (myCategoryField == null){
            //alert("is null");
        }
        else
        {
            if (myCategoryField.value == '' || myCategoryField.value == null){
                flag = false;
                $j('#theCategoryMainDiv').addClass('has-error');
            }
            else{
                $j('#theCategoryMainDiv').removeClass('has-error');
            }
        }
        
        
        if ({!accountFound} ) {
            //Do nothing: exception
            if ("{!isOther}" == "true") {}
        
            else if ($j('.accId').val()!='') {
                //alert("return 1");
                return true;
            }
            else {
                //alert("return 2");
                $j('.accId').parents('.form-group').addClass('has-error');
                return false;
            }
        }
        $j('.rec').each(function (){
            $j(this).parents('.form-group').removeClass('has-error');
            if(!$j(this).val()){// && ($(this).html() == '' || $(this).html() == null)){
                if($j(this).css('display') != 'none'){
                    flag = false;
                    $j(this).parents('.form-group').addClass('has-error');
                }
            }
        }
        )
        
        if(flag == false){
            $j('#iec_div_errors').show();
            $j('#iec_rec_fields').show();
        }
        
        console.log(flag);
        return flag && shippingAddressValid;
    }
    
    function validateNewAccount_non_iec() {    	    
        //EM: Validate Billing Address before saving
        var all = $j("div[id=recordstatuscontainer]");
        var box = all[0];
        var pict = box.childNodes[0];
        var url = pict.src;
        if (url != null && url == '{!urlpicture}') {
            alert ("{!JSENCODE($Label.AddressDoctorValidate2)}");
            return; 
        }
        
        //alert("{!selectedAccId2}");
            
        //EM: If state empty for those 5 countries
        var country = "{!searchCountryName}";
        //alert("Country: " +country);
        
        var sstate = $j("#shippingstate").find("input").val();
        var scity = $j("#shippingcity").find("input").val();
        var scode = $j("#shippingpostalcode").find("input").val();
                
        
        if (scity.length > 0 || sstate.length > 0 || scode.length > 0) {
                var boxS = all[1];
                var pictS = boxS.childNodes[0];
                var urlS = pictS.src;
                if (urlS != null && urlS == '{!urlpicture}') {
                    alert ("{!JSENCODE($Label.AddressDoctorValidate2)}");
                    return; 
                }
            
        }
        
        if (country == 'Canada' || country == 'United States' || country == 'Venezuela' || country == 'Australia' || country == 'Brazil') {
            var bstate = $j("#billingstate").find("input").val();
            if (!bstate || 0 === bstate.length) {
                alert ("{!JSENCODE($Label.AddressDoctorNoState)}");
                return false;
            }
            
            
            
            
            if (scity.length > 0 && (!sstate || 0 === sstate.length)) {
                
                
                alert ("{!JSENCODE($Label.AddressDoctorNoState)}");
                return false;
            }
            
            
            
        }
        
        
        var flag = true;
        $j('#recFields').hide();
        
        var myCategoryField = document.getElementById(categoryField);
        if (myCategoryField == null){
            //alert("is null");
        }
        else
        {
            if (myCategoryField.value == '' || myCategoryField.value == null){
                flag = false;
                $j('#theCategoryMainDiv').addClass('has-error');
            }
            else{
                $j('#theCategoryMainDiv').removeClass('has-error');
            }
        }
        
        
        if ({!accountFound} ) {
            //Do nothing: exception
            if ("{!isOther}" == "true") {}
        
            else if ($j('.accId').val()!='') {
                //alert("return 1");
                return true;
            }
            else {
                //alert("return 2");
                $j('.accId').parents('.form-group').addClass('has-error');
                return false;
            }
        }
        $j('.rec').each(function (){
            $j(this).parents('.form-group').removeClass('has-error');
            if(!$j(this).val()){// && ($(this).html() == '' || $(this).html() == null)){
                if($j(this).css('display') != 'none'){
                    flag = false;
                    $j(this).parents('.form-group').addClass('has-error');
                }
            }
        }
        )
        
        /*
        if (myCategoryField.value == '')
            flag = false;
        */
        if(flag == false){
            $j('#recFields').show();
        }
        return flag;
    }
    
                          
    function validateNewAccount(categoryField) {            
		return "{!sRefererCommunity}" == "iec" ? validateNewAccount_iec(categoryField) : validateNewAccount_non_iec(categoryField);  
    }
    
    function changeicon () {
    
    var all = $j("div[id=recordstatuscontainer]");
            if (all !=null) {
                var box = all[0];
                if (box != null) {
                    var pict = box.childNodes[0];
                    if (pict != null && pict.src.indexOf('question.png')!=-1) {
                    	//alert('1: ' +pict.src);
                        pict.src = '{!urlpicture}';
                    }
                    
                    }
                box = all[1];
                if (box != null) {
                    var pict = box.childNodes[0];
                    if (pict != null && pict.src.indexOf('question.png')!=-1) {
                        //alert('2: ' +pict.src);
                        pict.src = '{!urlpicture}';
                       
                    
                    }
                }
    	}
    
    }
    
    
    
    $(document).click(function(e) { 
        // Check for left button
            if (e.button == 0) {
            	changeicon();
             
        }
    });
    
    
    $(document).keypress(function(e) { 
        changeicon();
    });
    
    $(document).keydown(function(e) { 
        changeicon();
    });
    
    $(document).keyup(function(e) { 
        changeicon();
    });
    
    $(document).mousemove(function(e) { 
        changeicon();
    });
    
    
    
    function showCreateAccountForm() {
        document.getElementById('top').scrollIntoView();       
        $j('#createAccountForm').show();
        $j('.submitNewAccount').show();
        $j('#btnShowCreateAccount').hide();
        $j('#searchForm').hide();
        $j('#CreateAccount .login_box').addClass('no_border');
        $j('#errorBox').hide();
        $j('#infoBox').hide();
        $j('#searchResultsHQ').hide();
        $j('#searchResults').hide();
        if($j('form[id*="newCompanyForm"]')) {$j('form[id*="newCompanyForm"]').hide();}
        $j('input[id*="back"]').css('display', 'none');
        $j('input[id*="back2"]').css('display', 'block');
        //document.getElementById('{!$Component.newAccount.back}').style.display = 'none';
        //document.getElementById('{!$Component.newAccount.back2}').style.display = 'block';
        
        var all = $j("div[id=recordstatuscontainer]");
        var box = all[0];
        //var pict = box.childNodes[0];
        //if (pict != null)    pict.src = '{!urlpicture}';
        
        
        
        
        if ("{!showcreateother}" == "true") {
            
            $j('#OtherCreateAccount').hide();
            $j( "input[name$='back1']" ).hide();

                
            if (document.getElementById('OtherCreateAccount') != null)
                document.getElementById('OtherCreateAccount').style.display = 'none';
            
            $j('#submitAccountButtons').show();
            
            
        
        
        }
        
        //EM: For the 5 countries with different taxations (Brazil, Venezuela, Australia, USA, Canada), state/province must be read-only
        var country = "{!searchCountryName}";
        //alert("Country: " +country);
        if (country == 'Canada' || country == 'United States' || country == 'Venezuela' || country == 'Australia' || country == 'Brazil') {
            //$j("#shippingstate").find("input").attr('readonly', true);
            //$j("#billingstate").find("input").attr('readonly', true);
        	//$j("#billingstate").addClass("rec");
            var scity = $j("#shippingcity").find("input").val();
            var sstate = $j("#shippingstate").find("input").val();
            $j("#shippingcity").change(function() {
                    //alert("change");
                    var shippingc = $j("#shippingcity").find("input").val();
                    var shippings = $j("#shippingstate").find("input").val();
                    if ((!shippingc || 0 === shippingc.length) && shippings.length>0) {
                        //alert("Delete sstate");
                        $j("#shippingstate").find("input").val("");
                }
                });
                
            $j("#billingcity").change(function() {
                    //alert("change");
                    var billingc = $j("#billingcity").find("input").val();
                    var billings = $j("#billingstate").find("input").val();
                    if ((!billingc || 0 === billingc.length) && billings.length>0) {
                        //alert("Delete sstate");
                        $j("#billingstate").find("input").val("");
                }
                });
        }
        
    
    }
    if('{!createAccountErroeMode}'=='true'){
        showCreateAccountForm(); 
        $j('#errorBox').show();
    }
                   
    function copyBillingAddress() {
        var checkBox = document.getElementById('copyCheckBox');
        var isIEC = "{!sRefererCommunity}"=="iec";
        if (checkBox.checked){
            $j("#shippingstreet").find("textarea").val($j("#billingstreet").find("textarea").val());
            $j("#shippingcity").find("input").val($j("#billingcity").find("input").val());
            $j("#shippingstate").find("input").val($j("#billingstate").find("input").val());
            $j("#shippingpostalcode").find("input").val($j("#billingpostalcode").find("input").val());
            if(isIEC) {          	
            	$j('[id*="drpdwnCountry"]').attr('disabled', 'disabled');
            	$j("#shippingcountry").find("input").val(defCountry);
            	$j('[id*="drpdwnCountry"]').val(defCountry);            	
            	shippingListStates();
            	if($j('#divToMove3').css('display') != 'none') {
            		$j('#drpdwnSState').val($j('#drpdwnBState').val());
            	} else {
            		$j("#shippingstate").find("input").val($j("#billingstate").find("input").val());
            	}
            }
        } else if(!checkBox.checked && isIEC) {
        	$j('[id*="drpdwnCountry"]').removeAttr('disabled');
        }
    }
    
    function saveCountryName() {
        $j(".countryName").val($j(".searchCountry option:selected").text());
    }
    
    function showCategory(div1, div2, inputValue, div3){
        var myDiv1 = document.getElementById(div1);
        var myDiv2 = document.getElementById(div2);
        var myDiv3 = document.getElementById(div3);
        var myInputValue = document.getElementById(inputValue).value;
        if (myInputValue == 'Other'){
            myDiv1.style.display='block';
            myDiv2.style.display='block';
            myDiv3.style.display='block';
        }
        else {
            myDiv1.style.display='none';
            myDiv2.style.display='none';
            myDiv3.style.display='none';
        }
            
    }
    
    function blockme() {
        var myDiv = document.getElementById('submitAccountButtons');
        var myDivWait1 = document.getElementById('pleaseWait1');
        var myDivWait2 = document.getElementById('pleaseWait2');
        myDiv.style.display='none';
        myDivWait1.style.display='block';
        myDivWait2.style.display='block';
    }
    
    function blockme2() {
        var myDiv = document.getElementById('submitAccountButtons1');
        var myDivWait1 = document.getElementById('pleaseWait1');
        var myDivWait2 = document.getElementById('pleaseWait2');
        myDiv.style.display='none';
        myDivWait1.style.display='block';
        myDivWait2.style.display='block';   
    }
    
    function removeSectorValues(customerType, sector){
        if (customerType == 'NonIATAAgent'){ 
            var myPicklist = document.getElementById(sector);
            if (myPicklist.length > 3){
                myPicklist.innerHTML = null;
                var option = document.createElement("option");
                option.text = "";
                myPicklist.add(option);
                var option1 = document.createElement("option");
                option1.text = "Cargo Agent";
                myPicklist.add(option1);
                var option2 = document.createElement("option");
                option2.text = "Travel Agent";
                myPicklist.add(option2);
            }
            /*
            alert(myPicklist.length);
            for (i = 0 ; i < myPicklist.length ; i++){
                if (myPicklist.options[i].text != 'Cargo Agent' && myPicklist.options[i].text != 'Travel Agent'){
                    alert("REMOVING: " + myPicklist.options[i].text + " : " + i);
                    myPicklist.remove(i);
                }
            }
            */
        }
    }
                  
</Script>                 

     </apex:define>
  </apex:composition>
 
  
</apex:page>