<apex:page controller="ISSP_AMS_Accreditation"
           cache="false"
           sidebar="false"
           showHeader="false"
           standardStylesheets="false"
           applyBodyTag="false"
           applyHtmlTag="false"
           >
<html>
        <style>
            .moveup {
                position: relative;
                bottom: 160px;
            }
            .movetableup {
                position: relative;
                bottom: 246px;
            }
        </style>
        <c:ISSP_Header ></c:ISSP_Header>    
        <body>
        <script src="{!URLFOR($Resource.bootbox)}" />
        <script type="text/javascript">
                var $j = jQuery.noConflict();
   
                $j(function () {
                    $j('[data-toggle="tooltip"]').tooltip();
                })

                function checkEligibility(isBankAccountChange){
                    if ('{!isHOAccredited}'=='false'){
                        bootbox.alert("{!$Label.ISSP_AMS_NoC_Message_Accredited_Agent}");
                    }
                    else
                        navigateToUrl('/ISSP_AMS_Accreditation?isNoticeOfChange=true&isBankAccountChange='+isBankAccountChange+'&retUrl=/ISSP_HomePage','LIST_VIEW','newCase');
                }
            
                function proceedToVMFR() {
                    bootbox.confirm("{!JSENCODE($Label.ISSP_AMS_Step0_Proceed_VMFR)}", function(result) {
                        if(result) {
                            window.open('/ISSP_FAQ2Case?MainNav=Queries&subNav=MyQueries&mid=M1S1', '_self');
                        }
                    });
                }
        </script>
    
    <div class="container">   
        <c:ISSP_CustomNavigation />
    <div>
        <img src="/resource/1440419254000/IATA_Logo_Large" width="138" height="102" style="float:left"/>
    </div>
    <div style="padding-top:16px;padding-left:44px">
        <h3>{!$Label.ISSP_AMS_Step0_SAA}</h3>
        <apex:outputText value="{!$Label.ISSP_AMS_Step0_Intro}" escape="false"/>
    </div>
    <div style="padding-left:138px">
          <apex:form > 
        <table width="100%">
            <tr>
                <td style="width:40%"><h3><apex:outputText value="{!$Label.ISSP_AMS_Step0_Agency_Accreditation}"/></h3></td>
                <td><h3><apex:outputText value="{!$Label.ISSP_AMS_Step0_Changes}" rendered="{!isoCountry.Enable_Notice_of_Change__c}"/></h3></td>
            </tr>
            <tr>
                <td style="vertical-align:top;padding-bottom:10px">
                    <input type="button" class="btn btn_iata_primary" onClick="navigateToUrl('/ISSP_AMS_Accreditation?retUrl=/ISSP_HomePage','LIST_VIEW','newCase');return false;" value="{!$Label.ISSP_AMS_Step0_New_Application}"/>
                    <div><apex:outputText value="{!$Label.ISSP_AMS_Step0_Intro_Accred}" escape="false"/>
                    <apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!$Label.ISSP_AMS_Step0_Intro_Accred_Msg}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
                    </div>
                </td>
                <td style="display:{!IF(AND(isEligableForChange,isoCountry.Enable_Notice_of_Change__c),'','none')};vertical-align:top">
                    <input type="button" class="btn btn_iata_primary" onClick="checkEligibility('true');return false;" value="{!$Label.ISSP_AMS_Step0_Change_Bank_Details}"/><br/>
                </td>
            </tr>
            <tr>
                <td style="vertical-align:top">
                    <strong><apex:outputText escape="false" value="{!$Label.ISSP_AMS_Step0_In_Addition}" rendered="{!AND(isHOAccredited, sector=='Travel Agent')}"/></strong><br/>
                    <apex:commandLink action="{!redirectToCasePage}" value="{!$Label.ISSP_AMS_Step0_Specific_Sales_Activity}" id="SACommandLink" rendered="{!AND(isHOAccredited, sector=='Travel Agent')}">
                        <apex:param assignTo="{!agentCaseType}" value="SA" />
                    </apex:commandLink><br/>
                    <!-- TIDS out-of-scope for now
                    <apex:commandLink action="{!redirectToCasePage}" value="Travel Industry Designator Service (TIDS)" id="TIDSCommandLink" rendered="{!AND(NOT(isHOAccredited), con.Account.Sector__c=='Travel Agent')}">
                        <apex:param assignTo="{!agentCaseType}" value="TIDS" />
                    </apex:commandLink>
                    -->
                </td>
                <td style="display:{!IF(AND(isEligableForChange,isoCountry.Enable_Notice_of_Change__c),'','none')};vertical-align:top">
                    <table>
                        <tr>
                            <td><input type="button" class="btn btn_iata_primary" onClick="checkEligibility('false');return false;" value="{!$Label.ISSP_AMS_Step0_Other_Changes}"/></td>
                            <td style="padding-left:8px"><apex:outputText escape="false" value="{!$Label.ISSP_AMS_Step0_Other_Changes_Msg}"/></td>
                        </tr>
                    </table>
                </td>
            </tr>
                <tr>
                    <td style="padding-top:20px">
                        <apex:outputText escape="false" value="{!$Label.ISSP_AMS_Step0_Agency_Article}"/>
                        <a href="#"><apex:outputLink value="{!$Label.ISSP_PKB_URL}{!CASE(displayLanguage, 'ar', 'ar', 'fr', 'fr', 'it', 'it', 'de', 'de', 'es', 'es', 'pt_BR', 'pt_BR', 'ja', 'ja', 'ko', 'ko', 'in', 'in', 'th', 'th', 'vi', 'vi', 'zh_CN', 'zh_CN', 'en_US')}/How_To/Customer-Portal-Troubleshooting/?l={!CASE(displayLanguage, 'ar', 'ar', 'fr', 'fr', 'it', 'it', 'de', 'de', 'es', 'es', 'pt_BR', 'pt_BR', 'ja', 'ja', 'ko', 'ko', 'in', 'in', 'th', 'th', 'vi', 'vi', 'zh_CN', 'zh_CN', 'en_US')}" rendered="{!$Site.RegistrationEnabled}" target="_blank">{!$Label.ISSP_Article}</apex:outputLink></a>
                    </td>
                    <td style="vertical-align:bottom" class="{!IF(AND(isEligableForChange,isoCountry.Enable_Notice_of_Change__c),'',(IF(!isoCountry.Enable_Notice_of_Change__c,'none','moveup')))}">
                        <apex:outputText escape="false" value="{!$Label.ISSP_AMS_Step0_Minor_Changes}" rendered="{!AND(isoCountry.Enable_Notice_of_Change__c,isoCountry.Enable_Minor_Changes_from_Portal__c,bIsAdmin)}"/>
                    </td>
            </tr>
            <tr>
                <td><h3><apex:outputText value="{!$Label.ISSP_AMS_Step0_Other_Forms}"/></h3></td>
                <td class="{!IF(AND(isEligableForChange,isoCountry.Enable_Notice_of_Change__c),'',(IF(!isoCountry.Enable_Notice_of_Change__c,'movetableup','moveup')))}"><h3><apex:outputText value="{!$Label.ISSP_AMS_Step0_Ongoing_Drafts}"/></h3></td>
            </tr>
            <tr>
                <td style="vertical-align:top">
                    <apex:commandLink action="{!redirectToCasePage}" value="{!$Label.ISSP_AMS_Step0_Request_Voluntary_Reliquishment}" id="VRCommandLink" rendered="{!isHOAccredited}">
                        <apex:param assignTo="{!agentCaseType}" value="VR" />
                    </apex:commandLink>
                    <apex:outputText escape="false" rendered="{!isHOAccredited}"><br/></apex:outputText>
                    <a href="#" onclick="proceedToVMFR();return true;">{!$Label.ISSP_AMS_Step0_VMFR}</a>
                </td>
                <td style="vertical-align:top" class="{!IF(AND(isEligableForChange,isoCountry.Enable_Notice_of_Change__c),'',(IF(!isoCountry.Enable_Notice_of_Change__c,'movetableup','moveup')))}">
            <apex:pageBlock >
            <apex:pageBlockTable value="{!AMSDraftCases}" var="MyAMSCases" styleClass="table" rendered="{!NOT(IsEmpty)}">
            <apex:column headerValue="{!$ObjectType.Case.fields.CaseNumber.label}" rendered="{!NOT(AND(isoCountry.Enable_Notice_of_Change__c==false,NOT(BEGINS(MyAMSCases.Reason1__c, 'New'))))}">
                <apex:outputLink value="/ISSP_AMS_Accreditation?caseId={!MyAMSCases.Id}&step=2" rendered="{!BEGINS(MyAMSCases.Reason1__c, 'New')}">{!MyAMSCases.CaseNumber}</apex:outputLink>
                <apex:outputLink value="/ISSP_AMS_Accreditation?caseId={!MyAMSCases.Id}&isNoticeOfChange=true&isBankAccountChange=true&step=2" rendered="{!MyAMSCases.Reason1__c=='Bank Detail Update'}">{!MyAMSCases.CaseNumber}</apex:outputLink>
                <apex:outputLink value="/ISSP_AMS_Accreditation?caseId={!MyAMSCases.Id}&isNoticeOfChange=true&isBankAccountChange=false&step=2" rendered="{!NOT(OR(BEGINS(MyAMSCases.Reason1__c, 'New'),MyAMSCases.Reason1__c=='Bank Detail Update'))}">{!MyAMSCases.CaseNumber}</apex:outputLink>
            </apex:column>
            <apex:column value="{!MyAMSCases.Subject}" rendered="{!NOT(AND(isoCountry.Enable_Notice_of_Change__c==false,NOT(BEGINS(MyAMSCases.Reason1__c, 'New'))))}"/>
            <apex:column value="{!MyAMSCases.Portal_Case_Status__c}" rendered="{!NOT(AND(isoCountry.Enable_Notice_of_Change__c==false,NOT(BEGINS(MyAMSCases.Reason1__c, 'New'))))}"/>
            <apex:column value="{!MyAMSCases.CreatedDate}" rendered="{!NOT(AND(isoCountry.Enable_Notice_of_Change__c==false,NOT(BEGINS(MyAMSCases.Reason1__c, 'New'))))}"/>
            </apex:pageBlockTable>
            
            <apex:outputText styleClass="bg-info" value="{!$Label.ISSP_AMS_No_Pending}" rendered="{!IsEmpty}"/>
                
            </apex:pageBlock>    
                
                </td>
            </tr>
            
        </table>
     
   </apex:form>
   </div>
    
    <c:ISSP_CustomFooter />
</div><!-- end container-->
        
  </body>  
</html>
</apex:page>