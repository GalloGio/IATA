<apex:page controller="ISSP_AMS_Accreditation" 
           showHeader="false"
           sidebar="false"
           language="{!displayLanguage}"
           standardStylesheets="true"
           applyBodyTag="false"
           applyHtmlTag="false"
           action="{!securityCheck}">
    
	<html> 
		<c:ISSP_Header communityName="{!communityName}" ></c:ISSP_Header>
		<c:ISSP_WaitingStatus />
		<body>
		<script src="{!URLFOR($Resource.bootbox)}" />
		<script src="{!URLFOR($Resource.datePickerFix)}" />
		<link rel="stylesheet" href="{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/build/css/intlTelInput.css')}"/>
		<link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css" rel="stylesheet" />
		<script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
		<script src="{!URLFOR($Resource.jquery_file_upload, '/jQuery-File-Upload-9.11.2/js/jquery.iframe-transport.js')}" />
		<script src="{!URLFOR($Resource.jquery_file_upload, '/jQuery-File-Upload-9.11.2/js/jquery.fileupload.js')}" />
		
	<style>
		#tooltip-add-ass-contact:hover:after{
			content: attr(html-title);
			display:block;
			padding: 5px;
			color: #8a6d3b;
			background-color: #fcf8e3;
			border-color: #faebcc;
			border-radius: 4px; 
			font-size: 14px;
		}
        
        .phone-input {
            padding-left:26px !important;
          	width:100px !important
           }
                   
        select, input, textarea {
           	margin-left: 20px;
           }
	</style>
    
	<script type="text/javascript">
	var defaultHQCountry = '{!newCase.IFAP_Country_ISO__c}';
	var $j = jQuery.noConflict();
    var isEUcountry = {!isEUcountry};

	$j(function () {
		$j('[data-toggle="tooltip"]').tooltip();
	})

	$j(document).ready(function() {
		$j('[id$=section4_2]').css('width','95%');
		$j('[id$=prevCompanySection]').css('width','95%');
		$j(".country__c").val("{!isocountry.Name}");
        initFieldsSettings();
		
		// binds on change to make checkbox function as radio buttons
		$j('[data-group]').on('change', function() {
			var $parent = $j(this);
			$j('[data-group]').not(this).each(function(){
				if($j(this).data('group') == $parent.data('group')) $j(this).prop('checked', false);
			});
			
			showForms();
		});

		// checks initial state
		showForms();
	});

	var ownerRecType;
	var companyOwnerRecType;


	function showForms() {

		$j('[data-controls]').each(function(){
			var controlledId = $j(this).data('controls');
			var $form = $j('.'+controlledId);

			if($j(this).prop('checked')) $form.show();//removeClass('invisible');
			else $form.hide();//addClass('invisible');
		});
	} 

	function closeModal() {

		$j(function() {
			$j( '#addNewContactModal' ).modal('hide');
            //clearForm('{!$Component.newContact}', '{!$Component.newContact.contactBlock.contactcountry}');
		});
	}

	function initFieldsSettings(){
        /**
		if("{!newForm.Branch_Office_Street_name_number__c}"=='' && "{!isValError}"=='true')
			$j('.branch_office_street_name_number__c').addClass('requiredIndicator');
		if("{!newForm.Branch_Office_City__c}"=='' && "{!isValError}"=='true')
			$j('.branch_office_city__c').addClass('requiredIndicator');
        if("{!newForm.Branch_office_email__c}"=='' && "{!isValError}"=='true')
			$j('.branch_office_email__c').addClass('requiredIndicator');
            **/
		$j('.requiredIndicator').wrap('<div class="requiredInput">').before('<div class="requiredBlock"></div>'); 
		$j(".country__c").attr('readonly', true);
		$j(".country__c").attr('disabled','disabled');
        $j(".labelText").hide();
		$j("[id$=branch_office_phone__c]").hide();
	}

	function updateTradeNameInfo(){
		if ($j('[id$=tradenameafterchange]').val() !='' && $j('[id$=tradenameafterchange]').val()!=undefined)
			$j('[id$=tradenameoutput]').text($j('[id$=tradenameafterchange]').val());
		else
			$j('[id$=tradenameoutput]').text("{!accountConcerned.TradeName__c}");
		$j('[id$=modaltradename]').val($j('[id$=tradenameoutput]').text());
	}

	function updateLegalNameInfo(){
		if ($j('[id$=legalnameafterchange]').val() !='' && $j('[id$=legalnameafterchange]').val()!=undefined)
			$j('[id$=legalnameoutput]').text($j('[id$=legalnameafterchange]').val());
		else
			$j('[id$=legalnameoutput]').text("{!accountConcerned.Name}");
		$j('[id$=modallegalname]').val($j('[id$=legalnameoutput]').text());
	}

	function updateModalAddressInfo(){
		if ($j('.branch_office_street_name_number__c:eq(0)').val() !='' && $j('.branch_office_street_name_number__c:eq(0)').val()!=undefined)
			$j('.branch_office_street_name_number__c:eq(1)').val($j('.branch_office_street_name_number__c:eq(0)').val());
		else
			$j('.branch_office_street_name_number__c:eq(1)').val("{!accountConcerned.BillingStreet}");
		if ($j('.branch_office_city__c:eq(0)').val() !='' && $j('.branch_office_city__c:eq(0)').val()!=undefined)
			$j('.branch_office_city__c:eq(1)').val($j('.branch_office_city__c:eq(0)').val());
		else
			$j('.branch_office_city__c:eq(1)').val("{!accountConcerned.BillingCity}");
		if ($j('.branch_office_postal_code__c:eq(0)').val() !='' && $j('.branch_office_postal_code__c:eq(0)').val()!=undefined)
			$j('.branch_office_postal_code__c:eq(1)').val($j('.branch_office_postal_code__c:eq(0)').val());
		else
			$j('.branch_office_postal_code__c:eq(1)').val("{!accountConcerned.BillingPostalCode}");
		if ($j('.state_province__c:eq(0)').val() !='' && $j('.state_province__c:eq(0)').val()!=undefined)
			$j('.state_province__c:eq(1)').val($j('.state_province__c:eq(0)').val());
		else
			$j('.state_province__c:eq(1)').val("{!accountConcerned.BillingState}");

	}

	function updateAddressInfo(){
		var billingaddress;

		updateModalAddressInfo();


		billingaddress = $j('.branch_office_street_name_number__c:eq(1)').val()+'<br/>'+$j('.branch_office_city__c:eq(1)').val()+', '+$j('.branch_office_postal_code__c:eq(1)').val()+'<br/>';
		if ($j('.state_province__c:eq(1)').val()!='')
			billingaddress += $j('.state_province__c:eq(1)').val() + ', ' ;
		billingaddress += "{!isocountry.Name}";

		$j('[id$=billingaddress]').html(billingaddress);


	}

	function updatePhoneInfo(){
		if ($j('[id$=locationphone]').val() !='' && $j('[id$=locationphone]').val()!=undefined)
			$j('[id$=phoneoutput]').text($j('[id$=locationphone]').val());
		else
			$j('[id$=phoneoutput]').text("{!accountConcerned.Phone}");

		$j('[id$=companyphone]').val($j('[id$=phoneoutput]').text());
		$j('[id$=companyphoneinput]').intlTelInput("setNumber",$j('[id$=companyphone]').val());
	}

	function updateFaxInfo(){
		if ($j('[id$=locationfax]').val() !='' && $j('[id$=locationfax]').val()!=undefined)
			$j('[id$=faxoutput]').text($j('[id$=locationfax]').val());
		else
			$j('[id$=faxoutput]').text("{!accountConcerned.Fax}");
		$j('[id$=companyfax]').val($j('[id$=faxoutput]').text());
		$j('[id$=companyfaxinput]').intlTelInput("setNumber",$j('[id$=companyfax]').val());
	}

	function toggleShareholdersMsg(myValue,prefix){
			if( $j('input[name="' + myValue + '"][value=No]').prop("checked")) {
				document.getElementById(prefix+'msgshareholdersdetails').style.display='block';
			} else {
				document.getElementById(prefix+'msgshareholdersdetails').style.display='none';
			}
	}


	var ownerModalFields = [];
	ownerModalFields[0] = "{!$Component.newContact.contactBlock.Financial_interest__c}";
	//ownerModalFields[1] = "{!$Component.newContact.contactBlock.Number_Of_Shares__c}";
                   
	function toggleModalContactFields(ownerId) {
		if(document.getElementById(ownerId).checked){
			for (index = 0; index < ownerModalFields.length; index++) {
				document.getElementById(ownerModalFields[index]).disabled = false;
			}
            $j('[id$=contactFinInterest]').wrap('<div class="requiredInput">').before('<div class="requiredBlock"></div>');           
		} else {
			for (index = 0; index < ownerModalFields.length; index++) {
				document.getElementById(ownerModalFields[index]).disabled = true;
				document.getElementById(ownerModalFields[index]).value = null;
			}
            if($j('[id$=contactFinInterest]').parent().is('div')) {
                	$j('[id$=contactFinInterest]').unwrap().prev('.requiredBlock').remove();
            }
		}
	}

	

    function toggleInternationalSales(myValue, salesId){
        //  alert( $j('input[name="' + myValue + '"]:checked').val() + ' was selected.' );
            if( $j('input[name="' + myValue + '"][value=Yes]').prop("checked")) {
                document.getElementById('InternationalSales').style.display='block';
             } else {
                document.getElementById('InternationalSales').style.display='none';
             }
    }

    function showNewSalesDialog() {
        $j(function() {
            $j( '#addNewSalesModal').modal('show');
      });
    }		

	function closeSalesDialog() {
		$j(function() {
			$j( '#addNewSalesModal' ).modal('hide');
		});
	}

    function confirmInternationalSaleDelete(isaleid, isalename, isaletype) {
        msg =
        bootbox.confirm('{!$Label.ISSP_AMS_CONFIRM_DELETE}', function(result) {
            if(result) {
                deleteInternationalSale(isaleid);
            }
        });
    }

	function updateCompanyOwnerRT(recTypeName){
		companyOwnerRecType = recTypeName;
	}

	function updateOwnerRT(recTypeName){
		ownerRecType = recTypeName;
        
		if (ownerRecType=='Current Owner'){
			$j('[id$=personEmail]').show();
            $j('[id$=personPhone]').show();
            //$j('[id$=ownerContactTitleAfterChange]').show(); 
            //$j('[id$=c]').hide();				
			if($j('[id$=UpdatedLegalStatus]').val()=='Corporation')
				$j('[id$=corporatefield2]').show();
			else
				$j('[id$=corporatefield2]').hide();				
		}
	}

	function closeModal() {

		$j(function() {
			$j( '#addNewContactModal' ).modal('hide');
			clearForm('{!$Component.newContact}', '{!$Component.newContact.contactBlock.contactcountry}');
		});

	}

	function closeModal2() {
		$j(function() {
			$j( '#addNewCompanyModal' ).modal('hide');
		});
	}

	function showNewCompanyDialog() {
		$j(function() {
			$j( '#addNewCompanyModal').modal('show');
		});
	}

	function toggleContactDetails(s) {
		if($j(s).hasClass("glyphicon-plus")) {
			$j(s).switchClass("glyphicon-plus", "glyphicon-minus");
		} else {
			$j(s).switchClass("glyphicon-minus", "glyphicon-plus");
		}
		$j("." + s.id).toggle();
	}

	function closeModalWithConsoleLogComment() {

		$j(function() {
			$j( '#addNewContactModal' ).modal('hide');
			clearForm('{!$Component.newContact}', '{!$Component.newContact.contactBlock.contactcountry}');
		});

	}

	function closeModal3() {
		$j(function() {
			$j( '#updateAgencyLegalDetailsModal' ).modal('hide');
		});
	}
					
	function closeModal4() {
		$j(function() {
			$j( '#updateAgencyLocationModal' ).modal('hide');
		});
	}

	function showUpdateAgencyLegalDetailsDialog() {
		$j(function() {
			$j( '#updateAgencyLegalDetailsModal').modal('show');
		});
	}
					
	function showUpdateAgencyLocationDialog() {
		$j(function() {
			$j( '#updateAgencyLocationModal').modal('show');
		});
	}

	function showNewContactDialog() {
		$j(function() {
			$j( '#addNewContactModal').modal('show');
		});
	}

	function showNewIFAPContactDialog() {
		$j(function() {
			$j( '#addNewIFAPContactModal').modal('show');
			$j('[id$=financialAssContactField]')[0].checked = true;
			$j('[id$=financialAssContactField]')[0].disabled = true;
		});
	}

	function toggleUpdatedLegalStatus(myValue){
		var theValue = document.getElementById(myValue).value;
		if (theValue != ''){
            //$j('[id$=personTableAfterChange]').show();
            
			if(theValue!='Sole Proprietorship') {
				$j('[id$=addcompany]').show();
                $j('[id$=updated-company-owners]').show();
                $j('[id$=updated-owner-summary]').show();
			} else {
                $j('[id$=addcompany]').hide();
                //$j('[id$=updated-company-owners]').hide();
                $j('[id$=updated-owner-summary]').hide();
            }
            
			if(theValue=='Corporation')
				$j('[id$=currcorporatedetails]').show();
			else
				$j('[id$=currcorporatedetails]').hide();
		} else {
            $j('[id$=addCompany]').hide();
            /**
            //$j('[id$=personTableAfterChange]').hide();	
			$j('[id$=updated-company-owners]').hide();
            $j('[id$=updated-owner-summary]').hide();
			$j('[id$=currcorporatedetails]').hide();
            **/
		}	
		
        setHeaderLabelsAfterChange(theValue.toLowerCase());
	}


	function clearForm(fname, ctryfield) {
		var oForm = document.forms[fname];
		var elements = oForm.elements;
		oForm.reset();

	for(i=0; i<elements.length; i++) {

		field_type = elements[i].type.toLowerCase();

		switch(field_type) {

		case "text":
				elements[i].value = "";
				break;
		case "password":
		case "textarea":
			case "hidden":

			elements[i].value = "";
			break;

		case "radio":
		case "checkbox":
			if (elements[i].checked) {
				elements[i].checked = false;
			}
			break;

		case "select-one":
		case "select-multi":
					elements[i].selectedIndex = -1;
					break;
		default:
			break;
			}
		}
		
	}

	function toggleCurrencyCode(c) {
        //$j('[id$=y1CurrencyCode]').html(' ' + c);
		$j('[id$=y2CurrencyCode]').html(' ' + c);
        //$j('[id$=y3CurrencyCode]').val(c);
        //$j('[id$=y4CurrencyCode]').val(c);
	}

	function showFuturePastDates(){				
		datePickerYearsAdded = false;								
		var futureYearsToAdd = 20;	
		var pastYearsToAdd = 5;							
		if (!datePickerYearsAdded) {
			var select = document.getElementById('calYearPicker');
			if (!select) return;
			select.innerHTML = '';
			var startYear = new Date().getFullYear() - pastYearsToAdd; ;
			for (var year = startYear; year < startYear + futureYearsToAdd + 1; year++) {
				select.options[select.options.length] = new Option(year, year);
			}
			datePickerYearsAdded = true;
		}
	}
	

	function togglePrevIATACode(cb, iatacode, employername, employeraddress, cbid) {
		if(cb==null) {
			cb = document.getElementById(cbid);
		}

		if(cb.checked) {
		document.getElementById(iatacode).disabled=false;
		document.getElementById(employername).disabled=true;
		document.getElementById(employeraddress).disabled=true;
		} else {
			document.getElementById(iatacode).disabled=true;
			document.getElementById(employername).disabled=false;
			document.getElementById(employeraddress).disabled=false;
		}
	}

	function togglePageItem(v, fldId) {
		var el = document.getElementById(fldId);
		if(v=='Yes') {
			el.style.display='block';
		} else {
			el.style.display='none';
		}
	}

	function toggleIssuedCapital(v, fldId) {
		var el = document.getElementById(fldId);
		if(v=='Corporation') {
			el.style.display='block';
		} else {
			el.style.display='none';
		}
	}


	function confirmContactDelete(conid, conname, contype) {
		msg =
		bootbox.confirm('{!$Label.ISSP_AMS_CONFIRM_DELETE}', function(result) {
			if(result) {
				deleteContact(conid);
			}
		});
	} 

	function confirmIFAPContactDelete(conid, conname, contype) {
		msg = bootbox.confirm('{!$Label.ISSP_AMS_CONFIRM_DELETE}', function(result) {
			if(result) {
				deleteIFAPContact(conid);
			}
		});
	} 

	var ownerModalFields = [];
	ownerModalFields[0] = "{!$Component.newContact.contactBlock.contactFinInterest}";
	//ownerModalFields[1] = "{!$Component.newContact.contactBlock.contactNumOfShares}";
	
	function copyPhysicalAddress() {
		var checkBox = document.getElementById('copyCheckBox');
		if (checkBox.checked){
			$j(".PostalStreet").val($j(".PhysicalStreet").val());
			$j(".PostalCity").val($j(".PhysicalCity").val());
			$j(".PostalState").val($j(".PhysicalState").val());
			$j(".PostalPostalCode").val($j(".PhysicalPostalCode").val());
			$j(".PostalProvince").val($j(".PhysicalProvince").val());
			$j(".PostalArea").val($j(".PhysicalArea").val());
		}
	}
	
	</script>
	
	<div class="pageNav" style="display:{!IF(isStep3,'inline-block','none')}">
		<p class="LOB">{!$Label.ISSP_AMS_NoC_Request_for_Change}</p>
		<div style="border-top: 1px #fff dotted; padding-bottom: 3px;">
			<p>{!$Label.ISSP_AMS_Jump_To}</p>
		</div>
		<p><a href="#top">{!$Label.ISSP_AMS_Top}</a></p>
		<apex:outputText rendered="{!newform.Is_change_bank_account_details__c==true && PDFPerRegionCS!=null}">
			<p><a href="#nav_one">{!$Label.ISSP_AMS_NoC_Change_Bank_Details}</a></p>
		</apex:outputText>
		<apex:outputText rendered="{!AND(isAccreditationModelNotNullOrLegacy, NOT(isBankAccountChange))}">
			<p><a href="#nav_one">{!$Label.ISSP_AMS_NoC_Acreditation_Type_Section_Header}</a></p>
		</apex:outputText>
		<apex:outputText rendered="{!newform.Is_change_legal_name__c==true}">
			<p><a href="#nav_two">
				<apex:outputText rendered="{!!isAccreditationModelNotNullOrLegacy}">{!IF(newlabels, $Label.ISSP_AMS_NoC_Change_of_Legal_Name_New, $Label.ISSP_AMS_NoC_Change_of_Legal_Name)}</apex:outputText>
				<apex:outputText rendered="{!isAccreditationModelNotNullOrLegacy}">
					{!SUBSTITUTE(IF(newlabels, $Label.ISSP_AMS_NoC_Change_of_Legal_Name_New, $Label.ISSP_AMS_NoC_Change_of_Legal_Name), '1', '2')}
				</apex:outputText>
			</a></p>
		</apex:outputText>
		<apex:outputText rendered="{!newform.Is_change_location__c==true}">
			<p><a href="#nav_three">
				<apex:outputText rendered="{!!isAccreditationModelNotNullOrLegacy}">{!IF(newlabels, $Label.ISSP_AMS_NoC_Change_of_Location_New, $Label.ISSP_AMS_NoC_Change_of_Location)}</apex:outputText>
				<apex:outputText rendered="{!isAccreditationModelNotNullOrLegacy}">
					{!SUBSTITUTE(IF(newlabels, $Label.ISSP_AMS_NoC_Change_of_Location_New, $Label.ISSP_AMS_NoC_Change_of_Location), '2', '3')}
				</apex:outputText>
			</a></p>
		</apex:outputText>
		<apex:outputText rendered="{!newform.Is_change_bank_account_details__c==false}">
			<p><a href="#nav_four">
				<apex:outputText rendered="{!!isAccreditationModelNotNullOrLegacy}">{!IF(newlabels, $Label.ISSP_AMS_NoC_Change_Ownership_Shareholding_New, $Label.ISSP_AMS_NoC_Change_Ownership_Shareholding)}</apex:outputText>
				<apex:outputText rendered="{!isAccreditationModelNotNullOrLegacy}">
					{!SUBSTITUTE(IF(newlabels, $Label.ISSP_AMS_NoC_Change_Ownership_Shareholding_New, $Label.ISSP_AMS_NoC_Change_Ownership_Shareholding), '3', '4')}
				</apex:outputText>
			</a></p>
		</apex:outputText>
		<apex:outputText rendered="{!NOT(newform.Is_change_bank_account_details__c)}">
			<p><a href="#nav_five">
				<apex:outputText rendered="{!!isAccreditationModelNotNullOrLegacy}">{!$Label.ISSP_AMS_NoC_Additional_Information}</apex:outputText>
				<apex:outputText rendered="{!isAccreditationModelNotNullOrLegacy}">
					{!SUBSTITUTE($Label.ISSP_AMS_NoC_Additional_Information, '4', '5')}
				</apex:outputText>
			</a></p>
		</apex:outputText>
		
	</div>

    <c:ISSP_CustomNavigation communityName="{!communityName}"/>
	<div class="container">
		<div id="contentWrapper">
	
	<div class="panel-primary">
		<div class="panel-heading head_panel_green">
			{!lblNocRequest} 
		</div>
	<div class="panel-body" id="body-enquiries">
		<apex:form id="AMSForm">
		<div class="progress">
			<div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 22%;">
				<apex:commandLink styleclass="btn btn-default" action="{!saveAMSFormAndGoToStep1}" value="{!lblNoCStepA}" id="Prev1"/>
			</div>
			<div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="0" style="width: 25%;">
				<apex:commandLink styleclass="btn btn-default" action="{!saveAMSFormAndGoBack}" value="{!lblStepB}" id="Prev2"/>
			</div>
			<div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 22%;">
				{!lblNocStepC}
			</div>
			<div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 16%;display:{!IF(isNoticeOfChange && newForm.Is_change_ownership_or_shareholding__c, 'none', '')}">
				<apex:commandLink styleclass="btn btn-default" action="{!saveAMSFormAndGoForward}" value="{!lblStepD}" id="Next4"/>
			</div>
			<div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 15%">
				<apex:commandLink styleclass="btn btn-default" action="{!saveAMSFormAndGoToStep5}" value="{!IF(isNoticeOfChange && newForm.Is_change_ownership_or_shareholding__c, lblNocStepD, lblStepE)}" id="Next5"/>
			</div>
		</div>
		
			<apex:actionFunction name="showOwnershipSec" action="{!NULL}" status="WaitingStatus" reRender="updated-person-owners"/>
			<apex:actionFunction name="cancelAgentUpdate" action="{!cancelAgentUpdate}" status="WaitingStatus" reRender="newContact"/>
			<apex:actionFunction name="accountUpdatedToggleOff" action="{!accountUpdatedToggleOff}" status="WaitingStatus" reRender="updateAgency"/>
			<apex:actionFunction name="cancelCompanyUpdate" action="{!cancelAgentUpdate}" status="WaitingStatus" reRender="newCompany"/>
			<apex:actionFunction name="cancelSalesUpdate" action="{!cancelSalesUpdate}" status="WaitingStatus" reRender="newSalesForm"/>
			<apex:actionFunction name="createAgencyContact" action="{!createAgencyContact}" oncomplete="if ({!contactSaved==true}){closeModalByCommandButton(); cancelAgentUpdate();} $j('[id$=submitBut]').removeAttr('disabled');" status="WaitingStatus" reRender="currContactList,currOwnerSummaryList,theMessages" >
				<apex:param value="" name="contype" assignTo="{!contactType}" />
			</apex:actionFunction>
			<apex:actionFunction name="createAgencyCompany" action="{!createAgencyContact}" oncomplete="if ({!contactSaved==true}){closeModal2(); cancelCompanyUpdate();} $j('[id$=companySubmitBut]').removeAttr('disabled');" status="WaitingStatus" reRender="companyList,currCompanyList,currOwnerSummaryList,ownerList,companyMessages,updated-company-owners" >
				<apex:param value="" name="contype" assignTo="{!contactType}" />
			</apex:actionFunction>
			<apex:actionFunction name="deleteContact" action="{!deleteAgencyContact}" rerender="currContactList,updated-company-owners,currOwnerSummaryList"> 
				<apex:param value="" name="recordId" assignTo="{!editContactId}" />
			</apex:actionFunction>
			<apex:actionFunction name="deleteIFAPContact" action="{!deleteAgencyContact}" rerender="contactIFAPList, comandButtonAddAssContact, theMessages"> 
				<apex:param value="" name="recordId" assignTo="{!editContactId}" />
			</apex:actionFunction>
			<apex:actionFunction name="cancelFormUpdate" action="{!cancelFormUpdate}" status="WaitingStatus" reRender="none"/>
            <apex:actionFunction name="fetchTravelAgent3" action="{!fetchAgentDetails}" status="loadingDetailsCompanyModal" reRender="companyModalIataCodeValidation">
                <apex:param name="travelAgentCode" assignTo="{!iatacode}" value=""/>
                <apex:param name="AgentSector" assignTo="{!agentsector}" value="Both"/>
                <apex:param name="isAddCompanyModal" assignTo="{!isAddCompanyModal}" value="true"/>
            </apex:actionFunction>
            <apex:actionFunction name="fetchTravelAgent4" action="{!fetchAgentDetails}" status="loadingNewHODetailsModal" reRender="NewHOCodeValidation">
                <apex:param name="travelAgentCode" assignTo="{!iatacode}" value=""/>
                <apex:param name="AgentSector" assignTo="{!agentsector}" value="Both"/>
                <apex:param name="isAddCompanyModal" assignTo="{!isAddCompanyModal}" value="true"/>
            </apex:actionFunction>
					
			<apex:pageBlock id="AMSBlock">
			<div class="alert alert-info" role="alert">
				{!$Label.ISSP_AMS_NoC_StepB_message}
			</div>
			<apex:pageBlockButtons >
				<apex:commandButton action="{!saveAMSFormAndGoBack}" value="{!$Label.ISSP_Back}"/>&nbsp;
				<apex:commandButton action="{!saveAMSFormAndGoForward}" value="{!$Label.ISSP_Next}" />
				<apex:commandButton action="{!saveAMSFormAndLeave}" value="{!$Label.ISSP_Save_Draft}" style="float:right" />
			</apex:pageBlockButtons>
			<apex:PageMessages id="msgs"/>
			<div class="apcontainer" style="border: 1px solid #ececec;">
				<apex:outputText rendered="{!newform.Is_change_bank_account_details__c && PDFPerRegionCS!=null}">
					<span id="nav_one"></span>
				</apex:outputText>
				<apex:pageBlockSection columns="1" collapsible="false" rendered="{!newform.Is_change_bank_account_details__c && PDFPerRegionCS!=null}">
					<apex:facet name="header">
						<apex:outputpanel >
							{!$Label.ISSP_AMS_NoC_Change_Bank_Details}
						</apex:outputpanel>
					</apex:facet>
					<apex:panelGrid columns="1" rendered="{!isocountry.original_bank_details_not_required__c==false}">	
						<apex:outputText value="{!$Label.ISSP_AMS_NoC_Bank_details_message1}"/>
						<br/>
						<apex:outputText escape="false" value="{!PDFPerRegionCS.Address__c}" style="padding-left:26px"/>
						<apex:outputText value="{!$Label.ISSP_AMS_NoC_Bank_details_message2}"/>
					</apex:panelGrid>
					<apex:panelGrid columns="1" rendered="{!isocountry.original_bank_details_not_required__c==true}">	
						<apex:outputText escape="false" value="{!$Label.ISSP_AMS_NoC_Bank_details_message1}"/>
					</apex:panelGrid>
					
				</apex:pageBlockSection>
				
				<apex:pageBlockSection columns="1" rendered="{!NOT(newform.Is_change_bank_account_details__c)}">
					<apex:outputText escape="false" value="{!IF(newlabels, $Label.ISSP_AMS_NOC_Instructions_New, $Label.ISSP_AMS_NOC_Instructions)}"/>
				</apex:pageBlockSection>
				<apex:outputPanel rendered="{!AND(isAccreditationModelNotNullOrLegacy, NOT(isBankAccountChange))}">
					<span id="nav_one"></span>
					<apex:pageBlockSection columns="2" collapsible="false" id="accreditationModelSection">
						<apex:facet name="header">
							<apex:outputpanel >
								{!$Label.ISSP_AMS_NoC_Acreditation_Type_Section_Header}
							</apex:outputpanel>
						</apex:facet>
						<apex:outputPanel layout="block" style="font-weight:bold; padding:5px 10px; font-size:110%;width:100%;background-color:rgb(195,225,240)">{!$Label.ISSP_AMS_NoC_Current_Accreditation_Type}</apex:outputPanel>
						<apex:outputPanel layout="block" style="font-weight:bold; padding:5px 10px; font-size:110%;width:100%;background-color:rgb(195,225,240)">
							{!$Label.ISSP_AMS_NoC_Updated_Accreditation_Type}
							<a href="#" style="float: right; font-size:90%; font-weight: normal;" data-toggle="modal" data-target="#ModalProductComparison" >{!$Label.ISSP_AMS_Compare_Accreditation_Types}</a>
						</apex:outputPanel>
					
						<apex:pageBlockSectionItem labelStyle="width:40%" dataStyle="width:10%;{!IF(AND(isValError, newForm.Confirm_accreditation_type_are_correct__c==false,newForm.Notify_Change_Accreditation_Type__c==false), 'border:2px red solid !important;margin-right:5px', 'margin-right:5px')}">
							<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Confirm_accreditation_type_are_correct__c.Label}" style="color:black;font-size:110%"/>
							<apex:inputCheckbox id="confirmAccType" value="{!newForm.Confirm_accreditation_type_are_correct__c}" onchange="accreditationModelChanged('isCorrect')"/>
						</apex:pageBlockSectionItem>
							
						<apex:pageBlockSectionItem labelStyle="width:40%;" dataStyle="width:10%;{!IF(AND(isValError, newForm.Notify_Change_Accreditation_Type__c==false, newForm.Confirm_accreditation_type_are_correct__c==false, CanChangeAccreditationType), 'border:2px red solid !important;margin-right:5px', 'margin-right:5px')}">
							<apex:outputPanel >
								
								<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Notify_Change_Accreditation_Type__c.Label}" style="color:black;font-size:110%"/>
							</apex:outputPanel>
							<apex:inputCheckbox id="iataChangeAccType" value="{!newForm.Notify_Change_Accreditation_Type__c}" onchange="accreditationModelChanged(this)" disabled="{!!CanChangeAccreditationType}"/>
						</apex:pageBlockSectionItem>						

						<apex:pageBlockSection columns="1">	
							<apex:pageBlockSectionItem labelStyle="width:26%">
								<apex:outputLabel value="{!$Label.ANG_ISSP_AccreditationType}"/>
								<apex:outputText value="{!IF(con.Account.ANG_Accreditation_Model__c == 'Cash', $Label.ANG_ISSP_ProductStandardAccreditationWithCash, $Label.ANG_ISSP_ProductStandardAccreditationWithNoCash)}" />
							</apex:pageBlockSectionItem>
						</apex:pageBlockSection>
						<apex:pageBlockSection columns="1">

							<apex:outputPanel id="allowedAccreditationModelSelectPanel" style="display : {!IF(newForm.Notify_Change_Accreditation_Type__c == true, '', 'none')}">
								<apex:pageBlockSectionItem labelStyle="width:26%;display: {!IF(newForm.Notify_Change_Accreditation_Type__c, '', 'none')}" dataStyle="display: {!IF(newForm.Notify_Change_Accreditation_Type__c, '', 'none')}">
									<apex:outputLabel style="font-size: 12px; padding-right: 20px;" value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ANG_Accreditation_Model_to_Change__c.Label}" styleClass="agencyAccreditationTypeComponent"/>
									<apex:inputField id="allowedAccreditationModelSelect" value="{!newForm.ANG_Accreditation_Model_to_Change__c}" styleClass="agencyAccreditationTypeComponent" onchange="accreditationModelChanged(this)"></apex:inputField>
								</apex:pageBlockSectionItem>
								<!-- Remove the current accreditation model from the picklist -->
								<!-- It does not make sense the user change the accretitation model to the current one -->
								<script type="text/javascript">
        							(function() {
        								var aux = "{!con.Account.ANG_Accreditation_Model__c}";        								
        								var l = document.querySelectorAll('[id$="allowedAccreditationModelSelect"]')[0];
        								for(i = 0; i < l.length; i++) {
        									if(aux == 'Cashless' && l[i].value === "Cashless") {
        										l.remove(i);
        									}
        									if(aux == 'Cash' && l[i].value === "Cash") {
	     										l.remove(i);
        									}
        								}
        							})();
					            </script>																	
							</apex:outputPanel>

							<!--apex:pageBlockSectionItem labelStyle="width:26%;display: {!IF(newForm.Notify_Change_Accreditation_Type__c, '', 'none')}" dataStyle="display: {!IF(newForm.Notify_Change_Accreditation_Type__c, '', 'none')}">
								<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ANG_Accreditation_Model_to_Change__c.Label}" styleClass="agencyAccreditationTypeComponent"/>
								<apex:inputField id="allowedAccreditationModelSelect" value="{!newForm.ANG_Accreditation_Model_to_Change__c}" styleClass="agencyAccreditationTypeComponent" onchange="accreditationModelChanged(this)"></apex:inputField>
							</apex:pageBlockSectionItem-->

							<script>
								cntIFAPContacts = {!cntIFAPContacts};
							</script>
							<!--apex:outputPanel id="addFinancialAssessmentContactItem" rendered="{!con.Account.ANG_Accreditation_Model__c == 'Cashless'}" style="display: {!IF(newForm.ANG_Accreditation_Model_to_Change__c == 'Cash', '', 'none')};"-->
							<apex:outputPanel id="addFinancialAssessmentContactItem" 
									style="display : {!IF(AND(newForm.Notify_Change_Accreditation_Type__c == true, 
															  newForm.ANG_Accreditation_Model_to_Change__c == 'Cash'),
												    '', 'none')}">
								<apex:outputPanel id="comandButtonAddAssContact">
									<script>
										cntIFAPContacts = {!cntIFAPContacts};
									</script>
									<apex:commandLink rendered="{!(cntIFAPContacts < MAX_IFAP_Contacts)}" style="margin-right:5px" onfocus="showNewIFAPContactDialog();"><span class="glyphicon glyphicon-plus"></span>{!$Label.ISSP_Add_FAP_Contact}</apex:commandLink>
									<apex:outputText rendered="{!(cntIFAPContacts >= MAX_IFAP_Contacts)}">
										<span id="tooltip-add-ass-contact" html-title="{!$Label.ISSP_AMS_Step3_ErrMsg_Max_FinContacts1 + ' ' + TEXT(MAX_IFAP_CONTACTS) + ' ' + $Label.ISSP_AMS_Step3_ErrMsg_Max_FinContacts2 }">
											<span style="margin-right:5px; opacity: 0.6; text-decoration: underline;"><span class="glyphicon glyphicon-plus"></span>{!$Label.ISSP_Add_FAP_Contact}</span>
										</span>
									</apex:outputText>
								</apex:outputPanel>
								<apex:outputPanel id="contactIFAPList">
									<apex:repeat value="{!List_IFAPAgencyContacts}" var="ifapCon">
										<apex:outputPanel layout="block" style="font-weight:bold; padding:5px 10px; font-size:110%;width:100%;background-color:rgb(195,225,240)">
											{!$ObjectType.AMS_Accreditation_Contact__c.fields.Financial_Assessment_Contact__c.Label}
											<span style="float: right;">
												<apex:actionStatus id="actEditContact">
													<apex:facet name="start">
														<span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> {!$Label.ISSP_AMS_Loading_Contact}
													</apex:facet>
												</apex:actionStatus>
												<apex:commandLink action="{!editAgencyContact}" status="actEditContact" styleClass="glyphicon glyphicon-pencil" oncomplete="showNewIFAPContactDialog();" rerender="contactIFAPList, newIFAPContact">
													<apex:param value="{!ifapCon.Id}" name="recordId" assignTo="{!editContactId}" />
												</apex:commandLink>
												<span id="agencyConIFAPContact" style="display: none;">{!ifapCon.Id}</span>
												<apex:commandLink onfocus="confirmIFAPContactDelete('{!ifapCon.Id}', '{!ifapCon.Name}', 'contact')" styleClass="glyphicon glyphicon-trash" />
											</span>
										</apex:outputPanel>
										<apex:panelGrid width="100%" columnClasses="col1, col2" cellpadding="10%" columns="2">
											<apex:outputLabel style="padding-left: 5px;" value="{!$ObjectType.Contact.fields.FirstName.Label}"/>
											<apex:outputText style="font-weight: normal;" value="{!ifapCon.First_name__c}"></apex:outputText>
										</apex:panelGrid>
										<apex:panelGrid width="100%" columnClasses="col1, col2" cellpadding="10%" columns="2">
											<apex:outputLabel style="padding-left: 5px;" value="{!$ObjectType.Contact.fields.LastName.Label}"/>
											<apex:outputText style="font-weight: normal;" value="{!ifapCon.Last_name__c}"></apex:outputText>
										</apex:panelGrid>
										<apex:panelGrid width="100%" columnClasses="col1, col2" cellpadding="10%" columns="2">
											<apex:outputLabel style="padding-left: 5px;" value="{!$ObjectType.Contact.fields.Phone.Label}"/>
											<apex:outputText style="font-weight: normal;" value="{!ifapCon.Phone__c}"></apex:outputText>
										</apex:panelGrid>
										<apex:panelGrid width="100%" columnClasses="col1, col2" cellpadding="10%" columns="2">
											<apex:outputLabel style="padding-left: 5px;" value="{!$ObjectType.Contact.fields.Email.Label}"/>
											<apex:outputText style="font-weight: normal;" value="{!ifapCon.Email__c}"></apex:outputText>
										</apex:panelGrid>
										<apex:panelGrid width="100%" columnClasses="col1, col2" cellpadding="10%" columns="2">
											<apex:outputLabel style="padding-left: 5px;" value="{!$ObjectType.AMS_Accreditation_Contact__c.fields.Financial_Assessment_Contact__c.Label}"/>
											<apex:outputText style="font-weight: normal;" ><img src="{!IF(ifapCon.Financial_Assessment_Contact__c, '/img/checkbox_checked.gif', '/img/checkbox_unchecked.gif')}"/></apex:outputText>
										</apex:panelGrid>
									</apex:repeat>
								</apex:outputPanel>
							</apex:outputPanel>
						</apex:pageBlockSection>								

					</apex:pageBlockSection>
				</apex:outputPanel>
				<span id="nav_two"></span>
				<div style="display:{!IF(newform.Is_change_legal_name__c==true,'','none')}">
					<apex:pageBlockSection columns="2" collapsible="false" id="legalNameSection">

						<apex:facet name="header">
							<apex:outputpanel >
								<apex:outputText rendered="{!!isAccreditationModelNotNullOrLegacy}">{!IF(newlabels, $Label.ISSP_AMS_NoC_Change_of_Legal_Name_New, $Label.ISSP_AMS_NoC_Change_of_Legal_Name)}</apex:outputText>
                                <apex:outputText rendered="{!isAccreditationModelNotNullOrLegacy}">
                                    {!SUBSTITUTE(IF(newlabels, $Label.ISSP_AMS_NoC_Change_of_Legal_Name_New, $Label.ISSP_AMS_NoC_Change_of_Legal_Name), '1', '2')}
                                </apex:outputText>
							</apex:outputpanel>
						</apex:facet>
						<apex:outputPanel layout="block" style="font-weight:bold; padding:5px 10px; font-size:110%;width:100%;background-color:rgb(195,225,240)">{!$Label.ISSP_AMS_NOC_Current_Legal_details}</apex:outputPanel>
						<apex:outputPanel layout="block" style="font-weight:bold; padding:5px 10px; font-size:110%;width:100%;background-color:rgb(195,225,240)">{!$Label.ISSP_AMS_NoC_Legal_Name_After_Change}</apex:outputPanel>
							
						<apex:pageBlockSectionItem labelStyle="width:40%" dataStyle="width:10%;{!IF(AND(isValError, newForm.Confirm_Legal_Details_are_correct__c==false,newForm.Notify_Change_Legal_Details__c==false), 'border:2px red solid !important;margin-right:5px', 'margin-right:5px')}">
							<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Confirm_Legal_Details_are_correct__c.Label}" style="color:black;font-size:110%"/>
							<apex:inputCheckbox html-data-group="agencyLegalDetails" value="{!newForm.Confirm_Legal_Details_are_correct__c}"/>
						</apex:pageBlockSectionItem>
							
						<apex:pageBlockSectionItem labelStyle="width:40%;" dataStyle="width:10%;{!IF(AND(isValError, newForm.Confirm_Legal_Details_are_correct__c==false,newForm.Notify_Change_Legal_Details__c==false), 'border:2px red solid !important;margin-right:5px', 'margin-right:5px')}">
							<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Notify_Change_Legal_Details__c.Label}" style="color:black;font-size:110%"/>
							<apex:inputCheckbox html-data-group="agencyLegalDetails" html-data-controls="agencyLegalDetailsComponent" value="{!newForm.Notify_Change_Legal_Details__c}"/>
						</apex:pageBlockSectionItem>
					
						<apex:pageBlockSection columns="1">		
							<apex:pageBlockSectionItem labelStyle="width:26%">
								<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Local_Legally_Registered_Name__c.Label}"/>
								<apex:outputField value="{!accountConcerned.Name}" />
							</apex:pageBlockSectionItem>
							
							<apex:pageBlockSectionItem labelStyle="width:26%">
								<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Trade_Name__c.Label}"/>
								<apex:outputField value="{!accountConcerned.TradeName__c}" />
							</apex:pageBlockSectionItem>
							<apex:pageBlockSectionItem labelStyle="width:26%">
								<apex:outputlabel value="{!IF(isocountry.Tax_Number_label__c == null, $ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_VAT_Number_Input__c.Label, isocountry.Tax_Number_label__c)}" />
								<apex:outputField value="{!accountConcerned.VAT_Number__c}" />
							</apex:pageBlockSectionItem>
						</apex:pageBlockSection>
		
						<apex:pageBlockSection columns="1">
							<apex:pageBlockSectionItem labelStyle="width:26%" labelStyleClass="agencyLegalDetailsComponent" dataStyleClass="agencyLegalDetailsComponent" >
								<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Local_Legally_Registered_Name__c.Label}"/>
								<apex:inputField value="{!newform.Account_Name__c}" />
							</apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem labelStyleClass="agencyLegalDetailsComponent" dataStyle="width:20%" rendered="{!isocountry.Local_language_Agency_details_required__c}">
                                <apex:outputLabel value="{!txtLocalAgencyDetailsLegalName}"/>
                                    <apex:outputPanel styleClass="agencyLegalDetailsComponent">
                                        <apex:inputField value="{!newForm.Local_Legally_Registered_Name__c}" />
                                        <apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtLocalAgencyDetailsNoCompany}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
                                    </apex:outputPanel>
                         	</apex:pageBlockSectionItem>

							<apex:pageBlockSectionItem labelStyle="width:26%" labelStyleClass="agencyLegalDetailsComponent" dataStyleClass="agencyLegalDetailsComponent">
								<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Trade_Name__c.Label}"/>
								<apex:inputField value="{!newform.Trade_Name__c}"/>	
							</apex:pageBlockSectionItem>

							<apex:actionfunction name="validateVAT" action="{!validateVATNumber}" status="actValidVAT" rerender="VATNumberInput">
                        <apex:param name="vatno" value="" assignto="{!vatNUmber}" />
                    </apex:actionfunction>
                    
                    <apex:pageblocksectionitem rendered="{!NOT(isocountry.Hide_Tax_Number_VAT__c)}" labelStyleClass="agencyLegalDetailsComponent" dataStyleClass="agencyLegalDetailsComponent" id="VatNumberInput">
                        <apex:outputlabel value="{!IF(isocountry.Tax_Number_label__c == null, $ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_VAT_Number_Input__c.Label, isocountry.Tax_Number_label__c)}" styleClass="agencyLegalDetailsComponent"/>
                        <apex:outputpanel id="VATNumberInput" styleClass="agencyLegalDetailsComponent">
                            <span style="margin-left:{!If(isEUcountry,'0px', '17px')};padding-right:2px;padding-top:3px;padding-bottom:3px; background-color:#EEEEEE;font-size:14px;"><apex:outputfield value="{!newCase.IFAP_Country_ISO__c}" rendered="{!isEUcountry}" /></span>
                            <apex:inputfield value="{!newForm.ISSP_AMS_VAT_Number_Input__c}" html-placeholder="{!isocountry.Tax_number_format__c}" onblur="if(this.value != '' && isEUcountry) {validateVAT(this.value.trim());}" style="margin-left:0px"/>
                            <apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!IF(isocountry.Tax_number_help_text__c == null, txtHelpTaxNumber, isocountry.Tax_number_help_text__c)}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
                            <apex:actionstatus id="actValidVAT" startstyleclass="bg-info">
                                <apex:facet name="start">
                                    {!$Label.ISSP_PAX_Validating_VAT_Number}
                                </apex:facet>
                            </apex:actionstatus>
                        </apex:outputpanel>
                    </apex:pageblocksectionitem>
						</apex:pageBlockSection>
					</apex:pageBlockSection>
				</div>
				
				<span id="nav_three"></span>

				<div style="display:{!IF(newform.Is_change_location__c==true,'','none')}">
					<apex:pageBlockSection columns="2" id="locationSection" collapsible="false">
						<apex:facet name="header">
							<apex:outputpanel >
								<apex:outputText rendered="{!!isAccreditationModelNotNullOrLegacy}">{!IF(newlabels, $Label.ISSP_AMS_NoC_Change_of_Location_New, $Label.ISSP_AMS_NoC_Change_of_Location)}</apex:outputText>
                                <apex:outputText rendered="{!isAccreditationModelNotNullOrLegacy}">
                                    {!SUBSTITUTE(IF(newlabels, $Label.ISSP_AMS_NoC_Change_of_Location_New, $Label.ISSP_AMS_NoC_Change_of_Location), '2', '3')}
                                </apex:outputText>
							</apex:outputpanel>
						</apex:facet>
						<apex:outputPanel layout="block" style="font-weight:bold; padding:5px 10px; font-size:110%;width:100%;background-color:rgb(195,225,240)">{!IF(newlabels, $Label.ISSP_AMS_NOC_Current_Location_New, $Label.ISSP_AMS_NOC_Current_Location)}</apex:outputPanel>
						<apex:outputPanel layout="block" style="font-weight:bold; padding:5px 10px; font-size:110%;width:100%;background-color:rgb(195,225,240)">{!IF(newlabels, $Label.ISSP_AMS_NoC_Location_After_Change_New, $Label.ISSP_AMS_NoC_Location_After_Change)}</apex:outputPanel>

						<apex:pageBlockSectionItem labelStyle="width:40%" dataStyle="width:10%;{!IF(AND(isValError, newForm.Confirm_Location_Details_are_correct__c==false,newForm.Notify_Change_Location__c==false), 'border:2px red solid !important;margin-right:5px', 'margin-right:5px')}">
								<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Confirm_Location_Details_are_correct__c.Label}" style="color:black;font-size:110%"/>
								<apex:inputCheckbox html-data-group="agencyLocation" value="{!newForm.Confirm_Location_Details_are_correct__c}"/>
							</apex:pageBlockSectionItem>
						
						<apex:pageBlockSectionItem labelStyle="width:40%;font-weight:" dataStyle="width:10%;{!IF(AND(isValError, newForm.Confirm_Location_Details_are_correct__c==false,newForm.Notify_Change_Location__c==false, newForm.Scope_of_Change__c != 'HO - All Branches' , agencyCodesConcernedSize < 1), 'border:2px red solid !important;margin-right:5px', 'margin-right:5px')}">
							<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Notify_Change_Location__c.Label}" style="color:black;font-size:110%"/>
							<apex:inputCheckbox id="notifyChangeLocationCheckbox" html-data-group="agencyLocation" html-data-controls="agencyLocationComponent" value="{!newForm.Notify_Change_Location__c}"/>
						</apex:pageBlockSectionItem>

						<apex:pageBlockSection columns="1">
							<apex:pageBlockSectionItem labelStyle="width:26%">
								<apex:outputtext value="{0}
                                                        <br />{1}<br />{2}<br /><br />{!$Label.ISSP_Office_Email}: {3}<br /> {!$Label.ISSP_Registration_Website}: {4}<br /><br />{!$Label.ISSP_Registration_BusinessPhone}: {5}<br />{!$Label.ISSP_Registration_MobilePhone}: {6}<br />Fax: {7}" escape="false" label="{!$Label.ISSP_AMS_Step3_Office_FullAddress}">
									<apex:param value="{!accountConcerned.BillingStreet}" />
									<apex:param value="{!accountConcerned.BillingCity},&nbsp;{!accountConcerned.BillingPostalCode}" />
									<apex:param value="{!IF(accountConcerned.BillingState!='',accountConcerned.BillingState + ',&nbsp;','')}{!accountConcerned.BillingCountry}" />
									<apex:param value="{!accountConcerned.Email__c}" />
									<apex:param value="{!accountConcerned.Website}" />
                                    <apex:param value="{!accountConcerned.Phone}" />
									<apex:param value="{!accountConcerned.Mobile__c}" />
									<apex:param value="{!accountConcerned.FAX}" />
								</apex:outputtext>
							</apex:pageBlockSectionItem>	
						</apex:pageBlockSection>

						<apex:pageBlockSection columns="1" id="addressSection">
							<apex:outputPanel styleClass="agencyLocationComponent" layout="block">
								<DSE:DS_DataQuality id="BranchAddress"
									RecordRef="{!newForm}"
									FieldGroupName="Branch Address"
									Edit="true"
									FormGroupStyle="form-group"
									RowStyle="row"
									LabelStyle="col-lg-5 adlabel adlabelpos"
									InputStyle="col-lg-5 col-md-1 col-sm-1 col-xs-1"
									StatusStyle="col-lg-2 col-md-1 col-sm-1 col-xs-1"
									FormControlStyle="apcontainer">
								</DSE:DS_DataQuality>
							</apex:outputPanel>
							<apex:outputPanel styleClass="agencyLocationComponent">
								<DSE:DS_DataQuality id="BranchEmail"
									RecordRef="{!newForm}"
									FieldGroupName="Branch Email"
									Edit="true"
									FormGroupStyle="form-group"
									RowStyle="row"
									LabelStyle="col-lg-5 adlabel adlabelpos"
									InputStyle="col-lg-5 col-md-1 col-sm-1 col-xs-1"
									StatusStyle="col-lg-2 col-md-1 col-sm-1 col-xs-1"
									FormControlStyle="apcontainer">
								</DSE:DS_DataQuality>
							</apex:outputPanel>
							
							<apex:pageBlockSectionItem labelStyleClass="agencyLocationComponent pageBlockSectionItem" dataStyleClass="agencyLocationComponent pageBlockSectionItem" id="locationItemWebsite">
                                <apex:outputLabel value="* {!$Label.ISSP_Registration_Website}"/>
                                <apex:inputField value="{!newForm.Website__c}" style="width:60%"/>
                             </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem labelStyle="width:37%" labelStyleClass="agencyLocationComponent pageBlockSectionItem" dataStyleClass="phone-input agencyLocationComponent pageBlockSectionItem" id="locationItemPhone">
                                <apex:outputLabel style="margin-right:4%" value="* {!$Label.ISSP_Registration_BusinessPhone}"/>
                                <apex:inputField value="{!newForm.Branch_Office_Phone_National__c}" onblur="setInternationalAccountPhoneInfo('phone');$j('.branch_office_phone__c').change();updatePhoneInfo();" id="locationphoneinput" style="width:80%"/>
                             </apex:pageBlockSectionItem>
                             <apex:pageBlockSectionItem labelStyle="width:37%" labelStyleClass="agencyLocationComponent pageBlockSectionItem" dataStyleClass="phone-input agencyLocationComponent pageBlockSectionItem" id="locationItemMobile">
                            	<apex:outputLabel style="margin-right:4%" value="{!$Label.ISSP_Registration_MobilePhone}"/>
                            	<apex:inputField value="{!newform.MobileNational__c}" onblur="setInternationalAccountPhoneInfo('mobile');" id="locationmobileinput" styleClass="col-lg-9"/>
                            </apex:pageBlockSectionItem>               
                            <apex:pageBlockSectionItem labelStyle="width:37%" labelStyleClass="agencyLocationComponent pageBlockSectionItem" dataStyleClass="phone-input agencyLocationComponent pageBlockSectionItem" id="locationItemFax">
                                <apex:outputLabel style="margin-right:4%" value="Fax"/>
                                <apex:inputField value="{!newform.Branch_Office_Fax_National__c}" onblur="setInternationalAccountPhoneInfo('fax');updateFaxInfo();" id="locationfaxinput" styleClass="col-lg-9"/>
                            </apex:pageBlockSectionItem>
                                 <apex:inputHidden value="{!newForm.Branch_Office_Phone__c}" id="locationphone"/>
                                 <apex:inputHidden value="{!newform.Mobile__c}" id="locationmobile"/>
                                 <apex:inputHidden value="{!newform.Branch_Office_FAX__c}" id="locationfax"/>
                            <apex:outputPanel styleClass="agencyLocationComponent">
                             <DSE:DS_DataQuality id="BranchPhone"
                                RecordRef="{!newForm}"
                                FieldGroupName="Branch Phone"
                                Edit="true"
                                FormGroupStyle="form-group"
                                RowStyle="row"
                                LabelStyle="labelCol col-lg-6 labelText"
                                InputStyle="col-lg-5"
                                StatusStyle="col-lg-1 col-md-1 col-sm-1 col-xs-1 {!IF(isocountry.Local_language_Agency_details_required__c==true,'statusBoxOther','statusBox')}"
                                FormControlStyle="apcontainer wid">
                            </DSE:DS_DataQuality>
						</apex:outputPanel>
                     </apex:pageBlockSection>
					</apex:pageBlockSection>
                    
                    <apex:outputPanel styleClass="agencyLocationComponent" layout="block">
                    <apex:pageBlockSection columns="2" collapsible="false" rendered="{!isocountry.Local_language_Agency_details_required__c}">
						<apex:facet name="header">
							<apex:outputpanel >
								{!txtLocalAgencyDetailsTitle}
							</apex:outputpanel>
						</apex:facet>
						<apex:outputText value="{!txtLocalAgencyDetailsChangePleaseEnter}"/>
                        
                        <input type="checkbox" id="copyCheckBox" onChange="copyPhysicalAddress()"/>
						<label for="copyCheckBox">{!txtLocalAgencyDetailsCopyAddress}</label>
                        <apex:pageBlockSection columns="1">
                        <apex:outputText value="{!txtLocalAgencyDetailsPhysicalAddress}" style="font-weight:bold; font-size:110%"/>
                        
						<apex:pageBlockSectionItem labelStyle="width:35%" >
							<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Local_Physical_Address_Street__c.Label}"/>
							<apex:inputField value="{!newForm.Local_Physical_Address_Street__c}" onChange="copyPhysicalAddress()" styleClass="PhysicalStreet"/>
						</apex:pageBlockSectionItem>
						<apex:inputField value="{!newForm.Local_Physical_Address_City__c}" onChange="copyPhysicalAddress()" styleClass="PhysicalCity"/>
						<apex:inputField value="{!newForm.Local_Physical_Address_Postal_Code__c}" onChange="copyPhysicalAddress()" styleClass="PhysicalPostalCode"/>
						<apex:inputField value="{!newForm.Local_Physical_Address_Province__c}" onChange="copyPhysicalAddress()" styleClass="PhysicalProvince"/>
						<apex:inputField value="{!newForm.Local_Physical_Address_Area__c}" onChange="copyPhysicalAddress()" styleClass="PhysicalArea"/>
                       
						<apex:outputText value="{!CASE(isocountry.ISO_Code__c, 'KR', isocountry.IATA_Contry_KR__c, 'JP', isocountry.IATA_Country_JP__c, 'BR', isocountry.IATA_Country_PT__c, isocountry.IATA_Country_ZH__c)}" label="Country"/>
						</apex:pageBlockSection>
                        <apex:pageBlockSection columns="1">
						<apex:outputText value="{!txtLocalAgencyDetailsCorrespondenceAddress}" style="font-weight:bold; font-size:110%"/>
                         
						<apex:pageBlockSectionItem labelStyle="width:30%">
							<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Local_Postal_Address_Street__c.Label}"/>
						<apex:inputField value="{!newForm.Local_Postal_Address_Street__c}" styleClass="PostalStreet"/>
						</apex:pageBlockSectionItem>
						<apex:inputField value="{!newForm.Local_Postal_Address_City__c}" styleClass="PostalCity"/>
						<apex:inputField value="{!newForm.Local_Postal_Address_Postal_Code__c}" styleClass="PostalPostalCode"/>
						<apex:inputField value="{!newForm.Local_Postal_Address_Province__c}" styleClass="PostalProvince"/>
						<apex:inputField value="{!newForm.Local_Postal_Address_Area__c}" styleClass="PostalArea"/>
                       
						<apex:outputText value="{!CASE(isocountry.ISO_Code__c, 'KR', isocountry.IATA_Contry_KR__c, 'JP', isocountry.IATA_Country_JP__c, 'BR', isocountry.IATA_Country_PT__c, isocountry.IATA_Country_ZH__c)}" label="Country"/>
					</apex:pageBlockSection>
                     </apex:pageBlockSection>
                     </apex:outputPanel>
				</div>

				<span id="nav_four"></span>

				<apex:actionFunction name="setHeaderLabelsAfterChange" action="{!setPageLegalStatusAfterChangeLabels}"	reRender="currContactList, newContact">
					<apex:param name="setlegalstatusafterchange" assignTo="{!legalstatusafterchange}" value="" />
				</apex:actionFunction>

				<apex:pageBlockSection columns="2" id="LegalStatusSection" collapsible="false" rendered="{!newform.Is_change_bank_account_details__c==false}">
					<apex:facet name="header">
						<apex:outputpanel >
							<apex:outputText rendered="{!!isAccreditationModelNotNullOrLegacy}">{!IF(newlabels, $Label.ISSP_AMS_NoC_Change_Ownership_Shareholding_New, $Label.ISSP_AMS_NoC_Change_Ownership_Shareholding)}</apex:outputText>
							<apex:outputText rendered="{!isAccreditationModelNotNullOrLegacy}">
								{!SUBSTITUTE(IF(newlabels, $Label.ISSP_AMS_NoC_Change_Ownership_Shareholding_New, $Label.ISSP_AMS_NoC_Change_Ownership_Shareholding), '3', '4')}
							</apex:outputText>
						</apex:outputpanel>
					</apex:facet>
                    
                    <apex:outputPanel layout="block" style="font-weight:bold; padding:5px 10px; font-size:110%;width:100%;background-color:rgb(195,225,240)">{!$Label.ISSP_AMS_NoC_Current_Legal_Status}</apex:outputPanel>
					<apex:outputPanel layout="block" style="font-weight:bold; padding:5px 10px; font-size:110%;width:100%;background-color:rgb(195,225,240)">{!$Label.ISSP_AMS_NoC_Legal_Status_After_Change}</apex:outputPanel>
                    
					<apex:outputPanel >
						<apex:pageBlockSection columns="1">
		                   	<apex:pageBlockSectionItem labelStyle="width:80%" dataStyle="width:10%;{!IF(AND(isValError, newForm.Confirm_Ownership_details_are_correct__c==false,newForm.Notify_Change_Ownership__c==false), 'border:2px red solid !important;margin-right:5px', 'margin-right:5px')}">
								<apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Confirm_Ownership_details}" style="color:black;font-size:110%"/> <!--{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Confirm_Ownership_details_are_correct__c.Label}"-->
								<apex:inputCheckbox html-data-group="agencyOwnership" value="{!newForm.Confirm_Ownership_details_are_correct__c}"/>
							</apex:pageBlockSectionItem>
						</apex:pageBlockSection>
					</apex:outputPanel>
                    
                    <apex:outputPanel >
						<apex:pageBlockSection columns="1">
		                    <apex:pageBlockSectionItem labelStyle="width:80%" dataStyle="width:10%;{!IF(AND(isValError, newForm.Confirm_Ownership_details_are_correct__c==false,newForm.Notify_Change_Ownership__c==false), 'border:2px red solid !important;margin-right:5px', 'margin-right:5px')}">
								<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Notify_Change_Ownership__c.Label}" style="color:black;font-size:110%"/>
								<apex:inputCheckbox html-data-group="agencyOwnership" html-data-controls="agencyOwnershipComponent" value="{!newForm.Notify_Change_Ownership__c}"/>
							</apex:pageBlockSectionItem>    
						</apex:pageBlockSection>
					</apex:outputPanel>
                    
					<apex:outputPanel >
						<apex:pageBlockSection columns="1">
		               		<apex:pageblockSectionItem labelStyle="width:80%" dataStyle="width:10%;">
								<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Map_Company_Type_to_Legal_Status__c.Label}"/>
								<apex:outputField value="{!newForm.Map_Company_Type_to_Legal_Status__c}" />
							</apex:pageblockSectionItem>
						</apex:pageBlockSection>
					</apex:outputPanel>
                    
                    <apex:outputPanel styleClass="agencyOwnershipComponent">
	                    <apex:pageBlockSection columns="1">
		                    <apex:pageblockSectionItem labelStyleClass="agencyOwnershipComponent" dataStyleClass="agencyOwnershipComponent" labelStyle="width:44%" dataStyle="width:0%;" rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}">
								<apex:outputLabel value="{!$Label.ISSP_AMS_NOC_Updated_Legal_Status}"/>
								<apex:inputField value="{!newForm.ISSP_AMS_Legal_Status__c}" id="UpdatedLegalStatus" onchange="toggleUpdatedLegalStatus('{!$Component.UpdatedLegalStatus}');" />
							</apex:pageblockSectionItem>
						</apex:pageBlockSection>
					</apex:outputPanel>
                    
                    <apex:outputPanel style="display:{!IF(newForm.ISSP_AMS_Legal_Status__c=='Corporation', '', 'none')}"></apex:outputPanel>
                    
                    <apex:outputPanel id="currcorporatedetails" layout="block" style="display:{!IF(newForm.ISSP_AMS_Legal_Status__c=='Corporation', '', 'none')}" styleClass="agencyOwnershipComponent">
					
						<!--<apex:pageBlockSection columns="1">
							<apex:pageBlockSectionItem labelStyle="width:79%">
								<apex:outputLabel value="{!$Label.ISSP_AMS_LABEL_Listed_Shares}"/>
								<apex:selectRadio style="width:100px" id="currshareholdersmsg" value="{!newForm.ISSP_AMS_Curr_Entity_with_listed_shares__c}" styleClass="{!IF(AND(isValError, newForm.ISSP_AMS_Curr_Entity_with_listed_shares__c==null), 'requiredIndicator', '')}" onchange="toggleShareholdersMsg('{!$Component.currshareholdersmsg}','curr');">
									<apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
									<apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
								</apex:selectRadio>
							</apex:pageBlockSectionItem>
						</apex:pageBlockSection>-->
	                    
						<apex:pageBlockSection columns="1">
							<apex:pageblocksectionitem >
								<apex:outputlabel value="{!$Label.ISSP_Currency}" />
								<apex:outputpanel >
									<apex:inputfield id="y3CurrencyCode" value="{!newForm.CurrencyIsoCode}" style="float:left" onchange="toggleCurrencyCode(this.value);"/>
									<apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtHelpCurrency}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
								</apex:outputpanel>
							</apex:pageblocksectionitem>
							<apex:pageblocksectionitem labelStyle="width:44%">
								<apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Issued_share_capital__c.Label}" />
								<apex:outputPanel >
									<apex:inputfield value="{!newForm.Issued_share_capital__c}"/> 
									<apex:outputText id="y2CurrencyCode" value=" {!newForm.CurrencyIsoCode}"/>	
								</apex:outputPanel>									
							</apex:pageblocksectionitem>
							<apex:pageblocksectionitem labelStyle="width:44%">
								<apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_Paidup_capital__c.Label}" />
								<apex:outputPanel >
									<apex:inputfield value="{!newForm.ISSP_AMS_Paidup_capital__c}"/> 
									<apex:outputText id="y2CurrencyCode" value=" {!newForm.CurrencyIsoCode}"/>	
								</apex:outputPanel>									
							</apex:pageblocksectionitem>
						</apex:pageBlockSection>
					</apex:outputPanel>

					<apex:outputPanel >
					</apex:outputPanel>

					<apex:outputPanel id="onlineAgencyPanel" styleClass="agencyOwnershipComponent">
						<apex:pageBlockSection columns="1">
							<apex:pageBlockSectionItem labelStyle="width:44%">
								<apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Online_Agency}"/>
								<apex:selectRadio style="width:100px;margin-left:20px;{!IF(AND(isValError, newForm.ISSP_AMS_Online_Agency_Application__c==null), 'border:2px red solid;', '')}" value="{!newForm.ISSP_AMS_Online_Agency_Application__c}" onchange="togglePageItem(this.value, '{!$Component.onlineAgencyURL}');">
									<apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
									<apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
								</apex:selectRadio>
							</apex:pageBlockSectionItem>
							
							<apex:outputPanel id="onlineAgencyURL" style="display:{!IF(newForm.ISSP_AMS_Online_Agency_Application__c=='Yes', '', 'none')}" >
							<apex:pageBlockSectionItem labelStyle="width:44%">							
								<apex:pageBlockSection columns="1">
									<apex:pageBlockSectionItem labelStyle="width:44%">
										<apex:outputLabel value="{!$Label.ISSP_Registration_Online_Agency_URL}"/>
										<apex:inputField value="{!newForm.ISSP_AMS_Online_Agency_URL__c}" />
									</apex:pageBlockSectionItem>
								</apex:pageBlockSection>
							</apex:pageBlockSectionItem>
							</apex:outputPanel>

						</apex:pageBlockSection>

						
						<!--<div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!$Label.ISSP_AMS_NoC_Registered_Cargo_Agent}</strong></div>
						<apex:pageBlockSection columns="1">
							<apex:pageBlockSectionItem labelStyle="width:44%">
								<apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Registered_Cargo_Agent_Code}"/>
								<apex:inputfield value="{!newForm.IATA_Cargo_Code__c}"/>
							</apex:pageBlockSectionItem>
						</apex:pageBlockSection>-->
					</apex:outputPanel>

                    <apex:outputPanel id="current-owner-summary" style="display:{!IF(hqAccount.Company_Type__c!='S', '', 'none')}">
                    	<div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!$Label.ISSP_AMS_NoC_Summary_Current_Ownership}</strong></div>
						<div class="col-md-12">
								<apex:outputText value="{!$Label.ISSP_AMS_Step3_4_Ownership}" escape="false"/>
							</div>
							<apex:pageBlockTable value="{!List_Prev_Ownership_Summary}" var="owner"	id="ownerList" styleClass="table-hover table table-condensed table-responsive">
								<apex:column headerValue="{!$Label.ISSP_Owner}" value="{!owner.Name}"/>										
								<apex:column footerClass="tbFooter" footerValue="TOTAL" headerValue="{!$Label.LAQ_Type}" value="{!$Label.ISSP_AMS_NoC_Curr_Company_Owner}" rendered="{!owner.RecordType.DeveloperName=='Previous_Company_Owner' && newForm.Is_change_ownership_or_shareholding__c}"/>
								<apex:column footerClass="tbFooter" footerValue="TOTAL" headerValue="{!$Label.LAQ_Type}" value="{!$Label.ISSP_AMS_NoC_Current_Owner}" rendered="{!owner.RecordType.DeveloperName!='Previous_Company_Owner' && newForm.Is_change_ownership_or_shareholding__c}"/>
								<apex:column footerValue="{!ROUND(Prev_Ownership_Total, 2)}%" value="{!owner.Financial_interest__c}"/>
						</apex:pageBlockTable>
                    </apex:outputPanel>
                    
                    <apex:outputPanel id="updated-owner-summary" style="display:{!IF(OR(newForm.ISSP_AMS_Legal_Status__c=='Sole Proprietorship', List_Curr_Ownership_Summary.size==0), 'none', '')}" styleClass="agencyOwnershipComponent" >
                       <div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!$Label.ISSP_AMS_NoC_Summary_Updated_Ownership}</strong></div>
							<div class="col-md-12">
								<apex:outputText value="{!$Label.ISSP_AMS_Step3_4_Ownership}" escape="false"/>
							</div>
							<apex:pageBlockTable value="{!List_Curr_Ownership_Summary}" var="owner"	id="currOwnerSummaryList" styleClass="table-hover table table-condensed table-responsive">
								<apex:column headerValue="{!$Label.ISSP_Owner}" value="{!owner.Name}"/>
								<apex:column footerClass="tbFooter" footerValue="TOTAL" headerValue="{!$Label.LAQ_Type}" value="{!$Label.ISSP_AMS_NoC_Prev_Company_Owner}" rendered="{!owner.RecordType.DeveloperName=='Current_Company_Owner'}"/>
								<apex:column footerClass="tbFooter" footerValue="TOTAL" headerValue="{!$Label.LAQ_Type}" value="{!$Label.ISSP_AMS_NoC_Previous_Owner}" rendered="{!owner.RecordType.DeveloperName!='Current_Company_Owner'}"/>
								<apex:column footerValue="{!ROUND(Curr_Ownership_Total, 2)}%" value="{!owner.Financial_interest__c}">
                                	<apex:facet name="header"><apex:outputText escape="false" value="{!$Label.ISSP_AMS_Financial_Interest}"/></apex:facet>
								</apex:column>
							</apex:pageBlockTable> 
                    </apex:outputPanel>
                    
					<apex:outputPanel id="currentPersonOwners">
						<div class="col-md-12 bg-info"><strong>{!$Label.ISSP_AMS_NoC_Current_Owners_Managers}</strong></div> 
						 <br/><br/><br/>
						<apex:pageBlockTable value="{!List_PreviousOwners}" var="agencycon"	id="contactList" styleClass="table-hover table table-condensed table-responsive">
							<apex:column ><span class="glyphicon glyphicon-plus" onclick="toggleContactDetails(this)" id="tog{!agencycon.Id}"/></apex:column>
							<apex:column headerValue="{!$ObjectType.Contact.fields.FirstName.Label}" value="{!agencycon.First_name__c}"/> 
							<apex:column headerValue="{!$ObjectType.Contact.fields.LastName.Label}" value="{!agencycon.Last_name__c}"/>
							<apex:column headerValue="{!CASE(ownerLabelType, 'shareholder', $Label.ISSP_AMS_Shareholder, 'partner', $Label.ISSP_AMS_Partner, $Label.ISSP_AMS_Owner)}" value="{!agencycon.Agency_owner__c}"	/>
							<apex:column value="{!agencycon.Agency_role__c}" >
								<apex:facet name="header"><apex:outputText escape="false" value="{!CASE(roleLabelType, 'director', $Label.ISSP_AMS_Director, $Label.ISSP_AMS_Manager)}"/></apex:facet>
							</apex:column>
							<apex:column headerValue="{!$ObjectType.AMS_Accreditation_Contact__c.fields.Financial_interest__c.Label}" value="{!agencycon.Financial_interest__c}"/>
                            
							<apex:column >
								<apex:actionStatus id="actEditContact" >
									<apex:facet name="start" > 
										<span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
											{!$Label.ISSP_AMS_Loading_Contact}	
									</apex:facet>
								</apex:actionStatus>
							</apex:column>
							<apex:column breakBefore="true" colspan="12" style="display:none; background-color:RGB(236, 246, 249)" styleClass="tog{!agencycon.Id}" id="contactDetails">
								<div class="col-md-12">
									<apex:outputText rendered="{!isocountry.ISO_Code__c=='CN'}">
										<div class="contact-detail col-md-6"><span style="font-weight:bold">{!$Label.ISSP_AMS_First_Name_Chinese}&nbsp;</span></div><div class="contact-detail col-md-6">{!agencycon.Local_First_name__c}</div>
										<div class="contact-detail col-md-6"><span style="font-weight:bold">{!$Label.ISSP_AMS_Last_Name_Chinese}&nbsp;</span></div><div class="contact-detail col-md-6">{!agencycon.Local_Last_Name__c}</div>
									</apex:outputText>
									<div class="contact-detail col-md-6"><span style="font-weight:bold">Email&nbsp;</span></div><div class="contact-detail col-md-6">{!agencycon.Email__c}&nbsp;</div>
                                    <div class="contact-detail col-md-6"><span style="font-weight:bold">{!$ObjectType.Contact.fields.Phone.Label}&nbsp;</span></div><div class="contact-detail col-md-6">{!agencycon.Phone__c}&nbsp;</div>
								</div>
							</apex:column>
						</apex:pageBlockTable>
                    </apex:outputPanel>
                        
                    <apex:outputPanel id="updated-person-owners" styleClass="agencyOwnershipComponent">
					
						<div class="col-md-12 bg-info"><strong>{!$Label.ISSP_AMS_NoC_Updated_Owners_Managers}</strong></div>
						<div id="currmsgshareholdersdetails" class="bg-warning" style="margin-top:3px; margin-bottom:5px;{!IF(newForm.ISSP_AMS_Curr_Entity_with_listed_shares__c == 'No', 'border: 0px !important;', 'display:none')}">
							{!$Label.ISSP_AMS_Not_Listed_Msg}
                        </div>
                        <br/><br/>
						<apex:commandLink style="margin-left:20px" onfocus="updateOwnerRT('Current Owner');showNewContactDialog();"><span class="glyphicon glyphicon-plus"></span>{!$Label.ISSP_AMS_Add_Person}</apex:commandLink>
						
						<apex:pageBlockTable value="{!List_CurrentOwners}" var="agencycon"	id="currContactList" styleClass="table-hover table table-condensed table-responsive">
							<apex:column ><span class="glyphicon glyphicon-plus" onclick="toggleContactDetails(this)" id="tog{!agencycon.Id}"/></apex:column>
							<apex:column headerValue="{!$ObjectType.Contact.fields.FirstName.Label}" value="{!agencycon.First_name__c}"/> 
							<apex:column headerValue="{!$ObjectType.Contact.fields.LastName.Label}" value="{!agencycon.Last_name__c}"/>
							<apex:column headerValue="{!CASE(ownerLabelTypeAfterChange, 'shareholder', $Label.ISSP_AMS_Shareholder, 'partner', $Label.ISSP_AMS_Partner, $Label.ISSP_AMS_Owner)}" value="{!agencycon.Agency_owner__c}" id="ownerTitle" />
							<apex:column id="roleTitle" value="{!agencycon.Agency_role__c}" >
								<apex:facet name="header"><apex:outputText escape="false" value="{!CASE(roleLabelTypeAfterChange, 'director', $Label.ISSP_AMS_Director, $Label.ISSP_AMS_Manager)}"/></apex:facet>
							</apex:column>
                            <apex:column value="{!agencycon.Financial_interest__c}">
                            	<apex:facet name="header"><apex:outputText escape="false" value="{!$Label.ISSP_AMS_Financial_Interest}"/></apex:facet>
							</apex:column>
								
							<apex:column >
								<apex:actionStatus id="actEditCurrOwner" >
									<apex:facet name="start" > 
										<span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
											{!$Label.ISSP_AMS_Loading_Contact}	
									</apex:facet>
								</apex:actionStatus>
								<apex:commandLink action="{!editAgencyContact}" status="actEditCurrOwner" styleClass="glyphicon glyphicon-pencil" oncomplete="updateOwnerRT('Current Owner');showNewContactDialog();" rerender="currContactList, newContact">
									<apex:param value="{!agencycon.Id}" name="recordId" assignTo="{!editContactId}" />
								</apex:commandLink>
							</apex:column>
							<apex:column >
								<apex:commandLink onfocus="confirmContactDelete('{!agencycon.Id}', '{!agencycon.Name}', 'contact')" styleClass="glyphicon glyphicon-trash"/>
							</apex:column>
							<apex:column breakBefore="true" colspan="12" style="display:none; background-color:RGB(236, 246, 249)" styleClass="tog{!agencycon.Id}">
								<div class="col-md-12">
									<apex:outputText rendered="{!isocountry.ISO_Code__c=='CN'}">
										<div class="contact-detail col-md-6"><span style="font-weight:bold">{!$Label.ISSP_AMS_First_Name_Chinese}&nbsp;</span></div><div class="contact-detail col-md-6">{!agencycon.Local_First_name__c}</div>
										<div class="contact-detail col-md-6"><span style="font-weight:bold">{!$Label.ISSP_AMS_Last_Name_Chinese}&nbsp;</span></div><div class="contact-detail col-md-6">{!agencycon.Local_Last_Name__c}</div>
									</apex:outputText>
									<!--<apex:outputText rendered="{!newForm.ISSP_AMS_Legal_Status__c=='Corporation'}">
									<div class="contact-detail"><span style="font-weight:bold">{!$ObjectType.AMS_Accreditation_Contact__c.fields.Number_Of_Shares__c.Label}&nbsp;</span>{!TEXT(agencycon.Number_Of_Shares__c)}</div>
									</apex:outputText>-->
									<div class="contact-detail col-md-6"><span style="font-weight:bold">{!$ObjectType.Contact.fields.Email.Label}&nbsp;</span></div><div class="contact-detail col-md-6">{!agencycon.Email__c}&nbsp;</div>
                                    <div class="contact-detail col-md-6"><span style="font-weight:bold">{!$ObjectType.Contact.fields.Phone.Label}&nbsp;</span></div><div class="contact-detail col-md-6">{!agencycon.Phone__c}&nbsp;</div>
                                    <div class="contact-detail col-md-6"><span style="font-weight:bold">{!$ObjectType.AMS_Accreditation_Contact__c.fields.Time_devoted_to_Agency_business__c.Label}&nbsp;</span></div><div class="contact-detail col-md-6">{!agencycon.Time_devoted_to_Agency_business__c}%&nbsp;</div>
								</div>
							</apex:column>
						</apex:pageBlockTable>
                    </apex:outputPanel>
                    
                    <apex:outputPanel layout="block" id="previous-owner-companies" style="display:{!IF(hqAccount.Company_Type__c!='S', '', 'none')}">
						<div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!$Label.ISSP_AMS_NoC_Current_Companies}</strong></div>
                        <div style="height:70px">&nbsp;</div>
                        <apex:outputText value="{!IF(newlabels, $Label.ISSP_AMS_NoC_No_Company_Owners_New, $Label.ISSP_AMS_NoC_No_Company_Owners)}" rendered="{!List_PreviousCompanies.size==0}"/>
						<apex:pageBlockTable value="{!List_PreviousCompanies}" var="agencycon" id="companyList" styleClass="table-hover table table-condensed table-responsive" rendered="{!List_PreviousCompanies.size>0}">
								<apex:column headerValue="{!$ObjectType.Account.fields.Legal_name__c.Label}" value="{!agencycon.Name}"/>
								<apex:column value="{!agencycon.Registration_number__c}"/>
								<apex:column value="{!agencycon.IATACode__c}"/>
								<apex:column value="{!agencycon.Financial_interest__c}"/>
						</apex:pageBlockTable>
					</apex:outputPanel>
					
                    <apex:outputPanel layout="block" id="updated-company-owners" style="display:{!IF(NOT(AND(newForm.ISSP_AMS_Legal_Status__c=='Sole Proprietorship', List_CurrentCompanies.size==0)), '', 'none')}" styleClass="agencyOwnershipComponent" >
				
						<div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!$Label.ISSP_AMS_NOC_Updated_Companies}</strong></div>
						
						<div class="col-md-12" style="padding-bottom:12px">
							<apex:outputText value="{!IF(newlabels,$Label.ISSP_AMS_Step3_4_Companies_New,$Label.ISSP_AMS_Step3_4_Companies)}" escape="false"/>
						</div>
                        
						<apex:commandLink id="addcompany" style="margin-left:20px;display:{!IF(newForm.ISSP_AMS_Legal_Status__c=='Sole Proprietorship','none','')}" onfocus="updateCompanyOwnerRT('Current Company Owner');showNewCompanyDialog();" ><span class="glyphicon glyphicon-plus"></span>{!$Label.ISSP_AMS_ADD_COMPANY}</apex:commandLink>

						<apex:pageBlockTable value="{!List_CurrentCompanies}" var="agencycon" id="currCompanyList" styleClass="table-hover table table-condensed table-responsive">
							<apex:column headerValue="{!$ObjectType.Account.fields.Legal_name__c.Label}" value="{!agencycon.Name}"/>
							<apex:column value="{!agencycon.Registration_number__c}"/>
							<apex:column value="{!agencycon.IATACode__c}"/>
							<apex:column value="{!agencycon.Financial_interest__c}"/>
							<apex:column >
								<apex:commandLink action="{!editAgencyContact}" styleClass="glyphicon glyphicon-pencil" oncomplete="updateCompanyOwnerRT('Current Company Owner');showNewCompanyDialog();" rerender="currCompanyList, newCompany, newOwnerQuestions">
									<apex:param value="{!agencycon.Id}" name="recordId" assignTo="{!editContactId}" />
								</apex:commandLink>
							</apex:column>
							<apex:column >
								<apex:commandLink onfocus="confirmContactDelete('{!agencycon.Id}', '{!agencycon.Name}', 'company')" styleClass="glyphicon glyphicon-trash" />
							</apex:column>
						</apex:pageBlockTable>

						<apex:outputPanel >
							<div class="col-md-12 bg-info"><strong>{!$Label.ISSP_AMS_NoC_Other_Owner}</strong></div>

							<apex:pageBlockSection columns="1">								
								<apex:pageBlockSectionItem labelStyle="width:44%">
									<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_Legal_Reg_Name_Address__c.label}"/>
									<apex:inputField value="{!newForm.ISSP_AMS_Legal_Reg_Name_Address__c}" />
								</apex:pageBlockSectionItem>
								
								<apex:pageBlockSectionItem labelStyle="width:44%">
									<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_Principal_business_Org__c.label}"/>
									<apex:inputField value="{!newForm.ISSP_AMS_Principal_business_Org__c}" />
								</apex:pageBlockSectionItem>

							</apex:pageBlockSection>
						</apex:outputPanel>

						<apex:outputPanel id="newOwnerQuestions" rendered="{!List_CurrentCompanies.size > 0}">
							<!-- Section 6 - Sales estimates for non-IATA owners -->
							<div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!$Label.ISSP_AMS_NoC_Non_IATA_Owner_Title}</strong></div>
							<div class="col-md-12">
								<apex:outputText value="{!$Label.ISSP_AMS_NoC_Non_IATA_Owner_Estimates}" escape="false"/>
							</div>

							<apex:pageBlockSection columns="1">								
								<apex:pageBlockSectionItem labelStyle="width:44%">
									<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_Gross_Amnt_First_year__c.label}"/>
									<apex:outputPanel >
										<apex:inputField value="{!newForm.ISSP_AMS_Gross_Amnt_First_year__c}" />
										<apex:outputText id="y2CurrencyCode" value=" {!newForm.CurrencyIsoCode}"/>	
									</apex:outputPanel>
								</apex:pageBlockSectionItem>
								
								<apex:pageBlockSectionItem labelStyle="width:44%">
									<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_Gross_Amnt_Second_year__c.label}"/>
									<apex:outputPanel >
										<apex:inputField value="{!newForm.ISSP_AMS_Gross_Amnt_Second_year__c}" />
										<apex:outputText id="y2CurrencyCode" value=" {!newForm.CurrencyIsoCode}"/>	
									</apex:outputPanel>
								</apex:pageBlockSectionItem>

							</apex:pageBlockSection>
							
							<!-- Section 7 - Statement of International Sales -->
							<apex:pageBlockSection id="sectionSeven" collapsible="false" columns="1" rendered="{!countryCheckList.Statement_of_International_Sales__c}">
								<div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!$Label.ISSP_AMS_NoC_Statement_International_Sales}</strong></div>
			                    
			                    <apex:pageBlockSectionItem labelStyle="width:44%">
			                       <apex:outputLabel value="{!$Label.ISSP_AMS_Sales_Last_Year}"/>
			                       <apex:selectRadio style="width:100px" value="{!newForm.International_Sales_in_last_Year__c}" id="InternationalSalesSelect" onchange="toggleInternationalSales('{!$Component.InternationalSalesSelect}');" styleClass="{!IF(AND(isValError, newForm.International_Sales_in_last_Year__c==null), 'requiredIndicator', '')}">
			                            <apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
			                            <apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
			                    </apex:selectRadio>
			                    </apex:pageBlockSectionItem>
		                    </apex:pageBlockSection>

			                <div id="InternationalSales" style="{!IF(OR(newForm.International_Sales_in_last_Year__c == '', newForm.International_Sales_in_last_Year__c == 'No'), 'display:none', 'border: 0px !important;')}">
			                    <apex:pageBlockSection columns="2">
			                            <apex:pageBlockSectionItem labelStyle="padding-right:3px;">
			                                <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.Fields.Sales_Period_From__c.Label}"/>
			                                <apex:inputField value="{!newForm.Sales_Period_From__c}" style="margin-left:5px"/>
			                            </apex:pageBlockSectionItem>
			                            <apex:pageBlockSectionItem >
			                                <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.Fields.Sales_Period_To__c.Label}"/>
			                                <apex:inputField value="{!newForm.Sales_Period_To__c}" style="margin-left:5px"/>
			                            </apex:pageBlockSectionItem>
			                    </apex:pageBlockSection>
			                    
			                    <div class="col-md-12" style="margin-top:10px;margin-bottom:10px;">
			                        <apex:outputText value="{!$Label.ISSP_AMS_Sales_Instructions}" escape="false"/>
			                    </div>
			                    
			                    <div class="col-md-12"><apex:commandLink id="addSales" style="margin-right:5px;margin-top:10px" onfocus="showNewSalesDialog();"><span class="glyphicon glyphicon-plus"></span>{!$Label.ISSP_AMS_ADD_International_Sales}</apex:commandLink></div>
			                     <apex:pageBlockTable value="{!List_InternationalSales}" var="salescon"  id="salesList" styleClass="table-hover table table-condensed table-responsive">
			                            <apex:column headerValue="{!$ObjectType.ISSP_AMS_Statement_International_Sales__c.fields.IATA_Member_Airline__c.Label}" value="{!salescon.IATA_Member_Airline__r.Name}"/>
			                         <apex:column value="{!salescon.Sales_Amount__c}">
			                             <apex:facet name="footer">
			                                <apex:outputText value="{!newForm.CurrencyIsoCode} {!ROUND(newForm.Total_International_Sales__c,2)} (USD {0, number, ###,##0.00})">
			                                    <apex:param value="{!InternationalSales_Total}"/>
			                                </apex:outputText>
			                         </apex:facet>
			                         </apex:column>
			                             <apex:column >
			                                <apex:commandLink action="{!editInternationalSales}" styleClass="glyphicon glyphicon-pencil" oncomplete="showNewSalesDialog();" rerender="salesList,newSales">
			                                    <apex:param value="{!salescon.Id}" name="recordId" assignTo="{!editSalesId}" />
			                                </apex:commandLink>
			                            </apex:column>
			                            <apex:column >
			                                <apex:commandLink onfocus="confirmInternationalSaleDelete('{!salescon.Id}', '{!salescon.IATA_Member_Airline__r.Name}', 'company')" styleClass="glyphicon glyphicon-trash" rerender="salesList"/>
			                            </apex:column>
			                     </apex:pageBlockTable>
			                        <apex:actionFunction name="deleteInternationalSale" action="{!deleteInternationalSales}" rerender="salesList">
			                            <apex:param value="" name="recordId" assignTo="{!editSalesId}" />
			                        </apex:actionFunction>
			                </div>
							
						</apex:outputPanel>
				</apex:outputPanel>
						
					
				<span id="nav_five"></span>	
                </apex:pageBlockSection>
                
						<apex:pageBlockSection collapsible="false" columns="1" id="section4_1" rendered="{!newform.Is_change_bank_account_details__c==false}">
							<apex:facet name="header">
								<apex:outputpanel >
									<apex:outputText rendered="{!!isAccreditationModelNotNullOrLegacy}">{!$Label.ISSP_AMS_NoC_Additional_Information}</apex:outputText>
									<apex:outputText rendered="{!isAccreditationModelNotNullOrLegacy}">
										{!SUBSTITUTE($Label.ISSP_AMS_NoC_Additional_Information, '4', '5')}
									</apex:outputText>
								</apex:outputpanel>
							</apex:facet>


							<apex:pageBlockSectionItem rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}">
								<apex:outputLabel value="{!IF(isAccreditationModelNotNullOrLegacy, $Label.ISSP_NoC_Head_Entity_Becoming_a_AE, $ObjectType.AMS_Pax_Accreditation_Form__c.fields.Is_this_Head_Office_becoming_a_Branch__c.Label)}"/>
								<apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Is_this_Head_Office_becoming_a_Branch__c==null), 'border:2px red solid;', '')}" value="{!newForm.Is_this_Head_Office_becoming_a_Branch__c}" onchange="togglePageItem(this.value, '{!$Component.AMSForm.AMSBlock.section4_1.r1c1}');" disabled="{!newForm.Scope_of_Change__c == 'Selected Branches Only'}">
									<apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
									<apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}"/>
								</apex:selectRadio>
							</apex:pageBlockSectionItem>
                            
                            <!--<apex:outputPanel id="r1c1" layout="block" style="display:{!IF(newForm.Is_this_Head_Office_becoming_a_Branch__c=='Yes', '', 'none')}">
                            <apex:pageBlockSection columns="2">-->
                            	<apex:pageBlockSectionItem >
									<apex:outputLabel value="{!$Label.ISSP_AMS_NoC_New_HO_Code}"/>
									<apex:inputField value="{!newForm.New_Head_Office_IATA_Code__c}" onblur="fetchTravelAgent4(this.value.trim())"/>
    
							</apex:pageBlockSectionItem>
                            <apex:outputPanel id="NewHOCodeValidation">
                                    <apex:actionStatus id="loadingNewHODetailsModal" startStyleClass="bg-info">
								<apex:facet name="start" >
									{!$Label.ISSP_Loading_Travel_Agency_Details}		
								</apex:facet>
							</apex:actionStatus>
							<apex:outputText value="{!$Label.ISSP_AMS_Invalid_IATA_Code}" styleClass="bg-danger" escape="false" rendered="{!AND(companyModalNameOfEmployer=='', iatacode!='')}"/>	
								<apex:outputPanel rendered="{!AND(companyModalNameOfEmployer!='', iatacode!='')}">
									<span style="font-weight: bold; color: #4a4a56;">{!$Label.ISSP_Agency_name} </span>{!companyModalNameOfEmployer} <br/>
									<span style="font-weight: bold; color: #4a4a56;">{!$Label.ISSP_AMS_Address} </span> {!companyModalAddress}
								</apex:outputPanel>
                            </apex:outputPanel>

							<apex:pageBlockSectionItem rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}">
								<apex:outputLabel value="{!IF(isAccreditationModelNotNullOrLegacy, $Label.ISSP_NoC_AE_Becoming_a_Head_Entity, $ObjectType.AMS_Pax_Accreditation_Form__c.fields.Is_this_Branch_becoming_a_Head_Office__c.Label)}"/>
								<apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Is_this_Branch_becoming_a_Head_Office__c==null), 'border:2px red solid;', '')}" value="{!newForm.Is_this_Branch_becoming_a_Head_Office__c}">
									<apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
									<apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
								</apex:selectRadio>
							</apex:pageBlockSectionItem>

							<!--<apex:pageBlockSectionItem >
								<apex:outputLabel value="{!IF(newlabels, $Label.ISSP_AMS_NoC_Q1_New, $Label.ISSP_AMS_NoC_Q1)}"/>
								<apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Will_such_change_affect_the_premises__c==null), 'border:2px red solid;', '')}" value="{!newForm.Will_such_change_affect_the_premises__c}">
									<apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
									<apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
								</apex:selectRadio>
							</apex:pageBlockSectionItem>

							<apex:outputPanel id="r2c2" layout="block">
							<apex:pageBlockSection columns="1">
								<apex:pageblocksectionitem labelStyle="width:50%">
									<apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Please_provide_details_for_the_change__c.Label}" />
									<apex:inputfield value="{!newForm.Please_provide_details_for_the_change__c}" style="width:200px;height:90px"/>
							</apex:pageblocksectionitem>
							</apex:pageBlockSection>-->
							<apex:pageBlockSectionItem >
								<apex:outputLabel value="{!IF(isAccreditationModelNotNullOrLegacy, $Label.ISSP_AMS_NoC_Will_Change_Affect_All_Locations_New, $Label.ISSP_AMS_NoC_Will_Change_Affect_All_Locations)}"/>
								<apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Will_such_change_affect_locations__c==null), 'border:2px red solid;', '')}" value="{!newForm.Will_such_change_affect_locations__c}">
									<apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
									<apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
								</apex:selectRadio>
							</apex:pageBlockSectionItem>

							<apex:outputPanel id="r2c2" layout="block">
							<apex:pageBlockSection columns="1">
								<apex:pageblocksectionitem labelStyle="width:50%">
									<apex:outputlabel value="{!$Label.ISSP_AMS_NoC_If_Not_Provide_Explanation}" />
									<apex:inputfield value="{!newForm.Provide_explanation_for_change_locations__c}" style="width:200px;height:90px"/>
							</apex:pageblocksectionitem>
							</apex:pageBlockSection>
							
							
						</apex:outputPanel>
						
						<apex:pageBlockSectionItem >
							<apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Q3}"/>
							<apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Will_such_change_affect_the_managers__c==null), 'border:2px red solid;', '')}" value="{!newForm.Will_such_change_affect_the_managers__c}">
								<apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
								<apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
							</apex:selectRadio>
						</apex:pageBlockSectionItem>

						<apex:outputPanel id="r4c2" layout="block">
							<apex:pageBlockSection columns="1">
								<apex:pageblocksectionitem labelStyle="width:50%">
									<apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Provide_details_for_change_affect_staff__c.Label}" />
									<apex:inputfield value="{!newForm.Provide_details_for_change_affect_staff__c}" style="width:200px;height:90px"/>
								</apex:pageblocksectionitem>
							</apex:pageBlockSection>								
						</apex:outputPanel>

						<apex:pageBlockSectionItem rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}">
							<apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Q4}"/>
							<apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Have_any_having_authorization_to_act__c==null), 'border:2px red solid;', '')}" value="{!newForm.Have_any_having_authorization_to_act__c}">
								<apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
								<apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
							</apex:selectRadio>
						</apex:pageBlockSectionItem>

						<apex:outputPanel id="r5c2" layout="block">
							<apex:pageBlockSection columns="1">
								<apex:pageblocksectionitem labelStyle="width:50%">
									<apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Give_details_for_authorization_to_act__c.Label}" />
									<apex:inputfield value="{!newForm.Give_details_for_authorization_to_act__c}" style="width:200px;height:90px"/>
								</apex:pageblocksectionitem>
							</apex:pageBlockSection>								
						</apex:outputPanel>

						<apex:pageBlockSectionItem rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}">
							<apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Q5}"/>
							<apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Will_the_change_of_ownership_cause__c==null), 'border:2px red solid;', '')}" value="{!newForm.Will_the_change_of_ownership_cause__c}">
								<apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
								<apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
							</apex:selectRadio>
						</apex:pageBlockSectionItem>

						<apex:outputPanel id="r6c2" layout="block">
							<apex:pageBlockSection columns="1">
								<apex:pageblocksectionitem labelStyle="width:50%">
									<apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Give_details_for_the_change_of_ownership__c.Label}"/>
									<apex:inputfield value="{!newForm.Give_details_for_the_change_of_ownership__c}" style="width:200px;height:90px"/>
								</apex:pageblocksectionitem>
							</apex:pageBlockSection>								
						</apex:outputPanel>
						<!--NEWGEN-668-->
						<apex:pageblocksection columns="1" rendered="{!isAccreditationModelNotNullOrLegacy}">
							<apex:pageblocksectionitem labelStyle="width:50%">
								<apex:outputlabel id="section5-gds" value="{!$Label.ISSP_NoC_Advise_GDS}" />
								<apex:inputfield value="{!newForm.ISSP_AMS_GDS_with_signed_contract__c}"/>
							</apex:pageblocksectionitem>
						</apex:pageblocksection>   
						<!--END NEWGEN-668-->
						<apex:pageBlockSectionItem >
							<apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Provide_Registeration_Or_License}"/>
						</apex:pageBlockSectionItem>

						<apex:outputPanel layout="block">
							<apex:pageBlockSectionItem >
								<apex:pageBlockSection columns="1">
									<apex:pageBlockSectionItem labelStyle="width:50%">
										<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_Trade_Reg_No__c.Label}"/>
										<apex:inputfield value="{!newForm.ISSP_AMS_Trade_Reg_No__c}"/>
									</apex:pageBlockSectionItem>
									<apex:pageBlockSectionItem labelStyle="width:50%">
										<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_Date_Registration_granted__c.Label}"/>
										<apex:inputfield value="{!newForm.ISSP_AMS_Date_Registration_granted__c}"/>
									</apex:pageBlockSectionItem>
									<apex:pageBlockSectionItem labelStyle="width:50%">
										<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_License_No__c.Label}"/>
										<apex:inputfield value="{!newForm.ISSP_AMS_License_No__c}"/>
									</apex:pageBlockSectionItem>
									<apex:pageBlockSectionItem labelStyle="width:50%">
										<apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_Date_license_granted__c.Label}"/>
										<apex:inputfield value="{!newForm.ISSP_AMS_Date_license_granted__c}"/>
									</apex:pageBlockSectionItem>
								</apex:pageBlockSection>
							</apex:pageBlockSectionItem>
						</apex:outputPanel>

						<apex:pageblocksectionitem labelStyle="width:50.3%">
							<apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Effective_Date_Of_Change__c.Label}" />
							<apex:inputfield value="{!newForm.Effective_Date_Of_Change__c}" onclick="showFuturePastDates();"/>
						</apex:pageblocksectionitem>
					</apex:pageBlockSection>
							
				
				
			</div>	<!-- EO APContainer -->
		</apex:pageBlock>
		
		</apex:form> <!-- EO AMS Form -->


		<!-- Modal New Agency Contact - Person -->
<apex:form id="newContact">
<div class="modal fade" id="addNewContactModal" role="dialog" tabindex="-1" aria-labelledby="myModalLabel">
	<div class="modal-dialog modal-lg" role="document">
	<div class="modal-content">
		<div class="modal-header">
		<button type="button" class="close" onclick="cancelAgentUpdate(); return false;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		<h4 class="modal-title" id="myModalLabel">{!$Label.ISSP_AMS_Add_Person}</h4>
		</div>
		
		<apex:pageMessages id="theMessages" />
		
		<div class="modal-body">
			<apex:pageBlock id="contactBlock">
			<apex:pageBlockSection id="contactSection" columns="4">	
				<apex:pageBlockSectionItem id="contactItemOwner" labelStyle="font-size:110%" dataStyle="width:15%">
					<apex:outputLabel id="ownerContactTitle">{!CASE(ownerLabelTypeAfterChange, 'shareholder', $Label.ISSP_AMS_Shareholder, 'partner', $Label.ISSP_AMS_Partner, $Label.ISSP_AMS_Owner)}</apex:outputLabel>
					<apex:inputField value="{!newContact.Agency_owner__c}" id="owner" onclick="toggleModalContactFields('{!$Component.newContact.contactBlock.contactSection.contactItemOwner.owner}')"/>
				</apex:pageBlockSectionItem>				
				<apex:pageBlockSectionItem id="contactItemDom" labelStyle="white-space: nowrap;font-size:110%" dataStyle="width:15%">
					<apex:outputLabel id="roleContactTitle" escape="false" value="{!CASE(roleLabelTypeAfterChange, 'director', $Label.ISSP_AMS_Director, $Label.ISSP_AMS_Manager)}"/>
					<apex:inputField value="{!newContact.Agency_role__c}" id="dom" />
				</apex:pageBlockSectionItem>	
				
			</apex:pageBlockSection>
				<table>
					<tr><td class="bg-info" colspan="3">{!$Label.ISSP_AMS_Step3_PersonModal_CheckBoxes}</td></tr>
					<tr>
						<td style="width:25%">
						<table>
							<tr><td class="modalrow">
								<apex:outputText value="{!$ObjectType.Contact.fields.Salutation.Label}" /><br/>
								<apex:inputField value="{!newContact.Salutation__c}" />
								</td></tr>
							<tr><td class="modalrow">
								<apex:outputText value="{!IF(isocountry.Local_language_Agency_details_required__c, txtLocalAgencyDetailsFirstNameENG, $ObjectType.Contact.fields.FirstName.Label)}" /><br/>
								<apex:inputField value="{!newContact.First_name__c}" required="true"/>
								</td></tr>
							<apex:outputText rendered="{!isocountry.Local_language_Agency_details_required__c}">
							<tr><td class="modalrow">
								<apex:outputPanel >
									<apex:outputText value="{!txtLocalAgencyDetailsFirstNameLocal}" />&nbsp;
									<apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtLocalAgencyDetailsNoLocalFirstName}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
									</apex:outputPanel>	
									<apex:inputField value="{!newContact.Local_First_name__c}" required="true"/>
								</td></tr>
							</apex:outputText>
							<tr><td class="modalrow">
								<apex:outputText value="{!IF(isocountry.Local_language_Agency_details_required__c, txtLocalAgencyDetailsLastNameENG, $ObjectType.Contact.fields.LastName.Label)}" /><br/>
								<apex:inputField value="{!newContact.Last_name__c}" />
								</td></tr>
							<apex:outputText rendered="{!isocountry.Local_language_Agency_details_required__c}">
							<tr><td class="modalrow">
								<apex:outputPanel >
									<apex:outputText value="{!txtLocalAgencyDetailsLastNameLocal}" />&nbsp;
									<apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtLocalAgencyDetailsNoLocalLastName}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
								</apex:outputPanel>
								<apex:inputField value="{!newContact.Local_Last_Name__c}" required="true"/>
								</td></tr>
							</apex:outputText>
											
							<tr id="corporatefield1"><td class="modalrow">
								<apex:outputText value="{!$ObjectType.AMS_Accreditation_Contact__c.fields.Financial_interest__c.Label}"/><br/>
								<div class="requiredInput">
                                	<div class="requiredBlock"></div>
									<apex:inputField value="{!newContact.Financial_interest__c}" id="contactFinInterest"/>
								</div>
								</td></tr> 
                            <tr id="corporatefield1"><td class="modalrow">   
                                <apex:outputText value="{!$ObjectType.AMS_Accreditation_Contact__c.fields.Time_devoted_to_Agency_business__c.Label}"/><br/>
                                <div class="requiredInput">
	                                <div class="requiredBlock"></div>
	                                <apex:inputField value="{!newContact.Time_devoted_to_Agency_business__c}" id="contactTimeToBusiness" />
                                </div>
                                </td></tr>
							<!--<tr id="corporatefield2" style="display:none"><td class="modalrow">
								<apex:outputText value="{!$ObjectType.AMS_Accreditation_Contact__c.fields.Number_Of_Shares__c.Label}"/><br/>
								<apex:inputField value="{!newContact.Number_Of_Shares__c}" id="contactNumOfShares"/>
								</td></tr>-->
							<tr id="personEmail" style="display:none"><td class="modalrow">
								<apex:outputText value="{!$ObjectType.Contact.fields.Email.Label}" /><br/>
								<apex:inputField value="{!newContact.Email__c}" required="true" rendered="{!newContact.Contact__c == null}"/>
                                <apex:outputField value="{!newContact.Email__c}" rendered="{!newContact.Contact__c != null}"/>
								</td></tr>
                            <tr id="personPhone" style="display:none"><td class="modalrow">
                                <apex:inputHidden value="{!newContact.Phone__c}" id="contactphone" />
                                <apex:outputText value="{!$ObjectType.Contact.fields.Phone.Label}" /><br/>
                                <apex:inputField id="contactphoneinput" html-placeholder="" value="{!newContact.PhoneNational__c}" onblur="setInternationalPhoneNo('phone');" required="true"/>
                                </td></tr>
                            <tr id="personFax"><td class="modalrow">
                                <apex:outputText value="{!$ObjectType.Contact.fields.Fax.Label}" /><br/>
                                <apex:inputField id="contactfaxinput" html-placeholder="" value="{!newContact.FAX__c}"  required="false"/>
                                </td></tr>

						</table>
						</td>

						<td style="width:25%">
	                        <table>
	                            <tr><td class="modalrow">&nbsp;</td></tr>
	                            <tr><td class="modalrow">
	                            	{!CASE(ownerLabelTypeAfterChange, 'shareholder', $Label.ISSP_AMS_Shareholder, 'partner', $Label.ISSP_AMS_Partner, $Label.ISSP_AMS_Owner)} /&nbsp;<apex:outputText value="{!CASE(roleLabelTypeAfterChange, 'director', $Label.ISSP_AMS_Director, $Label.ISSP_AMS_Manager)}" escape="false"/>&nbsp;{!$Label.ISSP_AMS_Address}<br/>
	                                <apex:inputField value="{!newContact.AddressStreet__c}" id="contactStreet" required="true" html-placeholder="{!$Label.ISSP_AMS_Street}"/>
	                                </td></tr>
	                            <tr><td class="modalrow">
	                                <apex:inputField value="{!newContact.AddressCity__c}" id="contactCity"  required="true" html-placeholder="{!$Label.ISSP_AMS_City}"/>
	                                </td></tr>
	                            <tr><td class="modalrow">
	                                <apex:inputField value="{!newContact.AddressPostcode__c}" id="contactPostalCode" html-placeholder="{!$Label.ISSP_AMS_PostCode}"/>
	                                </td></tr>
	                            <tr><td class="modalrow" style="vertical-align:top;padding-bottom:30px">
	                            	<div class="requiredInput">
	                                	<div class="requiredBlock"></div>
		                                <apex:selectList styleClass="contactcountry" id="contactcountry" style="width:85%" value="{!amsContactCountry}" size="1">
		                                    <apex:selectOptions value="{!countryNameList}"/>
		                                </apex:selectList>
	                                </div>
	                                </td></tr>
	                          </table>
	                      </td>
					</tr>
				</table>		
			</apex:pageBlock>
		</div>
		
		<div class="modal-footer">
		<!-- <apex:commandButton action="{!createAgencyContact}" value="{!$Label.PKB2_Submit}" oncomplete="closeModal(); setPortalAdmin('{!$Component.AMSForm.PortalAdminId}');" reRender="contactList, ownerList"> -->
		<apex:commandButton action="{!createAgencyContact}" status="WaitingStatus" id="submitBut" styleClass="btn btn-default" value="{!$Label.ISSP_Submit}" 
			oncomplete="if ({!contactSaved==true}){closeModalByCommandButton(); cancelAgentUpdate();} this.removeAttribute('disabled');"
			onclick="this.disabled='disabled';" reRender="currContactList,currOwnerSummaryList,theMessages">
			<apex:param value="Current Owner" name="ownertype" assignTo="{!contactType}" />
		</apex:commandButton>&nbsp;
		<button type="button" class="btn btn-default" onclick="cancelAgentUpdate(); return false;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{!$Label.ISSP_Cancel}</span></button>
		</div>
		<script src="{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/build/js/intlTelInput.js')}"></script>	
		<script>

		function closeModalByCommandButton()
		{			
			closeModal();
				
		}

		toggleModalContactFields('{!$Component.newContact.contactBlock.contactSection.contactItemOwner.owner}');
		
        var natphone = $j("input[name='{!$Component.newContact.contactBlock.contactphoneinput}']");
        var phone = $j("input[name='{!$Component.newContact.contactBlock.contactphone}']");

        natphone.intlTelInput({
            nationalMode: true,
            defaultCountry: defaultHQCountry,
            numberType: "FIXED_LINE",
            utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
        });
        
         natphone.intlTelInput("setNumber", phone.val());
        
        function setInternationalPhoneNo(p) {
            if(p=='phone') {
                phone.val(natphone.intlTelInput("getNumber"));
            } else if(p=='mobile') {
                mobile.val(natmobile.intlTelInput("getNumber"));
            } else {
                fax.val(natfax.intlTelInput("getNumber"));
            }
        }
        
	</script>		
	</div>
	</div>
</div>
	
</apex:form>			
		
		
<!-- Modal New Agency Contact - Company -->
<apex:form id="newCompany">
<div class="modal fade" id="addNewCompanyModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
	<div class="modal-content">
		<div class="modal-header">
		<button type="button" class="close" onclick="cancelCompanyUpdate(); return false;"	data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		<h4 class="modal-title" id="myModalLabel">{!$Label.ISSP_AMS_Add_Company}</h4>
		</div>

		<apex:pageMessages id="companyMessages" />

		<div class="modal-body">
			<apex:pageBlock >
			
		
		<apex:pageBlockSection id="companySection" columns="1">
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!IF(isocountry.Local_language_Agency_details_required__c, txtLocalAgencyDetailsCompanyNameENG, $ObjectType.Account.fields.Legal_name__c.Label)}"/>
					<apex:inputField value="{!newContact.Name}" required="true"/>
				</apex:pageBlockSectionItem>
				<apex:pageBlockSectionItem rendered="{!isocountry.Local_language_Agency_details_required__c}">
				<apex:outputLabel value="{!txtLocalAgencyDetailsCompanyNameLocal}" />
				<apex:outputPanel >
					<apex:inputField value="{!newContact.Company_Name_Local__c}" required="true"/>
					<apex:image value="/img/msg_icons/info16.png" style="margin-left: 43%;margin-top: -7%;" title="{!txtLocalAgencyDetailsNoLocalCompanyName}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
				</apex:outputPanel>
			</apex:pageBlockSectionItem>
				<apex:inputField value="{!newContact.Registration_number__c}" required="true" />
				<apex:inputField value="{!newContact.IATACode__c}" onblur="fetchTravelAgent3(this.value.trim())"/>

				<apex:actionStatus id="loadingDetailsCompanyModal" startStyleClass="bg-info">
					<apex:facet name="start" >
						{!$Label.ISSP_Loading_Travel_Agency_Details}		
					</apex:facet>
				</apex:actionStatus>

				<apex:outputPanel id="companyModalIataCodeValidation">
					<apex:outputText value="{!$Label.ISSP_AMS_Invalid_IATA_Code}" styleClass="bg-danger" escape="false" rendered="{!AND(companyModalNameOfEmployer=='', iatacode!='')}"/>	
					<apex:outputPanel rendered="{!AND(companyModalNameOfEmployer!='', iatacode!='')}">
						<span style="font-weight: bold; color: #4a4a56;">{!$Label.ISSP_Agency_name} </span>{!companyModalNameOfEmployer} <br/>
						<span style="font-weight: bold; color: #4a4a56;">{!$Label.ISSP_AMS_Address} </span> {!companyModalAddress}
					</apex:outputPanel>
				</apex:outputPanel>						

				<apex:inputField value="{!newContact.Financial_interest__c}" required="true"/>
			</apex:pageBlockSection>
			</apex:pageBlock>
		</div>
		
		<div class="modal-footer">
			<apex:commandButton action="{!NULL}" status="WaitingStatus" id="companySubmitBut" styleClass="btn btn-default" value="{!$Label.ISSP_Submit}" 
			oncomplete="createAgencyCompany(companyOwnerRecType);"
			onclick="this.disabled='disabled';" >
			</apex:commandButton>&nbsp;
		<button type="button" class="btn btn-default" onclick="cancelCompanyUpdate(); return false;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{!$Label.ISSP_Cancel}</span></button>
		</div>
	</div>
	</div>
</div>
</apex:form>

<!-- Modal Statement of International Sales -->
<apex:form id="newSales">
<div class="modal fade" id="addNewSalesModal" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" onclick="cancelSalesUpdate(); return false;"  data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">{!$Label.ISSP_AMS_Add_International_Sales}</h4>
      </div>
      <div class="modal-body">
          <apex:pageBlock id="salesBlock">
           <apex:pageMessages id="salesMessages" />
        <apex:inputHidden id="newSalesCurrency" value="{!newInternationalSales.CurrencyIsoCode}" />
         <apex:pageBlockSection id="salesSection" columns="1">
            <apex:pageBlockSectionItem >
                <apex:outputLabel value="{!$ObjectType.ISSP_AMS_Statement_International_Sales__c.fields.IATA_Member_Airline__c.Label}"/>
                <apex:selectList styleClass="member-airlines-select" id="memberairline" value="{!memberairlineid}" label="{!$ObjectType.ISSP_AMS_Statement_International_Sales__c.fields.IATA_Member_Airline__c.Label}" required="true" size="1">
                    <apex:selectOptions value="{!IATAMemberAirlines}"/>
                </apex:selectList>
            </apex:pageBlockSectionItem>
             <apex:pageBlockSectionItem id="salesSectionItem">
                <apex:outputLabel value="{!$ObjectType.ISSP_AMS_Statement_International_Sales__c.fields.Sales_Amount__c.Label} ({!newForm.CurrencyIsoCode})"/>
                <apex:outputPanel id="salesSectionPanel">
                    <apex:inputField value="{!newInternationalSales.Sales_Amount__c}" required="true"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>
          </apex:pageBlockSection>
          </apex:pageBlock>
      </div>
      
      <div class="modal-footer">
          <apex:commandButton action="{!createInternationalSales}" styleClass="btn btn-default" value="{!$Label.ISSP_Submit}"
            oncomplete="if ({!salesSaved}){closeSalesDialog();cancelSalesUpdate();}this.removeAttribute('disabled');" onclick="this.disabled='disabled'" reRender="salesList, salesMessages">
         </apex:commandButton>&nbsp;
        <button type="button" class="btn btn-default" onclick="cancelSalesUpdate(); return false;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{!$Label.ISSP_Cancel}</span></button>
      </div>
    </div>
  </div>
</div>
    
    <script>
        var natphonebranch= $j("input[name='{!$Component.AMSForm.AMSBlock.branchphonefax.subbranchsection.branchphonefields.natphonebranch}']");
        var phonebranch = $j('.branch_office_phone__c');
        
        natphonebranch.intlTelInput({
            nationalMode: true,
            defaultCountry: defaultHQCountry,
            numberType: "FIXED_LINE",
            utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
        });

        var natfaxbranch = $j("input[name='{!$Component.AMSForm.AMSBlock.branchphonefax.subbranchsection.branchfaxfields.natfaxbranch}']");
        var faxbranch = $j("input[name='{!$Component.AMSForm.AMSBlock.branchphonefax.subbranchsection.branchfaxfields.faxbranch}']");

         natfaxbranch.intlTelInput({
            nationalMode: true,
            defaultCountry: defaultHQCountry,
            numberType: "FIXED_LINE",
            utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
        });

        natphonebranch.intlTelInput("setNumber", phonebranch.val());

        natfaxbranch.intlTelInput("setNumber", faxbranch.val());
    
    function setInternationalBranchPhoneNo(p) {
            if(p=='phone') {
                phonebranch.val(natphonebranch.intlTelInput("getNumber"));
            } else {
                faxbranch.val(natfaxbranch.intlTelInput("getNumber"));
            }
        }

    </script>
   
</apex:form> 

<!-- Modal New HO Agency Contact - Person -->
<apex:form id="newIFAPContact">
	<div class="modal fade" id="addNewIFAPContactModal" role="dialog" tabindex="-1" aria-labelledby="myModalLabel">
		<div class="modal-dialog modal-md" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" onclick="cancelAgentUpdate(); return false;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="myModalLabel">{!$Label.ISSP_Add_FAP_Contact}</h4>
				</div>

				<apex:pageMessages id="theMessages" />

				<div class="modal-body">
					<apex:pageBlock id="contactBlock">
						<apex:pageBlockSection id="contactSection" columns="1">
							<apex:pageBlockSectionItem >
								<apex:outputLabel style="width: 185px;">{!$ObjectType.AMS_Accreditation_Contact__c.fields.Financial_Assessment_Contact__c.Label}</apex:outputLabel>
								<apex:inputField id="financialAssContactField" value="{!newContact.Financial_Assessment_Contact__c}" />
							</apex:pageBlockSectionItem>
						</apex:pageBlockSection>
						<table>
							<tr>
								<td style="width:25%">
									<table>
										<tr>
											<td class="modalrow">
												<apex:outputLabel value="{!$ObjectType.Contact.fields.Salutation.Label}" /><br/>
												<apex:inputField value="{!newContact.Salutation__c}" />
											</td>
										</tr>
										<tr>
											<td class="modalrow">
												<apex:outputLabel value="{!IF(isocountry.Local_language_Agency_details_required__c, txtLocalAgencyDetailsFirstNameENG, $ObjectType.Contact.fields.FirstName.Label)}" /><br/>
												<apex:inputField value="{!newContact.First_name__c}" required="true" />
											</td>
										</tr>
										<apex:outputText rendered="{!isocountry.Local_language_Agency_details_required__c}">
											<tr>
												<td class="modalrow">
													<apex:outputPanel >
														<apex:outputLabel value="{!txtLocalAgencyDetailsFirstNameLocal}" />&nbsp;
														<apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtLocalAgencyDetailsNoLocalFirstName}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
													</apex:outputPanel>
													<apex:inputField value="{!newContact.Local_First_name__c}" required="true" />
												</td>
											</tr>
										</apex:outputText>
										<tr>
											<td class="modalrow">
												<apex:outputLabel value="{!IF(isocountry.Local_language_Agency_details_required__c, txtLocalAgencyDetailsLastNameENG, $ObjectType.Contact.fields.LastName.Label)}" /><br/>
												<apex:inputField value="{!newContact.Last_name__c}" />
											</td>
										</tr>
										<apex:outputText rendered="{!isocountry.Local_language_Agency_details_required__c}">
											<tr>
												<td class="modalrow">
													<apex:outputPanel >
														<apex:outputLabel value="{!txtLocalAgencyDetailsLastNameLocal}" />&nbsp;
														<apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtLocalAgencyDetailsNoLocalLastName}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
													</apex:outputPanel>
													<apex:inputField value="{!newContact.Local_Last_Name__c}" required="true" />
												</td>
											</tr>
										</apex:outputText>
										<tr>
											<td class="modalrow">
												<apex:inputHidden value="{!newContact.Phone__c}" id="contactphone" />
												<apex:outputText value="{!$ObjectType.Contact.fields.Phone.Label}" /><br/>
												<apex:inputField id="contactphoneinput" html-placeholder="" value="{!newContact.PhoneNational__c}" onblur="setInternationalPhoneNo('phone');" required="true" style="width:85%" />
											</td>
										</tr>
										<tr>
											<td class="modalrow">
												<apex:inputHidden value="{!newContact.Mobile__c}" id="contactmobile" />
												<apex:outputText value="{!$ObjectType.Contact.fields.MobilePhone.Label}" /><br/>
												<apex:inputField id="contactmobileinput" html-placeholder="" value="{!newContact.MobileNational__c}" onblur="setInternationalPhoneNo('mobile');" style="width:85%" />
											</td>
										</tr>
										<tr>
											<td class="modalrow">
												<apex:inputHidden value="{!newContact.FAX__c}" id="contactfax" />
												<apex:outputText value="{!$ObjectType.Contact.fields.FAX.Label}" /><br/>
												<apex:inputField id="contactfaxinput" html-placeholder="" value="{!newContact.FAXNational__c}" onblur="setInternationalPhoneNo('fax');" style="width:85%" />
											</td>
										</tr>
										<tr>
											<td class="modalrow">
												<apex:outputText value="{!$ObjectType.Contact.fields.Email.Label}" /><br/>
												<apex:inputField value="{!newContact.Email__c}" required="true" rendered="{!newContact.Contact__c == null}" />
												<apex:outputField value="{!newContact.Email__c}" rendered="{!newContact.Contact__c != null}" />
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</apex:pageBlock>
				</div>

				<div class="modal-footer">
					<apex:commandButton action="{!createAgencyContact}" status="WaitingStatus" styleClass="btn btn-default" value="{!$Label.ISSP_Submit}" oncomplete="if ({!contactSaved==true}){closeIFAPModalByCommandButton(); cancelAgentUpdate();} this.removeAttribute('disabled');" onclick="this.disabled='disabled';" reRender="contactIFAPList, theMessages, comandButtonAddAssContact">
						<apex:param value="Person" name="persontype" assignTo="{!contactType}" />
					</apex:commandButton>&nbsp;
					<button type="button" class="btn btn-default" onclick="closeIFAPModalByCommandButton(); cancelAgentUpdate(); return false;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{!$Label.ISSP_Cancel}</span></button>
				</div>

				<script>

					function closeIFAPModalByCommandButton() {
						$j( '#addNewIFAPContactModal' ).modal('hide');
            			clearForm('{!$Component.newIFAPContact}');
					}

					var natphone = $j("input[name='{!$Component.newIFAPContact.contactBlock.contactphoneinput}']");
					var phone = $j("input[name='{!$Component.newIFAPContact.contactBlock.contactphone}']");

					natphone.intlTelInput({
						nationalMode: true,
						defaultCountry: defaultHQCountry,
						numberType: "FIXED_LINE",
						utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
					});

					natphone.intlTelInput("setNumber", phone.val());

					var natmobile = $j("input[name='{!$Component.newIFAPContact.contactBlock.contactmobileinput}']");
					var mobile = $j("input[name='{!$Component.newIFAPContact.contactBlock.contactmobile}']");

					natmobile.intlTelInput({
						nationalMode: true,
						defaultCountry: defaultHQCountry,
						numberType: "MOBILE",
						utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
					});
					natmobile.intlTelInput("setNumber", mobile.val());

					var natfax = $j("input[name='{!$Component.newIFAPContact.contactBlock.contactfaxinput}']");
					var fax = $j("input[name='{!$Component.newIFAPContact.contactBlock.contactfax}']");

					natfax.intlTelInput({
						nationalMode: true,
						defaultCountry: defaultHQCountry,
						numberType: "FIXED_LINE",
						utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
					});

					natfax.intlTelInput("setNumber", fax.val());

					function setInternationalPhoneNo(p) {
						if (p == 'phone') {
							phone.val(natphone.intlTelInput("getNumber"));
						} else if (p == 'mobile') {
							mobile.val(natmobile.intlTelInput("getNumber"));
						} else {
							fax.val(natfax.intlTelInput("getNumber"));
						}
					}
				</script>
			</div>
		</div>

	</div>

	<div class="modal fade" id="ModalProductComparison" role="dialog">
	  <div class="modal-dialog modal-lg" style="width: 1100px;">
		<div class="modal-content">
		  <div class="modal-header">
		    <button type="button" class="close" data-dismiss="modal">&times;</button>
		    <h4 class="modal-title">{!$Label.ISSP_AMS_Compare_Accreditation_Types}</h4>
		  </div>
		  <div class="modal-body">
		    <c:ANG_ProductComparison helperParam="{! helper}"/>
		  </div>
		  <div class="modal-footer">
		    <button type="button" class="btn btn-default" data-dismiss="modal">{! $Label.LAQ_Close}</button>
		  </div>
		</div>
	  </div>
	</div>

</apex:form>

	</div>	
	</div>
	</div>
		</div>
    <c:ISSP_CustomFooter communityName="{!communityName}"/>
		<script>
			//NEWGEN-1885
			$j ( document ).ready(function() {
				$j('[id$=UpdatedLegalStatus]').val() !== 'Corporation' && $j('[id$=currcorporatedetails]').hide();
			});
			//END - NEWGEN-1885
			
			//NoC Changes
			var accreditationModel = '{!con.Account.ANG_Accreditation_Model__c}',
				  lScopeOfChange = '{!newForm.Scope_of_Change__c}',
				  checkb = $j('[id$=notifyChangeLocationCheckbox]'),
				  iataChangeAccType = $j('[id$=iataChangeAccType]'),
				  allowedAccreditationModelSelect = $j('[id$=allowedAccreditationModelSelect]'),
				  addFinancialAssessmentContactItem = $j('[id$=addFinancialAssessmentContactItem]'),
				  allowedAccreditationModelSelectPanel = $j('[id$=allowedAccreditationModelSelectPanel]'),
				  allowedAccreditationModelSelectDisplay = allowedAccreditationModelSelect.parent().parent().children(),
				  confirmAccType = $j('[id$=confirmAccType]');

//alert(allowedAccreditationModelSelectDisplay.value);				  

			function getWarningBox(message) {
				var alertDiv = document.createElement('div');
				alertDiv.className = 'alert alert-warning text-justify';
				alertDiv.role = 'alert';
				alertDiv.appendChild(document.createTextNode(message));
				return alertDiv;
			} 

			function setWarningBoxOnHover(where, warningMessage) {
				var whereToAppend = where.parent().parent().next().children().last();
				// where.parent() because disabled elements does not have mouse events
				where.parent().hover(function() {
					whereToAppend.append(getWarningBox(warningMessage));
				}, function() {
					whereToAppend.html('');
				});
			}

			//NEWGEN-523
			function hideAccreditationTypeSelectSection() {
				allowedAccreditationModelSelect.val('');
				addFinancialAssessmentContactItem.css('display', 'none');
				allowedAccreditationModelSelectDisplay.css('display', 'none');
			}

			function accreditationModelChanged(element) {
				if (element === 'isCorrect') {
					if (cntIFAPContacts > 0) {
						bootbox.confirm('{!$Label.ISSP_NoC_Switch_Selection_Warning}', function(result) {
							if(result) {
								deleteIFAPContact($j('[id$=agencyConIFAPContact]')[0].innerText);
								hideAccreditationTypeSelectSection();
								iataChangeAccType[0].checked = false;
							} else {
								confirmAccType[0].checked = false;
								iataChangeAccType[0].checked = true;
								allowedAccreditationModelSelectPanel.css('display', '');
							}
						});
					} else {
						iataChangeAccType[0].checked = false;
						hideAccreditationTypeSelectSection();
					}
				} else {
					if(element.checked === false) {
						allowedAccreditationModelSelect.val('');
						allowedAccreditationModelSelectPanel.css('display', 'none');
					} else if (element.checked === true) {
						confirmAccType[0].checked = false; 
						allowedAccreditationModelSelectPanel.css('display', '');
					}

					if (element.checked === false) {
						addFinancialAssessmentContactItem.css('display', 'none');
					} else {
						if (element.value === 'Cash') {
							addFinancialAssessmentContactItem.css('display', '');
						}
					}
				}
			}
			//END NEWGEN-523

			//NEWGEN-1227
			if (lScopeOfChange === 'HO - All Branches' || lScopeOfChange === 'HO - Selected Branches' || {!agencyCodesConcernedSize} > 1) {
				checkb.prop('checked', false);
				checkb.prop('disabled', true);
				setWarningBoxOnHover(checkb, '{!$Label.ISSP_NoC_Location_Warning}');
			}
			//END - NEWGEN 1227
					
			if ({!isAccreditationModelNotNullOrLegacy}) {
				$("option[value='" + accreditationModel + "']").remove();
				var contactAccountNumberOfAEs = {!ContactAccountAEsChilds},
					scopeOfChange = '{!newForm.Scope_of_Change__c}';
				if ({!!CanChangeAccreditationType}) {
					setWarningBoxOnHover(iataChangeAccType, "{!$Label.ISSP_NoC_HE_with_AEs_Warning}");
					if (cntIFAPContacts > 0) {
						deleteIFAPContact($j('[id$=agencyConIFAPContact]')[0].innerText);
					}
				}
			}
			//END - NoC Changes
			
						
		var natmobileacct1 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.addressSection.locationItemMobile.locationmobileinput}']");                
							var mobileacct1 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.addressSection.locationmobile}']");
							
							natmobileacct1.intlTelInput({
								nationalMode: true,
								defaultCountry: defaultHQCountry,
								numberType: "MOBILE",
								utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
							});
							
							
							var natfaxacct1 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.addressSection.locationItemFax.locationfaxinput}']");
							var faxacct1 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.addressSection.locationfax}']");
						
							natfaxacct1.intlTelInput({
								nationalMode: true,
								defaultCountry: defaultHQCountry,
								numberType: "FIXED_LINE",
								utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
							});

							var natphoneacct1 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.addressSection.locationItemPhone.locationphoneinput}']");
							var phoneacct1 = $j('.branch_office_phone__c');
							var phoneacct2 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.addressSection.locationphone}']");
					 
							natphoneacct1.intlTelInput({
								nationalMode: true,
								defaultCountry: defaultHQCountry,
								numberType: "FIXED_LINE",
								utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
							});

							natmobileacct1.intlTelInput("setNumber", mobileacct1.val());
							
							natfaxacct1.intlTelInput("setNumber", faxacct1.val());

							natphoneacct1.intlTelInput("setNumber", phoneacct1.val());

							function setInternationalAccountPhoneInfo(p) {
								if(p=='phone') {
									phoneacct1.val(natphoneacct1.intlTelInput("getNumber"));
									phoneacct2.val(natphoneacct1.intlTelInput("getNumber"));
								} else if(p=='mobile') {
									mobileacct1.val(natmobileacct1.intlTelInput("getNumber"));
								} else {
									faxacct1.val(natfaxacct1.intlTelInput("getNumber"));
								}
										}
	</script>
	</body>	
</html>
</apex:page>