<apex:page controller="ISSP_AMS_Accreditation" showHeader="false" sidebar="false" standardStylesheets="true" applyBodyTag="false" applyHtmlTag="false" action="{!securityCheck}">
    <html> 
        <c:ISSP_Header ></c:ISSP_Header>
        <c:iss_ap_css />
        <c:ISSP_WaitingStatus />    
        <body>
        <script src="{!URLFOR($Resource.bootbox)}" />
        <script src="{!URLFOR($Resource.datePickerFix)}" />
        <link rel="stylesheet" href="{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/build/css/intlTelInput.css')}"/>
        <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css" rel="stylesheet" />
        <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
        <script src="{!URLFOR($Resource.jquery_file_upload, '/jQuery-File-Upload-9.11.2/js/jquery.iframe-transport.js')}" />
        <script src="{!URLFOR($Resource.jquery_file_upload, '/jQuery-File-Upload-9.11.2/js/jquery.fileupload.js')}" />
        
    <style>
        .adlabel  {
         font-size: 91%;
         text-align: right;
         }
         .adlabelpos  {
         width: 37%;
         margin-right: -2%;
         }
        .ui-autocomplete{  
            z-index:9999 !important;
        }
        .ui-dialog{  
            z-index:9999 !important;
        }
        .pbTitle {
            width: {!IF(isstep2,'90% !important','40% !important')};
        }
        .statusBox{margin-left: 212%;margin-top: -32.5%;}
        .statusBoxOther{margin-left: 172.5%;margin-top: -25%;}
        .statusBoxMW{margin-left: 59.5%;margin-top: -16.5%;}
        .wid  {
         width: 85%;
         }
       
       .pbBody {
        padding-left:10px !important;    
       }

       .apcontainer div {
        border: 0px !important;
        }
            
       .pbBody a{color:#337ab7 !important}
               
        .bPageBlock {
            border-top-width : thin !important;
        }
        
        .bEditBlock input {
            vertical-align:top !important;
        }
       
       .btn {
            padding: 2px 12px !important;
        }
                             
        .btn-primary {
            color: #fff !important;
            background: inherit !important;
            background-color: #337ab7 !important;
            border-color: #2e6da4 !important;
            border: 1px solid transparent !important;
            /*background: */
        }
        
        .tb-header {
            padding-right:20px;
        }
                 
        .modalrow {
            padding-top:10px;
        }
            
        ul li, ol li {
            margin-left: inherit;
            padding-left: inherit;
        }
        
        #contentWrapper {  background: #fff !important; margin: 0 auto;max-width: 1170px;}
            
        .requiredText {display:none;}
        
        .dateFormat {display:none;}
        
        .errorMsg {color:#d74c3b}
            
        .progress-bar-off {
                color:#6BBBEA;
                font-weight:bold;
                background-image:none !important;
                background-color:transparent !important;
                border-right:2px solid white;
        }
        
        body .bPageBlock .pbBody .pbSubheader{
                background-image: url('') !important;
                background-color:  #1797c0;
                color: #fff;
        }

        body .bPageBlock .pbBody .summary-subsection .pbSubheader{
                background-image: url('') !important;
                background-color: initial;
                color: initial;
        }
        
        .pbSubheader {
            font-weight:bold;
            font-size:15px;
        }
                   
        .contact-detail {
            font-size:12px;
            margin-bottom:3px;
        }
                   
        .tbFooter {
         text-align:right;
        }
                   
        .requiredBlock {
            width:5px !important;
        }

        .checkbox-td {
            text-align: center;
        }

        .summary-table th {
            text-align: center;
        }

        .summary-table td.dataCell {
            border: 1px solid #e0e3e5 !important;
        }

        .headerRow {
            white-space: pre-line !important;
        }
        
            .col1 {
                padding-bottom:5px;
                width:40%;
                vertical-align: text-top;
                font-weight:bold
            }
            
            .col1_regular {
                padding-bottom:5px;
                width:25%;
                vertical-align: text-top;
                font-weight:bold
            }       
                   
            .col2 {width:60%; padding-left:50px;vertical-align: text-top;}
            .col2_regular {width:25%; padding-left:50px;vertical-align: text-top;}
            .col2_4 {width:10%;padding-left:5px;vertical-align: text-top;}
            .col3 {width:50%}
       
    </style>    
    <script type="text/javascript">
    var defaultHQCountry = '{!newCase.IFAP_Country_ISO__c}';
    var $j = jQuery.noConflict();

    $j(function () {
        $j('[data-toggle="tooltip"]').tooltip();
    })

    $j(document).ready(function() {
        $j('[id$=section4_2]').css('width','95%');
        $j('[id$=prevCompanySection]').css('width','95%');
        $j(".country__c").val("{!isocountry.Name}");
        initFieldsSettings();
        updateAllFields();       
    });

    var ownerRecType;
    var companyOwnerRecType;

    function closeModal() {

        $j(function() {
            $j( '#addNewContactModal' ).modal('hide');
            clearForm('{!$Component.newContact}', '{!$Component.newContact.contactBlock.contactcountry}');
      });

    }

    function initFieldsSettings(){
        //if("{!newForm.Branch_Office_Street_name_number__c}"=='' && "{!isValError}"=='true')
        $j('.branch_office_street_name_number__c').addClass('requiredIndicator');
        //if("{!newForm.Branch_Office_City__c}"=='' && "{!isValError}"=='true')
        $j('.branch_office_city__c').addClass('requiredIndicator');
        $j('.branch_office_email__c').addClass('requiredIndicator');
        $j('.requiredIndicator').wrap('<div class="requiredInput">').before('<div class="requiredBlock"></div>'); 
        $j(".country__c").attr('readonly', true);
        $j(".country__c").attr('disabled','disabled');
        $j(".labelText").hide();
        $j("[id$=branch_office_phone__c]").hide();
        $j( "[id$=BranchAddress]" ).find("input").on( "change", function() {
          updateAddressInfo();
        });
    }

    function updateAllFields(){
        if ('{!isocountry.Hide_Tax_Number_VAT__c}'=='false'){
            if ($j('[id$=vatoutput]').text() =='')
                $j('[id$=vatoutput]').text("{!accountConcerned.VAT_Number__c}");
            $j('[id$=modalvatnumber]').val($j('[id$=vatoutput]').text());
        }
        if ($j('[id$=emailoutput]').text() =='')
            $j('[id$=emailoutput]').text("{!accountConcerned.Email__c}");
        $j('.branch_office_email__c').val($j('[id$=emailoutput]').text());
        updateLegalNameInfo();
        updateTradeNameInfo();
        updateAddressInfo();
        updatePhoneInfo();
        updateFaxInfo();
    }

    function cancelModalChanges(){
        $j('[id$=modaltradename]').val($j('[id$=tradenameoutput]').text());
        if ('{!isocountry.Hide_Tax_Number_VAT__c}'=='false')
            $j('[id$=modalvatnumber]').val($j('[id$=vatoutput]').text());
        $j('.branch_office_email__c').val($j('[id$=emailoutput]').text());
        $j('[id$=modallegalname]').val($j('[id$=legalnameoutput]').text());
        $j('[id$=companyphone]').val($j('[id$=phoneoutput]').text());
        $j('[id$=companyphoneinput]').intlTelInput("setNumber",$j('[id$=companyphone]').val());
        $j('[id$=companyfax]').val($j('[id$=faxoutput]').text());
        $j('[id$=companyfaxinput]').intlTelInput("setNumber",$j('[id$=companyfax]').val());

        updateModalAddressInfo();

    }

    function updateTradeNameInfo(){
        if ($j('[id$=tradenameafterchange]').val() !='' && $j('[id$=tradenameafterchange]').val()!=undefined)
            $j('[id$=tradenameoutput]').text($j('[id$=tradenameafterchange]').val());
        else
            $j('[id$=tradenameoutput]').text("{!accountConcerned.TradeName__c}");
        $j('[id$=modaltradename]').val($j('[id$=tradenameoutput]').text());
    }

    function updateLegalNameInfo(){
        if ($j('[id$=legalnameafterchange]').val() !='' && $j('[id$=legalnameafterchange]').val()!=undefined)
            $j('[id$=legalnameoutput]').text($j('[id$=legalnameafterchange]').val());
        else
            $j('[id$=legalnameoutput]').text("{!accountConcerned.Name}");
        $j('[id$=modallegalname]').val($j('[id$=legalnameoutput]').text());
    }

    function updateModalAddressInfo(){
        if ($j('.branch_office_street_name_number__c:eq(0)').val() !='' && $j('.branch_office_street_name_number__c:eq(0)').val()!=undefined)
            $j('.branch_office_street_name_number__c:eq(1)').val($j('.branch_office_street_name_number__c:eq(0)').val());
        else
            $j('.branch_office_street_name_number__c:eq(1)').val("{!accountConcerned.BillingStreet}");
        if ($j('.branch_office_city__c:eq(0)').val() !='' && $j('.branch_office_city__c:eq(0)').val()!=undefined)
            $j('.branch_office_city__c:eq(1)').val($j('.branch_office_city__c:eq(0)').val());
        else
            $j('.branch_office_city__c:eq(1)').val("{!accountConcerned.BillingCity}");
        if ($j('.branch_office_postal_code__c:eq(0)').val() !='' && $j('.branch_office_postal_code__c:eq(0)').val()!=undefined)
            $j('.branch_office_postal_code__c:eq(1)').val($j('.branch_office_postal_code__c:eq(0)').val());
        else
            $j('.branch_office_postal_code__c:eq(1)').val("{!accountConcerned.BillingPostalCode}");
        if ($j('.state_province__c:eq(0)').val() !='' && $j('.state_province__c:eq(0)').val()!=undefined)
            $j('.state_province__c:eq(1)').val($j('.state_province__c:eq(0)').val());
        else
            $j('.state_province__c:eq(1)').val("{!accountConcerned.BillingState}");

    }

    function updateAddressInfo(){
        var billingaddress;

        updateModalAddressInfo();


        billingaddress = $j('.branch_office_street_name_number__c:eq(1)').val()+'<br/>'+$j('.branch_office_city__c:eq(1)').val()+', '+$j('.branch_office_postal_code__c:eq(1)').val()+'<br/>';
        if ($j('.state_province__c:eq(1)').val()!='')
            billingaddress += $j('.state_province__c:eq(1)').val() + ', ' ;
        billingaddress += "{!isocountry.Name}";

        $j('[id$=billingaddress]').html(billingaddress);


    }

    function updatePhoneInfo(){
        if ($j('[id$=locationphone]').val() !='' && $j('[id$=locationphone]').val()!=undefined)
            $j('[id$=phoneoutput]').text($j('[id$=locationphone]').val());
        else
            $j('[id$=phoneoutput]').text("{!accountConcerned.Phone}");

        $j('[id$=companyphone]').val($j('[id$=phoneoutput]').text());
        $j('[id$=companyphoneinput]').intlTelInput("setNumber",$j('[id$=companyphone]').val());
    }

    function updateFaxInfo(){
        if ($j('[id$=locationfax]').val() !='' && $j('[id$=locationfax]').val()!=undefined)
            $j('[id$=faxoutput]').text($j('[id$=locationfax]').val());
        else
            $j('[id$=faxoutput]').text("{!accountConcerned.Fax}");
        $j('[id$=companyfax]').val($j('[id$=faxoutput]').text());
        $j('[id$=companyfaxinput]').intlTelInput("setNumber",$j('[id$=companyfax]').val());
    }

    function toggleShareholdersMsg(myValue,prefix){
            if( $j('input[name="' + myValue + '"][value=No]').prop("checked")) {
                document.getElementById(prefix+'msgshareholdersdetails').style.display='block';
             } else {
                document.getElementById(prefix+'msgshareholdersdetails').style.display='none';
             }
    }


    var ownerModalFields = [];
    ownerModalFields[0] = "{!$Component.newContact.contactBlock.Financial_interest__c}";
    ownerModalFields[1] = "{!$Component.newContact.contactBlock.Number_Of_Shares__c}";
    function toggleModalContactFields(ownerId) {
        if(document.getElementById(ownerId).checked){
            for (index = 0; index < ownerModalFields.length; index++) {
                document.getElementById(ownerModalFields[index]).disabled = false;
            }
        } else {
             for (index = 0; index < ownerModalFields.length; index++) {
                document.getElementById(ownerModalFields[index]).disabled = true;
                document.getElementById(ownerModalFields[index]).value = null;
            }
        }
    }

     
    function updateCompanyOwnerRT(recTypeName){
        companyOwnerRecType = recTypeName;
    }

    function updateOwnerRT(recTypeName){
        ownerRecType = recTypeName;
        if (ownerRecType=='Current Owner'){
            $j('[id$=personEmail]').show();
            $j('[id$=ownerContactTitleAfterChange]').show(); 
            $j('[id$=ownerContactTitle]').hide();           
            if($j('[id$=LegalStatusAfterChange]').val()=='Corporation')
                $j('[id$=corporatefield2]').show();
            else
                $j('[id$=corporatefield2]').hide();            
        }

        else{
            $j('[id$=personEmail]').hide();
            $j('[id$=ownerContactTitle]').show();
            $j('[id$=ownerContactTitleAfterChange]').hide();  
            if($j('[id$=LegalStatus]').val()=='Corporation')
                $j('[id$=corporatefield2]').show();
            else
                $j('[id$=corporatefield2]').hide();
        }
    }

    function closeModal() {

        $j(function() {
            $j( '#addNewContactModal' ).modal('hide');
            clearForm('{!$Component.newContact}', '{!$Component.newContact.contactBlock.contactcountry}');
      });

    }

    function closeModal2() {
        $j(function() {
            $j( '#addNewCompanyModal' ).modal('hide');
      });
    }

    function showNewCompanyDialog() {
        $j(function() {
            $j( '#addNewCompanyModal').modal('show');
      });
    }

    function toggleContactDetails(s) {
        if($j(s).hasClass("glyphicon-plus")) {
            $j(s).switchClass("glyphicon-plus", "glyphicon-minus");
        } else {
            $j(s).switchClass("glyphicon-minus", "glyphicon-plus");
        }
        $j("." + s.id).toggle();
    }

    function closeModalWithConsoleLogComment() {

        $j(function() {
            $j( '#addNewContactModal' ).modal('hide');
            clearForm('{!$Component.newContact}', '{!$Component.newContact.contactBlock.contactcountry}');
      });

    }

    function closeModal3() {
        $j(function() {
            $j( '#updateAgencyModal' ).modal('hide');
      });
    }

    function showUpdateAgencyDialog() {
        $j(function() {
            $j( '#updateAgencyModal').modal('show');
      });
    }

    function showNewContactDialog() {
        $j(function() {
            $j( '#addNewContactModal').modal('show');
      });
    }

    function toggleLegalStatus(myValue){
        var theValue = document.getElementById(myValue).value;
        if (theValue != ''){
            $j('[id$=personTableBeforeChange]').show();
            if(theValue!='Sole Proprietorship')
                $j('[id$=previous-owners]').show();
            else
                $j('[id$=previous-owners]').hide();
            if(theValue=='Corporation')
                $j('[id$=prevcorporatedetails]').show();
            else
                $j('[id$=prevcorporatedetails]').hide();

        } else {
            $j('[id$=personTableBeforeChange]').hide();
            $j('[id$=previous-owners]').hide();
            $j('[id$=prevcorporatedetails]').hide();
        }   
       
        setHeaderLabels(theValue.toLowerCase());
    }

    function toggleLegalStatusAfterChange(myValue){
        var theValue = document.getElementById(myValue).value;
        if (theValue != ''){
            $j('[id$=personTableAfterChange]').show(); 
            if(theValue!='Sole Proprietorship')
                $j('[id$=current-owners]').show();
            else
                $j('[id$=current-owners]').hide();
            if(theValue=='Corporation')
                $j('[id$=currcorporatedetails]').show();
            else
                $j('[id$=currcorporatedetails]').hide();
        } else {
            $j('[id$=personTableAfterChange]').hide();  
            $j('[id$=current-owners]').hide();
            $j('[id$=currcorporatedetails]').hide();
        }  
       
        setHeaderLabelsAfterChange(theValue.toLowerCase());
    }


    function clearForm(fname, ctryfield) {
        var oForm = document.forms[fname];
        var elements = oForm.elements;
        oForm.reset();

    for(i=0; i<elements.length; i++) {

        field_type = elements[i].type.toLowerCase();

        switch(field_type) {

        case "text":
                elements[i].value = "";
                break;
        case "password":
        case "textarea":
            case "hidden":

            elements[i].value = "";
            break;

        case "radio":
        case "checkbox":
            if (elements[i].checked) {
                elements[i].checked = false;
            }
            break;

        case "select-one":
        case "select-multi":
                    elements[i].selectedIndex = -1;
                    break;
        default:
            break;
            }
        }
        
    }

    function toggleCurrencyCode(c) {
        $j('[id$=y1CurrencyCode]').html(' ' + c);
        $j('[id$=y2CurrencyCode]').html(' ' + c);
        $j('[id$=y3CurrencyCode]').val(c);
        $j('[id$=y4CurrencyCode]').val(c);
    }

    function showFuturePastDates(){             
        datePickerYearsAdded = false;                       
        var futureYearsToAdd = 20;    
        var pastYearsToAdd = 5;                      
        if (!datePickerYearsAdded) {
            var select = document.getElementById('calYearPicker');
            if (!select) return;
            select.innerHTML = '';
            var startYear = new Date().getFullYear() - pastYearsToAdd; ;
            for (var year = startYear; year < startYear + futureYearsToAdd + 1; year++) {
                select.options[select.options.length] = new Option(year, year);
            }
            datePickerYearsAdded = true;
        }
    }
    

    function togglePrevIATACode(cb, iatacode, employername, employeraddress, cbid) {
        if(cb==null) {
            cb = document.getElementById(cbid);
        }

        if(cb.checked) {
         document.getElementById(iatacode).disabled=false;
         document.getElementById(employername).disabled=true;
         document.getElementById(employeraddress).disabled=true;
        } else {
            document.getElementById(iatacode).disabled=true;
            document.getElementById(employername).disabled=false;
            document.getElementById(employeraddress).disabled=false;
        }
    }

    function togglePageItem(v, fldId) {
        var el = document.getElementById(fldId);
        if(v=='Yes') {
            el.style.display='block';
        } else {
            el.style.display='none';
        }
    }

    function toggleIssuedCapital(v, fldId) {
        var el = document.getElementById(fldId);
        if(v=='Corporation') {
            el.style.display='block';
        } else {
            el.style.display='none';
        }
    }


    function confirmContactDelete(conid, conname, contype) {
        msg =
        bootbox.confirm('{!$Label.ISSP_AMS_CONFIRM_DELETE}', function(result) {
            if(result) {
                deleteContact(conid);
            }
        });
    } 

    var ownerModalFields = [];
    ownerModalFields[0] = "{!$Component.newContact.contactBlock.contactFinInterest}";
    ownerModalFields[1] = "{!$Component.newContact.contactBlock.contactNumOfShares}";
    
    function copyPhysicalAddress() {
        var checkBox = document.getElementById('copyCheckBox');
        if (checkBox.checked){
            $j(".PostalStreet").val($j(".PhysicalStreet").val());
            $j(".PostalCity").val($j(".PhysicalCity").val());
            $j(".PostalState").val($j(".PhysicalState").val());
            $j(".PostalPostalCode").val($j(".PhysicalPostalCode").val());
            $j(".PostalProvince").val($j(".PhysicalProvince").val());
            $j(".PostalArea").val($j(".PhysicalArea").val());
        }
    }
   
    </script>
    
    <div class="pageNav" style="display:{!IF(isStep3,'inline-block','none')}">
        <p class="LOB">{!sectorDisplay}</p>
        <div style="border-top: 1px #fff dotted; padding-bottom: 3px;">
            <p>{!$Label.ISSP_AMS_Jump_To}</p>
        </div>
        <p><a href="#top">{!$Label.ISSP_AMS_Top}</a></p>
        <apex:outputText rendered="{!newform.Is_change_bank_account_details__c==true && PDFPerRegionCS!=null}">
            <p><a href="#nav_one">{!$Label.ISSP_AMS_NoC_Change_Bank_Details}</a></p>
        </apex:outputText>
        <apex:outputText rendered="{!newform.Is_change_legal_name__c==true}">
            <p><a href="#nav_two">{!$Label.ISSP_AMS_NoC_Change_of_Legal_Name}</a></p>
        </apex:outputText>
        <apex:outputText rendered="{!newform.Is_change_location__c==true}">
            <p><a href="#nav_true">{!$Label.ISSP_AMS_NoC_Change_of_Location}</a></p>
        </apex:outputText>
        <apex:outputText rendered="{!newform.Is_change_bank_account_details__c==false}">
        <p><a href="#nav_four">{!IF(newForm.Is_change_ownership_or_shareholding__c, $Label.ISSP_AMS_NoC_Change_Ownership_Shareholding, $Label.ISSP_AMS_NoC_Current_Ownership_or_Shareholding)}</a></p>
        </apex:outputText>
       
       
        
    </div>

    <div class="container">
       <div id="contentWrapper">
           <c:ISSP_CustomNavigation />
     
     <div class="panel-primary">
        <div class="panel-heading head_panel_green">
            {!$Label.ISSP_AMS_NoC_Request_for_Change} 
        </div>
    <div class="panel-body" id="body-enquiries">
        <apex:form id="AMSForm">
        <div class="progress">
            <div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 22%;">
                <apex:commandLink styleclass="btn btn-default" action="{!saveAMSFormAndGoToStep1}" value="{!IF(NOT(isNoticeOfChange),$Label.ISSP_AMS_Step1_ProgressBar, $Label.ISSP_AMS_NoC_StepA)}" id="Prev1"/>
            </div>
            <div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="0" style="width: 25%;">
                <apex:commandLink styleclass="btn btn-default" action="{!saveAMSFormAndGoBack}" value="{!$Label.ISSP_AMS_Step2_ProgressBar}" id="Prev2"/>
            </div>
            <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 22%;">
                {!IF(NOT(isNoticeOfChange),$Label.ISSP_AMS_Step3_ProgressBar, $Label.ISSP_AMS_NoC_StepC)}
            </div>
            <div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 16%;">
                <apex:commandLink styleclass="btn btn-default" action="{!saveAMSFormAndGoForward}" value="{!$Label.ISSP_AMS_Step4_ProgressBar}" id="Next4"/>
            </div>
            <div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 15%">
                <apex:commandLink styleclass="btn btn-default" action="{!saveAMSFormAndGoToStep5}" value="{!$Label.ISSP_AMS_Step5_ProgressBar}" id="Next5"/>
            </div>
        </div>
        
            <apex:actionFunction name="showOwnershipSec" action="{!NULL}" status="WaitingStatus" reRender="LegalStatusSection"/>
            <apex:actionFunction name="cancelAgentUpdate" action="{!cancelAgentUpdate}" status="WaitingStatus" reRender="newContact"/>
            <apex:actionFunction name="accountUpdatedToggleOff" action="{!accountUpdatedToggleOff}" status="WaitingStatus" reRender="updateAgency"/>
             <apex:actionFunction name="cancelCompanyUpdate" action="{!cancelAgentUpdate}" status="WaitingStatus" reRender="newCompany"/>
            <apex:actionFunction name="createAgencyContact" action="{!createAgencyContact}" oncomplete="if ({!contactSaved==true}){closeModalByCommandButton(); cancelAgentUpdate();} $j('[id$=submitBut]').removeAttr('disabled');" status="WaitingStatus" reRender="contactList,currContactList,currOwnerList,ownerList,theMessages" >
                <apex:param value="" name="contype" assignTo="{!contactType}" />
            </apex:actionFunction>
            <apex:actionFunction name="createAgencyCompany" action="{!createAgencyContact}" oncomplete="if ({!contactSaved==true}){closeModal2(); cancelCompanyUpdate();} $j('[id$=companySubmitBut]').removeAttr('disabled');" status="WaitingStatus" reRender="companyList,currCompanyList,currOwnerList,ownerList" >
                <apex:param value="" name="contype" assignTo="{!contactType}" />
            </apex:actionFunction>
            <apex:actionFunction name="deleteContact" action="{!deleteAgencyContact}" rerender="contactList,currContactList,companyList,currCompanyList,currOwnerList,ownerList"> 
                <apex:param value="" name="recordId" assignTo="{!editContactId}" />
            </apex:actionFunction>
            <apex:actionFunction name="cancelFormUpdate" action="{!cancelFormUpdate}" status="WaitingStatus" reRender="none"/>
                    
            <apex:pageBlock id="AMSBlock">
            <div class="alert alert-info" role="alert">
                {!$Label.ISSP_AMS_NoC_StepB_message}
            </div>
            <apex:pageBlockButtons >
                <apex:commandButton action="{!saveAMSFormAndGoBack}" value="{!$Label.ISSP_Back}"/>&nbsp;
                <apex:commandButton action="{!saveAMSFormAndGoForward}" value="{!$Label.ISSP_Next}" />
                <apex:commandButton action="{!saveAMSFormAndLeave}" value="{!$Label.ISSP_Save_Draft}" style="float:right" />
            </apex:pageBlockButtons>
            <apex:PageMessages id="msgs"/>
            <div class="apcontainer" style="border: 1px solid #ececec;">
                <span id="nav_one"></span>
                <apex:pageBlockSection columns="1" collapsible="false" rendered="{!newform.Is_change_bank_account_details__c==true && PDFPerRegionCS!=null}">
                    <apex:facet name="header">
                        <apex:outputpanel >
                            {!$Label.ISSP_AMS_NoC_Change_Bank_Details}
                        </apex:outputpanel>
                    </apex:facet>
                    <apex:panelGrid columns="1" rendered="{!isocountry.original_bank_details_not_required__c==false}">  
                        <apex:outputText value="{!$Label.ISSP_AMS_NoC_Bank_details_message1}"/>
                        <br/>
                        <apex:outputText escape="false" value="{!PDFPerRegionCS.Address__c}" style="padding-left:26px"/>
                        <apex:outputText value="{!$Label.ISSP_AMS_NoC_Bank_details_message2}"/>
                    </apex:panelGrid>
                    <apex:panelGrid columns="1" rendered="{!isocountry.original_bank_details_not_required__c==true}">  
                        <apex:outputText escape="false" value="{!$Label.ISSP_AMS_NoC_Bank_details_message1}"/>
                    </apex:panelGrid>
                    
                </apex:pageBlockSection>

                <span id="nav_two"></span>
                <div style="display:{!IF(newform.Is_change_legal_name__c==true,'','none')}">
                    <apex:pageBlockSection columns="2" collapsible="false" id="legalNameSection">
                        <apex:facet name="header">
                            <apex:outputpanel >
                                {!$Label.ISSP_AMS_NoC_Change_of_Legal_Name}
                            </apex:outputpanel>
                        </apex:facet>
                  <apex:pageBlockSection columns="1">    
                           <apex:outputText value="{!$Label.ISSP_AMS_NoC_Legal_Name_Before_Change}" style="font-weight:bold; font-size:110%"/>
                           <apex:pageBlockSectionItem labelStyle="width:26%">
                                <apex:outputField value="{!accountConcerned.Name}" />
                           </apex:pageBlockSectionItem> <br/>
                        <apex:outputtext rendered="{!isocountry.Local_language_Agency_details_required__c}"><!--empty: move following field to next row -->&nbsp;</apex:outputtext>
                      <apex:outputtext rendered="{!isocountry.Local_language_Agency_details_required__c}"><!--empty: move following field to next row -->&nbsp;</apex:outputtext>
                           <apex:pageBlockSectionItem labelStyle="width:26%">
                                <apex:outputField value="{!accountConcerned.TradeName__c}" />
                           </apex:pageBlockSectionItem>
                       </apex:pageBlockSection>
                       <apex:pageBlockSection columns="1">
                           <apex:outputText value="{!$Label.ISSP_AMS_NoC_Legal_Name_After_Change}" style="font-weight:bold; font-size:110%"/>
                           <apex:pageBlockSectionItem labelStyle="width:26%">
                               <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Local_Legally_Registered_Name__c.Label}"/>
                                <apex:inputField id="legalnameafterchange" value="{!newForm.Account_Name__c}" styleClass="{!IF(AND(isValError, newForm.Account_Name__c==null), 'requiredIndicator', '')}" onchange="updateLegalNameInfo()"/>
                           </apex:pageBlockSectionItem>
                           <apex:pageBlockSectionItem labelStyle="text-align:left" dataStyle="width:20%" rendered="{!isocountry.Local_language_Agency_details_required__c}">
                                <apex:outputLabel value="{!txtLocalAgencyDetailsLegalName}"/>
                                    <apex:outputPanel >
                                        <apex:inputField value="{!newForm.Local_Legally_Registered_Name__c}" />
                                        <apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtLocalAgencyDetailsNoCompany}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>        
                            <apex:pageBlockSectionItem labelStyle="width:26%">
                               <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Trade_Name__c.Label}"/>
                                <apex:inputField id="tradenameafterchange" value="{!newForm.Trade_Name__c}" onchange="updateTradeNameInfo()"/>
                           </apex:pageBlockSectionItem>
                       </apex:pageBlockSection>
                    </apex:pageBlockSection>
                </div>

                <span id="nav_three"></span>
                <div style="display:{!IF(newform.Is_change_location__c==true,'','none')}">
                    <apex:pageBlockSection columns="2" id="locationSection"  collapsible="false">
                        <apex:facet name="header">
                            <apex:outputpanel >
                                {!$Label.ISSP_AMS_NoC_Change_of_Location}
                            </apex:outputpanel>
                        </apex:facet>
                  <apex:pageBlockSection columns="1">    
                           <apex:outputText value="{!$Label.ISSP_AMS_NoC_Location_Before_Change}" style="font-weight:bold; font-size:110%"/>
                           <apex:pageBlockSectionItem labelStyle="width:26%">
                               <apex:outputtext value="{0}
                                    <br />{1}<br />{2}<br />Phone: {3}<br />Mobile: {4}<br />Fax: {5}" escape="false" label="{!$Label.ISSP_AMS_Step3_Office_FullAddress}">
                                    <apex:param value="{!accountConcerned.BillingStreet}" />
                                    <apex:param value="{!accountConcerned.BillingCity},&nbsp;{!accountConcerned.BillingPostalCode}" />
                                    <apex:param value="{!IF(accountConcerned.BillingState!='',accountConcerned.BillingState + ',&nbsp;','')}{!accountConcerned.BillingCountry}" />
                                    <apex:param value="{!accountConcerned.Phone}" />
                                    <apex:param value="{!accountConcerned.Mobile__c}" />
                                    <apex:param value="{!accountConcerned.FAX}" />
                                </apex:outputtext>
                           </apex:pageBlockSectionItem>  
                       </apex:pageBlockSection>
                       <apex:pageBlockSection columns="1" id="locationSubSection">
                           <apex:outputText value="{!$Label.ISSP_AMS_NoC_Location_After_Change}" style="font-weight:bold; font-size:110%; margin-left:7%"/>
                           <DSE:DS_DataQuality id="BranchAddress"
                                RecordRef="{!newForm}"
                                FieldGroupName="Branch Address"
                                Edit="true"
                                FormGroupStyle="form-group"
                                RowStyle="row"
                                LabelStyle="col-lg-4 adlabel"
                                InputStyle="col-lg-5 col-md-1 col-sm-1 col-xs-1"
                                StatusStyle="col-lg-1 col-md-1 col-sm-1 col-xs-1"
                                FormControlStyle="apcontainer">
                            </DSE:DS_DataQuality>
                            <apex:pageBlockSectionItem id="locationItemPhone" labelStyle="width:34%">
                                <apex:outputLabel style="margin-right:4%" value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Branch_Office_Phone_National__c.Label}"/>
                                <apex:inputField value="{!newForm.Branch_Office_Phone_National__c}" onblur="setInternationalAccountPhoneInfo('phone');$j('.branch_office_phone__c').change();updatePhoneInfo();" id="locationphoneinput" styleClass="requiredIndicator" style="width:80%"/>
                             </apex:pageBlockSectionItem>
                             <apex:pageBlockSectionItem id="locationItemMobile">
                            <apex:outputLabel style="margin-right:4%" value="{!$ObjectType.Account.fields.Mobile__c.Label}"/>
                            <apex:inputField value="{!newform.MobileNational__c}" onblur="setInternationalAccountPhoneInfo('mobile');" id="locationmobileinput" styleClass="col-lg-9"/>
                            </apex:pageBlockSectionItem>               
                            <apex:pageBlockSectionItem id="locationItemFax">
                                <apex:outputLabel style="margin-right:4%" value="Fax"/>
                                <apex:inputField value="{!newform.Branch_Office_Fax_National__c}" onblur="setInternationalAccountPhoneInfo('fax');updateFaxInfo();" id="locationfaxinput" styleClass="col-lg-9"/>
                            </apex:pageBlockSectionItem>
                                 <apex:inputHidden value="{!newForm.Branch_Office_Phone__c}" id="locationphone"/>
                                 <apex:inputHidden value="{!newform.Mobile__c}" id="locationmobile"/>
                                 <apex:inputHidden value="{!newform.Branch_Office_FAX__c}" id="locationfax"/>
                            </apex:pageBlockSection> 
                            <DSE:DS_DataQuality id="BranchPhone"
                                RecordRef="{!newForm}"
                                FieldGroupName="Branch Phone"
                                Edit="true"
                                FormGroupStyle="form-group"
                                RowStyle="row"
                                LabelStyle="labelCol col-lg-6 labelText"
                                InputStyle="col-lg-5"
                                StatusStyle="col-lg-1 col-md-1 col-sm-1 col-xs-1 {!IF(isocountry.Local_language_Agency_details_required__c==true,'statusBoxOther','statusBox')}"
                                FormControlStyle="apcontainer wid">
                            </DSE:DS_DataQuality>
                        
                        <apex:pageBlockSection columns="1" collapsible="false" rendered="{!isocountry.Local_language_Agency_details_required__c}">
                        <apex:facet name="header">
                            <apex:outputpanel >
                                {!txtLocalAgencyDetailsTitle}
                            </apex:outputpanel>
                        </apex:facet>
                        <apex:outputText value="{!txtLocalAgencyDetailsChangePleaseEnter}"/>
                       <apex:outputText value="{!txtLocalAgencyDetailsPhysicalAddress}" style="font-weight:bold; font-size:110%"/>
                       <apex:pageBlockSectionItem labelStyle="width:35%">
                           <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Local_Physical_Address_Street__c.Label}"/>
                            <apex:inputField value="{!newForm.Local_Physical_Address_Street__c}" onChange="copyPhysicalAddress()" styleClass="PhysicalStreet"/>
                       </apex:pageBlockSectionItem>  
                       <apex:inputField value="{!newForm.Local_Physical_Address_City__c}" onChange="copyPhysicalAddress()" styleClass="PhysicalCity"/>
                       <apex:inputField value="{!newForm.Local_Physical_Address_Postal_Code__c}" onChange="copyPhysicalAddress()" styleClass="PhysicalPostalCode"/>
                       <apex:inputField value="{!newForm.Local_Physical_Address_Province__c}" onChange="copyPhysicalAddress()" styleClass="PhysicalProvince"/>
                       <apex:inputField value="{!newForm.Local_Physical_Address_Area__c}" onChange="copyPhysicalAddress()" styleClass="PhysicalArea"/>
                       <apex:outputText value="{!CASE(isocountry.ISO_Code__c, 'KR', isocountry.IATA_Contry_KR__c, 'JP', isocountry.IATA_Country_JP__c, isocountry.IATA_Country_ZH__c)}" label="Country"/>
                        
                        <apex:outputText value="{!txtLocalAgencyDetailsCorrespondenceAddress}" style="font-weight:bold; font-size:110%"/>
                        <input type="checkbox" id="copyCheckBox" onChange="copyPhysicalAddress()"/>
                        <label for="copyCheckBox">{!txtLocalAgencyDetailsCopyAddress}</label> 
                        <apex:pageBlockSectionItem labelStyle="width:30%">
                           <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Local_Postal_Address_Street__c.Label}"/>
                        <apex:inputField value="{!newForm.Local_Postal_Address_Street__c}" styleClass="PostalStreet"/>
                        </apex:pageBlockSectionItem>
                       <apex:inputField value="{!newForm.Local_Postal_Address_City__c}" styleClass="PostalCity"/>
                       <apex:inputField value="{!newForm.Local_Postal_Address_Postal_Code__c}" styleClass="PostalPostalCode"/>
                       <apex:inputField value="{!newForm.Local_Postal_Address_Province__c}" styleClass="PostalProvince"/>
                       <apex:inputField value="{!newForm.Local_Postal_Address_Area__c}" styleClass="PostalArea"/>
                       <apex:outputText value="{!CASE(isocountry.ISO_Code__c, 'KR', isocountry.IATA_Contry_KR__c, 'JP', isocountry.IATA_Country_JP__c, isocountry.IATA_Country_ZH__c)}" label="Country"/>
                   </apex:pageBlockSection>
                    </apex:pageBlockSection>
                </div>

                <span id="nav_four"></span>
                    <apex:pageBlockSection columns="1" id="LegalStatusSection" collapsible="false" rendered="{!newform.Is_change_bank_account_details__c==false}">
                        <apex:facet name="header">
                            <apex:outputpanel >
                                {!IF(newForm.Is_change_ownership_or_shareholding__c, $Label.ISSP_AMS_NoC_Change_Ownership_Shareholding, $Label.ISSP_AMS_NoC_Current_Ownership_or_Shareholding)}
                            </apex:outputpanel>
                        </apex:facet>
                        <apex:actionFunction name="setHeaderLabels" action="{!setPageLegalStatusLabels}"  reRender="contactList, newContact">
                            <apex:param name="setlegalstatus" assignTo="{!legalstatus}" value="" />
                        </apex:actionFunction>
                        <apex:actionFunction name="setHeaderLabelsAfterChange" action="{!setPageLegalStatusAfterChangeLabels}"  reRender="currContactList, newContact">
                            <apex:param name="setlegalstatusafterchange" assignTo="{!legalstatusafterchange}" value="" />
                        </apex:actionFunction>
                        
                         
                        <apex:pageBlockSection columns="2">    
                            <apex:outputText value="{!$Label.ISSP_AMS_NoC_Current_Legal_Status}" style="font-weight:bold; font-size:110%;" rendered="{!newForm.Is_change_ownership_or_shareholding__c==false}" />          
                            <apex:outputText value="{!$Label.ISSP_AMS_NoC_Legal_Status_Before_Change}" style="font-weight:bold; font-size:110%;" rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}" />
                            <apex:outputText value="{!$Label.ISSP_AMS_NoC_Legal_Status_After_Change}" style="font-weight:bold; font-size:110%;display:{!IF(newForm.Is_change_ownership_or_shareholding__c==true, '', 'none')}"/>        
                            <apex:inputField value="{!newForm.ISSP_AMS_Legal_Status__c}" id="LegalStatus" onchange="showOwnershipSec();toggleLegalStatus('{!$Component.LegalStatus}');toggleIssuedCapital(this.value, '{!$Component.AMSForm.AMSBlock.section4.r7c2}');" />
                            <apex:pageblocksectionitem labelStyle="width:23%" rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}">
                            <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Specify_Legal_Status_After_Change__c.Label}"/>
                            <apex:inputField value="{!newForm.Specify_Legal_Status_After_Change__c}" id="LegalStatusAfterChange" onchange="showOwnershipSec();toggleLegalStatusAfterChange('{!$Component.LegalStatusAfterChange}');toggleIssuedCapital(this.value, '{!$Component.AMSForm.AMSBlock.section4.r10c2}');" />
                            </apex:pageblocksectionitem>
                        </apex:pageBlockSection>
                    </apex:pageBlockSection>
         
                   
                   <apex:pageBlockSection id="section4"  columns="2" collapsible="false">
                        <apex:outputPanel id="prevcorporatedetails" layout="block" style="display:{!IF(newForm.ISSP_AMS_Legal_Status__c=='Corporation', '', 'none')}">
                            <apex:pageBlockSection columns="1">
                            <apex:pageBlockSectionItem labelStyle="width:75%">
                                <apex:outputLabel value="{!$Label.ISSP_AMS_LABEL_Listed_Shares}"/>
                                <apex:selectRadio style="width:100px" id="prevshareholdersmsg" value="{!newForm.ISSP_AMS_Entity_with_listed_shares__c}" styleClass="{!IF(AND(isValError, newForm.ISSP_AMS_Entity_with_listed_shares__c==null), 'requiredIndicator', '')}" onchange="toggleShareholdersMsg('{!$Component.prevshareholdersmsg}','prev');">
                                    <apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
                                    <apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
                                </apex:selectRadio>
                            </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                        </apex:outputPanel>
                        <apex:outputPanel id="currcorporatedetails" layout="block" style="display:{!IF(newForm.Specify_Legal_Status_After_Change__c=='Corporation' && newForm.Is_change_ownership_or_shareholding__c==true, '', 'none')}">
                            <apex:pageBlockSection columns="1">
                            <apex:pageBlockSectionItem labelStyle="width:79%">
                                <apex:outputLabel value="{!$Label.ISSP_AMS_LABEL_Listed_Shares}"/>
                                <apex:selectRadio style="width:100px" id="currshareholdersmsg" value="{!newForm.ISSP_AMS_Curr_Entity_with_listed_shares__c}" styleClass="{!IF(AND(isValError, newForm.ISSP_AMS_Curr_Entity_with_listed_shares__c==null), 'requiredIndicator', '')}" onchange="toggleShareholdersMsg('{!$Component.currshareholdersmsg}','curr');">
                                    <apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
                                    <apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
                                </apex:selectRadio>
                            </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                        </apex:outputPanel>
                        <apex:outputPanel id="r7c2" layout="block" style="display:{!IF(newForm.ISSP_AMS_Legal_Status__c=='Corporation', '', 'none')}">
                        <apex:pageBlockSection columns="1">
                            <apex:pageblocksectionitem >
                                <apex:outputlabel value="{!$Label.ISSP_Currency}" />
                                <apex:outputpanel >
                                    <apex:inputfield id="y4CurrencyCode" value="{!newForm.CurrencyIsoCode}" style="float:left" onchange="toggleCurrencyCode(this.value);" />
                                    <apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtHelpCurrency}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
                                </apex:outputpanel>
                            </apex:pageblocksectionitem>
                            <apex:pageblocksectionitem labelStyle="width:38%">
                                <apex:outputText >
                                    <apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Issued_share_capital__c.Label}" rendered="{!newForm.Is_change_ownership_or_shareholding__c}"/>
                                    <apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Issued_share_capital_After_Change__c.Label}" rendered="{!newForm.Is_change_ownership_or_shareholding__c==false}"/>
                                </apex:outputText>
                                <apex:outputPanel >
                                    <apex:inputfield value="{!newForm.Issued_share_capital__c}"/> 
                                    <apex:outputText id="y1CurrencyCode" value=" {!newForm.CurrencyIsoCode}" />   
                                </apex:outputPanel>                           
                            </apex:pageblocksectionitem>
                            </apex:pageBlockSection>
                        </apex:outputPanel>
                        <apex:outputPanel id="r10c2" layout="block" style="display:{!IF(newForm.Specify_Legal_Status_After_Change__c=='Corporation' && newForm.Is_change_ownership_or_shareholding__c==true, '', 'none')}">
                            <apex:pageBlockSection columns="1">
                                <apex:pageblocksectionitem >
                                    <apex:outputlabel value="{!$Label.ISSP_Currency}" />
                                    <apex:outputpanel >
                                        <apex:inputfield id="y3CurrencyCode" value="{!newForm.CurrencyIsoCode}" style="float:left" onchange="toggleCurrencyCode(this.value);" />
                                        <apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtHelpCurrency}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
                                    </apex:outputpanel>
                                </apex:pageblocksectionitem>
                                <apex:pageblocksectionitem labelStyle="width:44%">
                                    <apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Issued_share_capital_After_Change__c.Label}" />
                                    <apex:outputPanel >
                                        <apex:inputfield value="{!newForm.Issued_share_capital_After_Change__c}"/> 
                                        <apex:outputText id="y2CurrencyCode" value=" {!newForm.CurrencyIsoCode}"/>   
                                    </apex:outputPanel>                            
                                </apex:pageblocksectionitem>
                                </apex:pageBlockSection>
                        </apex:outputPanel>
                        <apex:outputPanel id="personTableBeforeChange" style="display:{!IF(newForm.ISSP_AMS_Legal_Status__c!=null, '', 'none')}">
                        <apex:pageBlockSection columns="1" id="section4_2">
                        <div class="col-md-12 bg-info"><strong>{!IF(newForm.Is_change_ownership_or_shareholding__c, $Label.ISSP_AMS_NoC_Previous_Owners_Managers, $Label.ISSP_AMS_NoC_Current_Owners_Managers)}</strong></div>
                        <div id="prevmsgshareholdersdetails" class="bg-warning" style="margin-top:3px; margin-bottom:5px;{!IF(newForm.ISSP_AMS_Entity_with_listed_shares__c == 'No', 'border: 0px !important;', 'display:none')}">
                           {!$Label.ISSP_AMS_Not_Listed_Msg}
                        </div>
                        <apex:commandLink style="margin-right:5px" onfocus="updateOwnerRT('Previous Owner');showNewContactDialog();"><span class="glyphicon glyphicon-plus"></span>{!$Label.ISSP_AMS_Add_Person}
                        </apex:commandLink>
                                
                           <apex:pageBlockTable value="{!List_PreviousOwners}" var="agencycon"  id="contactList" styleClass="table-hover table table-condensed table-responsive">
                               <apex:column ><span class="glyphicon glyphicon-plus" onclick="toggleContactDetails(this)" id="tog{!agencycon.Id}"/></apex:column>
                            <apex:column headerValue="{!$ObjectType.Contact.fields.FirstName.Label}" value="{!agencycon.First_name__c}"/> 
                            <apex:column headerValue="{!$ObjectType.Contact.fields.LastName.Label}" value="{!agencycon.Last_name__c}"/>
                            <apex:column headerValue="{!CASE(ownerLabelType, 'shareholder', $Label.ISSP_AMS_Shareholder, 'partner', $Label.ISSP_AMS_Partner, $Label.ISSP_AMS_Owner)}" value="{!agencycon.Agency_owner__c}"  />
                            <apex:column value="{!agencycon.Agency_role__c}" >
                                <apex:facet name="header"><apex:outputText escape="false" value="{!CASE(roleLabelType, 'director', $Label.ISSP_AMS_Director, $Label.ISSP_AMS_Manager)}"/></apex:facet>
                            </apex:column>
                            
                            
                            <apex:column >
                                <apex:actionStatus id="actEditContact" >
                                    <apex:facet name="start" > 
                                        <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
                                            {!$Label.ISSP_AMS_Loading_Contact}    
                                    </apex:facet>
                                </apex:actionStatus>
                                <apex:commandLink action="{!editAgencyContact}" status="actEditContact" styleClass="glyphicon glyphicon-pencil" oncomplete="updateOwnerRT('Previous Owner');showNewContactDialog();" rerender="contactList, newContact">
                                    <apex:param value="{!agencycon.Id}" name="recordId" assignTo="{!editContactId}" />
                                </apex:commandLink>
                            </apex:column>
                            <apex:column >
                                <apex:commandLink onfocus="confirmContactDelete('{!agencycon.Id}', '{!agencycon.Name}', 'contact')" styleClass="glyphicon glyphicon-trash"/>
                            </apex:column>
                            <apex:column breakBefore="true" colspan="12" style="display:none; background-color:RGB(236, 246, 249)" styleClass="tog{!agencycon.Id}" id="contactDetails">
                                                                        <div class="col-md-5">
                                                                            <apex:outputText rendered="{!isocountry.ISO_Code__c=='CN'}">
                                                                                <div class="contact-detail"><span style="font-weight:bold">{!$Label.ISSP_AMS_First_Name_Chinese}&nbsp;</span>{!agencycon.Local_First_name__c}</div>
                                                                                <div class="contact-detail"><span style="font-weight:bold">{!$Label.ISSP_AMS_Last_Name_Chinese}&nbsp;</span>{!agencycon.Local_Last_Name__c}</div>
                                                                            </apex:outputText>                                                           
                                                                             <div class="contact-detail"><span style="font-weight:bold">{!$ObjectType.AMS_Accreditation_Contact__c.fields.Financial_interest__c.Label} </span>{!TEXT(agencycon.Financial_interest__c)}</div>
                                                                             <apex:outputText rendered="{!newForm.ISSP_AMS_Legal_Status__c=='Corporation'}">                                                                        
                                                                             <div class="contact-detail"><span style="font-weight:bold">{!$ObjectType.AMS_Accreditation_Contact__c.fields.Number_Of_Shares__c.Label}&nbsp;</span>{!TEXT(agencycon.Number_Of_Shares__c)}</div>
                                                                            </apex:outputText>
                                                                             
                                                                        </div>
                                                                            
                            </apex:column>
                        </apex:pageBlockTable>
                        </apex:pageBlockSection>
                        </apex:outputPanel>
                        <apex:outputPanel id="personTableAfterChange" layout="block" style="display:{!IF(newForm.Specify_Legal_Status_After_Change__c!=null && newForm.Is_change_ownership_or_shareholding__c==true, '', 'none')}">
                        <apex:pageBlockSection columns="1" rendered="{!newform.Is_change_ownership_or_shareholding__c==true}">
                        <div class="col-md-12 bg-info"><strong>{!$Label.ISSP_AMS_NoC_Current_Owners_Managers}</strong></div>
                        <div id="currmsgshareholdersdetails" class="bg-warning" style="margin-top:3px; margin-bottom:5px;{!IF(newForm.ISSP_AMS_Curr_Entity_with_listed_shares__c == 'No', 'border: 0px !important;', 'display:none')}">
                           {!$Label.ISSP_AMS_Not_Listed_Msg}
                        </div>
                        <apex:commandLink style="margin-right:5px" onfocus="updateOwnerRT('Current Owner');showNewContactDialog();"><span class="glyphicon glyphicon-plus"></span>{!$Label.ISSP_AMS_Add_Person}
                        </apex:commandLink>
                                
                           <apex:pageBlockTable value="{!List_CurrentOwners}" var="agencycon"  id="currContactList" styleClass="table-hover table table-condensed table-responsive">
                               <apex:column ><span class="glyphicon glyphicon-plus" onclick="toggleContactDetails(this)" id="tog{!agencycon.Id}"/></apex:column>
                            <apex:column headerValue="{!$ObjectType.Contact.fields.FirstName.Label}" value="{!agencycon.First_name__c}"/> 
                            <apex:column headerValue="{!$ObjectType.Contact.fields.LastName.Label}" value="{!agencycon.Last_name__c}"/>
                            <apex:column headerValue="{!CASE(ownerLabelTypeAfterChange, 'shareholder', $Label.ISSP_AMS_Shareholder, 'partner', $Label.ISSP_AMS_Partner, $Label.ISSP_AMS_Owner)}" value="{!agencycon.Agency_owner__c}" id="ownerTitle" />
                            <apex:column id="roleTitle" value="{!agencycon.Agency_role__c}" >
                                <apex:facet name="header"><apex:outputText escape="false" value="{!CASE(roleLabelTypeAfterChange, 'director', $Label.ISSP_AMS_Director, $Label.ISSP_AMS_Manager)}"/></apex:facet>
                            </apex:column>
                            
                            
                            <apex:column >
                                <apex:actionStatus id="actEditCurrOwner" >
                                    <apex:facet name="start" > 
                                        <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
                                            {!$Label.ISSP_AMS_Loading_Contact}    
                                    </apex:facet>
                                </apex:actionStatus>
                                <apex:commandLink action="{!editAgencyContact}" status="actEditCurrOwner" styleClass="glyphicon glyphicon-pencil" oncomplete="updateOwnerRT('Current Owner');showNewContactDialog();" rerender="currContactList, newContact">
                                    <apex:param value="{!agencycon.Id}" name="recordId" assignTo="{!editContactId}" />
                                </apex:commandLink>
                            </apex:column>
                            <apex:column >
                                <apex:commandLink onfocus="confirmContactDelete('{!agencycon.Id}', '{!agencycon.Name}', 'contact')" styleClass="glyphicon glyphicon-trash"/>
                            </apex:column>
                            <apex:column breakBefore="true" colspan="12" style="display:none; background-color:RGB(236, 246, 249)" styleClass="tog{!agencycon.Id}">
                                                                        <div class="col-md-5">
                                                                            <apex:outputText rendered="{!isocountry.ISO_Code__c=='CN'}">
                                                                                <div class="contact-detail"><span style="font-weight:bold">{!$Label.ISSP_AMS_First_Name_Chinese}&nbsp;</span>{!agencycon.Local_First_name__c}</div>
                                                                                <div class="contact-detail"><span style="font-weight:bold">{!$Label.ISSP_AMS_Last_Name_Chinese}&nbsp;</span>{!agencycon.Local_Last_Name__c}</div>
                                                                            </apex:outputText>                                                                           
                                                                             <div class="contact-detail"><span style="font-weight:bold">{!$ObjectType.AMS_Accreditation_Contact__c.fields.Financial_interest__c.Label} </span>{!TEXT(agencycon.Financial_interest__c)}</div>
                                                                             <apex:outputText rendered="{!newForm.Specify_Legal_Status_After_Change__c=='Corporation'}">                                                                        
                                                                             <div class="contact-detail"><span style="font-weight:bold">{!$ObjectType.AMS_Accreditation_Contact__c.fields.Number_Of_Shares__c.Label}&nbsp;</span>{!TEXT(agencycon.Number_Of_Shares__c)}</div>
                                                                            </apex:outputText>
                                                                            <div class="contact-detail"><span style="font-weight:bold">Email&nbsp;</span>{!agencycon.Email__c}</div>
                                                                             
                                                                        </div>
                                                                            
                            </apex:column>
                        </apex:pageBlockTable>
                        </apex:pageBlockSection>
                        </apex:outputPanel>  
                        <apex:outputPanel layout="block" id="previous-owners" style="display:{!IF(newForm.ISSP_AMS_Legal_Status__c!='Sole Proprietorship' && newForm.ISSP_AMS_Legal_Status__c!=null, '', 'none')}">
                         <apex:pageBlockSection columns="1" id="prevCompanySection">
                             <div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!IF(newForm.Is_change_ownership_or_shareholding__c, $Label.ISSP_AMS_NoC_Previous_Companies, $Label.ISSP_AMS_NoC_Current_Companies)}</strong></div>
                             <div class="col-md-12">
                                   <apex:outputText value="{!$Label.ISSP_AMS_Step3_4_Companies}" escape="false"/>
                               </div>
                                <apex:commandLink id="addcompany" style="margin-right:5px" onfocus="updateCompanyOwnerRT('Previous Company Owner');showNewCompanyDialog();"><span class="glyphicon glyphicon-plus"></span>{!$Label.ISSP_AMS_ADD_COMPANY}</apex:commandLink>
                             <apex:pageBlockTable value="{!List_PreviousCompanies}" var="agencycon"  id="companyList" styleClass="table-hover table table-condensed table-responsive">
                                    <apex:column headerValue="{!$ObjectType.Account.fields.Legal_name__c.Label}" value="{!agencycon.Name}"/>
                                    <apex:column value="{!agencycon.Registration_number__c}"/>
                                    <apex:column value="{!agencycon.IATACode__c}"/>
                                    <apex:column value="{!agencycon.Financial_interest__c}"/>
                                     <apex:column >
                                        <apex:commandLink action="{!editAgencyContact}" styleClass="glyphicon glyphicon-pencil" oncomplete="updateCompanyOwnerRT('Previous Company Owner');showNewCompanyDialog();" rerender="companyList, newCompany">
                                            <apex:param value="{!agencycon.Id}" name="recordId" assignTo="{!editContactId}" />
                                        </apex:commandLink>
                                    </apex:column>
                                    <apex:column >
                                        <apex:commandLink onfocus="confirmContactDelete('{!agencycon.Id}', '{!agencycon.Name}', 'company')" styleClass="glyphicon glyphicon-trash" rerender="companyList"/>
                                    </apex:column>
                             </apex:pageBlockTable>
                               

                            <div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!IF(newForm.Is_change_ownership_or_shareholding__c, $Label.ISSP_AMS_NoC_Summary_Previous_Ownership, $Label.ISSP_AMS_NoC_Summary_Current_Ownership)}</strong></div>
                            <div class="col-md-12">
                                   <apex:outputText value="{!$Label.ISSP_AMS_Step3_4_Ownership}" escape="false"/>
                               </div>
                                <apex:pageBlockTable value="{!List_Prev_Ownership_Summary}" var="owner"  id="ownerList" styleClass="table-hover table table-condensed table-responsive">
                                    <apex:column headerValue="{!$Label.ISSP_Owner}" value="{!owner.Name}"/>                               
                                    <apex:column footerClass="tbFooter" footerValue="TOTAL" headerValue="{!$Label.LAQ_Type}" value="{!$Label.ISSP_AMS_NoC_Prev_Company_Owner}" rendered="{!owner.RecordType.DeveloperName=='Previous_Company_Owner' && newForm.Is_change_ownership_or_shareholding__c==true}"/>
                                    <apex:column footerClass="tbFooter" footerValue="TOTAL" headerValue="{!$Label.LAQ_Type}" value="{!$Label.ISSP_AMS_NoC_Previous_Owner}" rendered="{!owner.RecordType.DeveloperName!='Previous_Company_Owner' && newForm.Is_change_ownership_or_shareholding__c==true}"/>
                                    <apex:column footerClass="tbFooter" footerValue="TOTAL" headerValue="{!$Label.LAQ_Type}" value="{!$Label.ISSP_AMS_NoC_Current_Owner}" rendered="{!owner.RecordType.DeveloperName!='Previous_Company_Owner' && newForm.Is_change_ownership_or_shareholding__c==false}"/>
                                    <apex:column footerClass="tbFooter" footerValue="TOTAL" headerValue="{!$Label.LAQ_Type}" value="{!$Label.ISSP_AMS_NoC_Curr_Company_Owner}" rendered="{!owner.RecordType.DeveloperName=='Previous_Company_Owner' && newForm.Is_change_ownership_or_shareholding__c==false}"/>
                                    <apex:column footerValue="{!ROUND(Prev_Ownership_Total, 2)}%" value="{!owner.Financial_interest__c}"/>
                             </apex:pageBlockTable>
                        </apex:pageBlockSection>
                        </apex:outputPanel> 
                        <apex:outputPanel layout="block" id="current-owners" style="display:{!IF(newForm.Specify_Legal_Status_After_Change__c!='Sole Proprietorship' && newForm.Specify_Legal_Status_After_Change__c!=null && newForm.Is_change_ownership_or_shareholding__c==true, '', 'none')}">
                         <apex:pageBlockSection columns="1">
                             <div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!$Label.ISSP_AMS_NoC_Current_Companies}</strong></div>
                             <div class="col-md-12">
                                   <apex:outputText value="{!$Label.ISSP_AMS_Step3_4_Companies}" escape="false"/>
                               </div>
                                <apex:commandLink id="addcompany" style="margin-right:5px" onfocus="updateCompanyOwnerRT('Current Company Owner');showNewCompanyDialog();"><span class="glyphicon glyphicon-plus"></span>{!$Label.ISSP_AMS_ADD_COMPANY}</apex:commandLink>
                             <apex:pageBlockTable value="{!List_CurrentCompanies}" var="agencycon"  id="currCompanyList" styleClass="table-hover table table-condensed table-responsive">
                                    <apex:column headerValue="{!$ObjectType.Account.fields.Legal_name__c.Label}" value="{!agencycon.Name}"/>
                                    <apex:column value="{!agencycon.Registration_number__c}"/>
                                    <apex:column value="{!agencycon.IATACode__c}"/>
                                    <apex:column value="{!agencycon.Financial_interest__c}"/>
                                     <apex:column >
                                        <apex:commandLink action="{!editAgencyContact}" styleClass="glyphicon glyphicon-pencil" oncomplete="updateCompanyOwnerRT('Current Company Owner');showNewCompanyDialog();" rerender="currCompanyList, newCompany">
                                            <apex:param value="{!agencycon.Id}" name="recordId" assignTo="{!editContactId}" />
                                        </apex:commandLink>
                                    </apex:column>
                                    <apex:column >
                                        <apex:commandLink onfocus="confirmContactDelete('{!agencycon.Id}', '{!agencycon.Name}', 'company')" styleClass="glyphicon glyphicon-trash" rerender="currCompanyList"/>
                                    </apex:column>
                             </apex:pageBlockTable>
                               
                            <div class="bg-info col-md-12" style="margin-top:15px;"><strong>{!$Label.ISSP_AMS_NoC_Summary_Current_Ownership}</strong></div>
                            <div class="col-md-12">
                                   <apex:outputText value="{!$Label.ISSP_AMS_Step3_4_Ownership}" escape="false"/>
                               </div>
                                <apex:pageBlockTable value="{!List_Curr_Ownership_Summary}" var="owner"  id="currOwnerList" styleClass="table-hover table table-condensed table-responsive">
                                    <apex:column headerValue="{!$Label.ISSP_Owner}" value="{!owner.Name}"/>
                                    <apex:column footerClass="tbFooter" footerValue="TOTAL" headerValue="{!$Label.LAQ_Type}" value="{!$Label.ISSP_AMS_NoC_Curr_Company_Owner}" rendered="{!owner.RecordType.DeveloperName=='Current_Company_Owner'}"/>
                                    <apex:column footerClass="tbFooter" footerValue="TOTAL" headerValue="{!$Label.LAQ_Type}" value="{!$Label.ISSP_AMS_NoC_Current_Owner}" rendered="{!owner.RecordType.DeveloperName!='Current_Company_Owner'}"/>
                                    <apex:column footerValue="{!ROUND(Curr_Ownership_Total, 2)}%" value="{!owner.Financial_interest__c}"/>
                                </apex:pageBlockTable>
                        </apex:pageBlockSection>
                        </apex:outputPanel>                     
                    </apex:pageBlockSection>
                    <br/><br/>
                    <apex:pageBlockSection columns="1" id="agencySection" collapsible="false" rendered="{!newform.Is_change_bank_account_details__c==false}">
                        <apex:facet name="header">
                            <apex:outputpanel >
                                {!$Label.ISSP_AMS_NoC_Agency_Information}
                            </apex:outputpanel>
                        </apex:facet>
                     <apex:outputpanel id="agencydetails">
                            <apex:pageblocksection columns="2">
                                <apex:outputtext ><!--empty: move following field to next row --></apex:outputtext>
                                <apex:pageBlockSection columns="1" >
                                <apex:pageBlockSectionItem labelStyle="width:56%" dataStyle="{!IF(AND(isValError, newForm.Confirm_Agent_Details__c==false), 'border:2px red solid !important;margin-right:5px', 'margin-right:5px')}">
                                <apex:outputLabel style="margin-right:-76%"  value="{!$Label.ISSP_AMS_NoC_Confirm_details}"/>
                                <apex:inputField styleClass="pull-right" value="{!newForm.Confirm_Agent_Details__c}"/>  
                                </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                                <apex:actionstatus id="actEditAccount" style="float:right">
                                    <apex:facet name="start">
                                        <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
                                        {!$Label.ISSP_AMS_NoC_Loadiing_Agency_Information}
                                    </apex:facet>
                                </apex:actionstatus>
                                <apex:commandLink styleclass="pull-right" style="margin-right:5px" status="actEditAccount" oncomplete="showUpdateAgencyDialog();"><span class="glyphicon glyphicon-pencil"></span>{!$Label.ISSP_AMS_Update_Agency}</apex:commandlink>
                                <apex:pageblocksectionitem >
                                    <apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Local_Legally_Registered_Name__c.Label}" />
                                    <apex:outputfield id="legalnameoutput" value="{!newForm.Account_Name__c}" />
                                </apex:pageblocksectionitem>
                                <apex:outputfield id="tradenameoutput" value="{!newForm.Trade_Name__c}" />
                                <apex:outputtext id="billingaddress" value="{0}
                                    <br />{1}<br />{2}" escape="false" label="{!$Label.ISSP_AMS_Step3_Office_FullAddress}">
                                    <apex:param value="{!newForm.Branch_Office_Street_name_number__c}"  />
                                    <apex:param value="{!newForm.Branch_Office_City__c},&nbsp;{!newForm.Branch_Office_Postal_code__c}" />
                                    <apex:param value="{!IF(newForm.State_Province__c!='',newForm.State_Province__c + ',&nbsp;','')}{!isocountry.Name}" />
                                </apex:outputtext>
                                <apex:outputfield id="phoneoutput" value="{!newForm.Branch_Office_Phone__c}" />
                                <apex:outputfield id="emailoutput" value="{!newForm.Branch_Office_Email__c}" />
                                <apex:outputfield id="faxoutput" value="{!newForm.Branch_Office_FAX__c}" />
                                <apex:outputfield id="vatoutput" value="{!newForm.ISSP_AMS_VAT_Number_Input__c}" rendered="{!NOT(isocountry.Hide_Tax_Number_VAT__c)}" />
                            </apex:pageblocksection>
                            </apex:outputpanel>
                            <br/><br/>
                            
                        </apex:pageBlockSection>
                      
                        <apex:pageBlockSection collapsible="false" columns="1" id="section4_1" rendered="{!newform.Is_change_bank_account_details__c==false}">
                        <apex:facet name="header">
                            <apex:outputpanel >
                                {!$Label.ISSP_AMS_NoC_Additional_Information}
                            </apex:outputpanel>
                        </apex:facet>
                        <apex:pageBlockSectionItem rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}">
                                <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Is_this_Head_Office_becoming_a_Branch__c.Label}"/>
                                <apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Is_this_Head_Office_becoming_a_Branch__c==null), 'border:2px red solid;', '')}" value="{!newForm.Is_this_Head_Office_becoming_a_Branch__c}">
                                    <apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
                                    <apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
                                </apex:selectRadio>
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}">
                                <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Is_this_Branch_becoming_a_Head_Office__c.Label}"/>
                                <apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Is_this_Branch_becoming_a_Head_Office__c==null), 'border:2px red solid;', '')}" value="{!newForm.Is_this_Branch_becoming_a_Head_Office__c}">
                                    <apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
                                    <apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
                                </apex:selectRadio>
                            </apex:pageBlockSectionItem>

                           <apex:pageBlockSectionItem >
                                <apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Q1}"/>
                                <apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Will_such_change_affect_the_premises__c==null), 'border:2px red solid;', '')}" value="{!newForm.Will_such_change_affect_the_premises__c}" onchange="togglePageItem(this.value, '{!$Component.AMSForm.AMSBlock.section4_1.r2c2}');">
                                    <apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
                                    <apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
                                </apex:selectRadio>
                            </apex:pageBlockSectionItem>

                           <apex:outputPanel id="r2c2" layout="block" style="display:{!IF(newForm.Will_such_change_affect_the_premises__c=='Yes', '', 'none')}">
                           <apex:pageBlockSection columns="1">
                               <apex:pageblocksectionitem labelStyle="width:50%">
                                   <apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Please_provide_details_for_the_change__c.Label}" />
                                   <apex:inputfield value="{!newForm.Please_provide_details_for_the_change__c}" style="width:200px;height:90px"/>
                            </apex:pageblocksectionitem>
                           </apex:pageBlockSection>
                            
                            </apex:outputPanel>
                        <apex:pageBlockSectionItem labelStyle="width:40%">
                            <apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Q2}"/>
                            <apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Will_such_change_affect_locations__c==null), 'border:2px red solid;', '')}" value="{!newForm.Will_such_change_affect_locations__c}" onchange="togglePageItem(this.value, '{!$Component.AMSForm.AMSBlock.section4_1.r3c2}');">
                                <apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
                                <apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
                            </apex:selectRadio>
                        </apex:pageBlockSectionItem>

                        <apex:outputPanel id="r3c2" layout="block" style="display:{!IF(newForm.Will_such_change_affect_locations__c=='Yes', '', 'none')}">
                           <apex:pageBlockSection columns="1">
                                <apex:pageblocksectionitem labelStyle="width:50%">
                                   <apex:outputlabel value="{!$Label.ISSP_AMS_NoC_State_IATA_code}" />
                                   <apex:inputfield value="{!newForm.Provide_explanation_for_change_locations__c}" style="width:200px;height:90px"/>
                                </apex:pageblocksectionitem>
                           </apex:pageBlockSection>                       
                        </apex:outputPanel>

                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Q3}"/>
                            <apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Will_such_change_affect_the_managers__c==null), 'border:2px red solid;', '')}" value="{!newForm.Will_such_change_affect_the_managers__c}" onchange="togglePageItem(this.value, '{!$Component.AMSForm.AMSBlock.section4_1.r4c2}');">
                                <apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
                                <apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
                            </apex:selectRadio>
                        </apex:pageBlockSectionItem>

                        <apex:outputPanel id="r4c2" layout="block" style="display:{!IF(newForm.Will_such_change_affect_the_managers__c=='Yes', '', 'none')}">
                           <apex:pageBlockSection columns="1">
                                <apex:pageblocksectionitem labelStyle="width:50%">
                                   <apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Provide_details_for_change_affect_staff__c.Label}" />
                                   <apex:inputfield value="{!newForm.Provide_details_for_change_affect_staff__c}" style="width:200px;height:90px"/>
                                </apex:pageblocksectionitem>
                           </apex:pageBlockSection>                       
                        </apex:outputPanel>

                        <apex:pageBlockSectionItem rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}">
                            <apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Q4}"/>
                            <apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Have_any_having_authorization_to_act__c==null), 'border:2px red solid;', '')}" value="{!newForm.Have_any_having_authorization_to_act__c}" onchange="togglePageItem(this.value, '{!$Component.AMSForm.AMSBlock.section4_1.r5c2}');">
                                <apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
                                <apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
                            </apex:selectRadio>
                        </apex:pageBlockSectionItem>

                        <apex:outputPanel id="r5c2" layout="block" style="display:{!IF(newForm.Have_any_having_authorization_to_act__c=='Yes', '', 'none')}">
                           <apex:pageBlockSection columns="1">
                                <apex:pageblocksectionitem labelStyle="width:50%">
                                   <apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Give_details_for_authorization_to_act__c.Label}" />
                                   <apex:inputfield value="{!newForm.Give_details_for_authorization_to_act__c}" style="width:200px;height:90px"/>
                                </apex:pageblocksectionitem>
                           </apex:pageBlockSection>                       
                        </apex:outputPanel>

                        <apex:pageBlockSectionItem rendered="{!newForm.Is_change_ownership_or_shareholding__c==true}">
                            <apex:outputLabel value="{!$Label.ISSP_AMS_NoC_Q5}"/>
                            <apex:selectRadio style="width:100px;{!IF(AND(isValError, newForm.Will_the_change_of_ownership_cause__c==null), 'border:2px red solid;', '')}" value="{!newForm.Will_the_change_of_ownership_cause__c}" onchange="togglePageItem(this.value, '{!$Component.AMSForm.AMSBlock.section4_1.r6c2}');">
                                <apex:selectOption itemValue="Yes" itemLabel="{!$Label.ISSP_Yes}" />
                                <apex:selectOption itemValue="No" itemLabel="{!$Label.ISSP_No}" />
                            </apex:selectRadio>
                        </apex:pageBlockSectionItem>

                        <apex:outputPanel id="r6c2" layout="block" style="display:{!IF(newForm.Will_the_change_of_ownership_cause__c=='Yes', '', 'none')}">
                           <apex:pageBlockSection columns="1">
                                <apex:pageblocksectionitem labelStyle="width:50%">
                                   <apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Give_details_for_the_change_of_ownership__c.Label}"/>
                                   <apex:inputfield value="{!newForm.Give_details_for_the_change_of_ownership__c}" style="width:200px;height:90px"/>
                                </apex:pageblocksectionitem>
                           </apex:pageBlockSection>                       
                        </apex:outputPanel>
                        <apex:pageblocksectionitem labelStyle="width:40%">
                            <apex:outputlabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Effective_Date_Of_Change__c.Label}" />
                            <apex:inputfield value="{!newForm.Effective_Date_Of_Change__c}" onclick="showFuturePastDates();"/>
                        </apex:pageblocksectionitem>
                    </apex:pageBlockSection>
                          
                
               
            </div>  <!-- EO APContainer -->
         </apex:pageBlock>
         
        </apex:form> <!-- EO AMS Form -->


        <!-- Modal New Agency Contact - Person -->
<apex:form id="newContact">
<div class="modal fade" id="addNewContactModal" role="dialog" tabindex="-1" aria-labelledby="myModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" onclick="cancelAgentUpdate(); return false;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">{!$Label.ISSP_AMS_Add_Person}</h4>
      </div>
      
      <apex:pageMessages id="theMessages" />
       
      <div class="modal-body">
          <apex:pageBlock id="contactBlock">
            <apex:pageBlockSection id="contactSection" columns="4">  
                <apex:pageBlockSectionItem id="contactItemOwner" labelStyle="font-size:110%" dataStyle="width:15%">
                    <apex:pageBlockSectionItem >
                    <apex:outputLabel id="ownerContactTitle">{!CASE(ownerLabelType, 'shareholder', $Label.ISSP_AMS_Shareholder, 'partner', $Label.ISSP_AMS_Partner, $Label.ISSP_AMS_Owner)}</apex:outputLabel>
                    <apex:outputLabel id="ownerContactTitleAfterChange">{!CASE(ownerLabelTypeAfterChange, 'shareholder', $Label.ISSP_AMS_Shareholder, 'partner', $Label.ISSP_AMS_Partner, $Label.ISSP_AMS_Owner)}</apex:outputLabel>
                    </apex:pageBlockSectionItem>
                    <apex:inputField value="{!newContact.Agency_owner__c}" id="owner" onclick="toggleModalContactFields('{!$Component.newContact.contactBlock.contactSection.contactItemOwner.owner}')"/>
                </apex:pageBlockSectionItem>           
                 <apex:pageBlockSectionItem id="contactItemDom" labelStyle="white-space: nowrap;font-size:110%" dataStyle="width:15%">
                    <apex:pageBlockSectionItem >
                    <apex:outputLabel id="roleContactTitle">{!CASE(roleLabelType, 'director', $Label.ISSP_AMS_Director, $Label.ISSP_AMS_Manager)}</apex:outputLabel>
                    <apex:outputLabel id="roleContactTitleAfterChange">{!CASE(roleLabelTypeAfterChange, 'director', $Label.ISSP_AMS_Director, $Label.ISSP_AMS_Manager)}</apex:outputLabel>
                    </apex:pageBlockSectionItem>
                    <apex:inputField value="{!newContact.Agency_role__c}" id="dom" />
                </apex:pageBlockSectionItem>   

                                  
            </apex:pageBlockSection>
            <!--<apex:pageBlockSection id="contactSectionAfterChange" columns="4">
                <apex:pageBlockSectionItem id="contactItemOwnerAfterChange" labelStyle="font-size:110%" dataStyle="width:15%">
                    <apex:outputLabel id="ownerContactTitleAfterChange">{!CASE(ownerLabelTypeAfterChange, 'shareholder', $Label.ISSP_AMS_Shareholder, 'partner', $Label.ISSP_AMS_Partner, $Label.ISSP_AMS_Owner)}</apex:outputLabel>
                    <apex:inputField value="{!newContact.Agency_owner__c}" id="ownerAfterChange"/>
                </apex:pageBlockSectionItem>           
                 <apex:pageBlockSectionItem id="contactItemDomAfterChange" labelStyle="white-space: nowrap;font-size:110%" dataStyle="width:15%">
                    <apex:outputLabel id="roleContactTitleAfterChange">{!CASE(roleLabelTypeAfterChange, 'director', $Label.ISSP_AMS_Director, $Label.ISSP_AMS_Manager)}</apex:outputLabel>
                    <apex:inputField value="{!newContact.Agency_role__c}" id="domAfterChange" />
                </apex:pageBlockSectionItem>    
             </apex:pageBlockSection> -->  
              <table>
                  <tr><td class="bg-info" colspan="3">{!$Label.ISSP_AMS_Step3_PersonModal_CheckBoxes}</td></tr>
                  <tr>
                      <td style="width:25%">
                        <table>
                            <tr><td class="modalrow">
                                <apex:outputText value="{!$ObjectType.Contact.fields.Salutation.Label}" /><br/>
                                <apex:inputField value="{!newContact.Salutation__c}" />
                                </td></tr>
                            <tr><td class="modalrow">
                                <apex:outputText value="{!IF(isocountry.Local_language_Agency_details_required__c, txtLocalAgencyDetailsFirstNameENG, $ObjectType.Contact.fields.FirstName.Label)}" /><br/>
                                <apex:inputField value="{!newContact.First_name__c}" />
                                </td></tr>
                            <apex:outputText rendered="{!isocountry.Local_language_Agency_details_required__c}">
                            <tr><td class="modalrow">
                                <apex:outputPanel >
                                    <apex:outputText value="{!txtLocalAgencyDetailsFirstNameLocal}" />&nbsp;
                                    <apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtLocalAgencyDetailsNoLocalFirstName}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
                                  </apex:outputPanel>   
                                  <apex:inputField value="{!newContact.Local_First_name__c}" required="true"/>
                                </td></tr>
                            </apex:outputText>
                            <tr><td class="modalrow">
                                <apex:outputText value="{!IF(isocountry.Local_language_Agency_details_required__c, txtLocalAgencyDetailsLastNameENG, $ObjectType.Contact.fields.LastName.Label)}" /><br/>
                                <apex:inputField value="{!newContact.Last_name__c}" />
                                </td></tr>
                            <apex:outputText rendered="{!isocountry.Local_language_Agency_details_required__c}">
                            <tr><td class="modalrow">
                                <apex:outputPanel >
                                    <apex:outputText value="{!txtLocalAgencyDetailsLastNameLocal}" />&nbsp;
                                    <apex:image value="/img/msg_icons/info16.png" style="margin-left:3px;" title="{!txtLocalAgencyDetailsNoLocalLastName}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
                                </apex:outputPanel>
                                <apex:inputField value="{!newContact.Local_Last_Name__c}" required="true"/>
                                </td></tr>
                            </apex:outputText>
                                             
                            <tr id="corporatefield1"><td class="modalrow">
                                <apex:outputText value="{!$ObjectType.AMS_Accreditation_Contact__c.fields.Financial_interest__c.Label}"/><br/>
                                <apex:inputField value="{!newContact.Financial_interest__c}" id="contactFinInterest"/>
                                </td></tr> 
                            <tr id="corporatefield2" style="display:none"><td class="modalrow">
                                <apex:outputText value="{!$ObjectType.AMS_Accreditation_Contact__c.fields.Number_Of_Shares__c.Label}"/><br/>
                                <apex:inputField value="{!newContact.Number_Of_Shares__c}" id="contactNumOfShares"/>
                                </td></tr>                   
                            <tr id="personEmail" style="display:none"><td class="modalrow">
                                <apex:outputText value="{!$ObjectType.Contact.fields.Email.Label}" /><br/>
                                <apex:inputField value="{!newContact.Email__c}"/>
                                </td></tr>
                        </table>
                      </td>                      
                    
                  </tr>
              </table>      
          </apex:pageBlock>
      </div>
      
      <div class="modal-footer">
        <!-- <apex:commandButton action="{!createAgencyContact}" value="{!$Label.PKB2_Submit}" oncomplete="closeModal(); setPortalAdmin('{!$Component.AMSForm.PortalAdminId}');" reRender="contactList, ownerList"> -->
        <apex:commandButton action="{!NULL}" status="WaitingStatus" id="submitBut" styleClass="btn btn-default" value="{!$Label.ISSP_Submit}" 
            oncomplete="createAgencyContact(ownerRecType);"
            onclick="this.disabled='disabled';"
            >

         </apex:commandButton>&nbsp;
        <button type="button" class="btn btn-default" onclick="cancelAgentUpdate(); return false;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{!$Label.ISSP_Cancel}</span></button>
      </div>
        <script src="{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/build/js/intlTelInput.js')}"></script>  
        <script>

        function closeModalByCommandButton()
        {          
            closeModal();
                
        }

        toggleModalContactFields('{!$Component.newContact.contactBlock.contactSection.contactItemOwner.owner}');
        
    </script>      
    </div>
  </div>
</div>
    
</apex:form>

        <apex:form id="updateAgency">
        <div class="modal fade" id="updateAgencyModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
          <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">{!$Label.ISSP_AMS_Update_HO_details}</h4>
              </div>
                
              <apex:pageMessages id="accountMessages" />
               
              <div class="modal-body">
                  <apex:pageBlock id="companyBlock">
                    <apex:pageBlockSection columns="2" id="companySection">
                            <apex:pageBlockSection columns="1" id="addressSection">
                                <DSE:DS_DataQuality id="BranchAddressMW"
                                    RecordRef="{!newForm}"
                                    FieldGroupName="Branch Address"
                                    Edit="true"
                                    FormGroupStyle="form-group"
                                    RowStyle="row"
                                    LabelStyle="col-lg-5 adlabel adlabelpos"
                                    InputStyle="col-lg-5 col-md-1 col-sm-1 col-xs-1"
                                    StatusStyle="col-lg-2 col-md-1 col-sm-1 col-xs-1"
                                    FormControlStyle="apcontainer">
                                </DSE:DS_DataQuality>
                                <DSE:DS_DataQuality id="BranchEmail"
                                    RecordRef="{!newForm}"
                                    FieldGroupName="Branch Email"
                                    Edit="true"
                                    FormGroupStyle="form-group"
                                    RowStyle="row"
                                    LabelStyle="col-lg-5 adlabel adlabelpos"
                                    InputStyle="col-lg-5 col-md-1 col-sm-1 col-xs-1"
                                    StatusStyle="col-lg-2 col-md-1 col-sm-1 col-xs-1"
                                    FormControlStyle="apcontainer">
                                </DSE:DS_DataQuality>
                            </apex:pageBlockSection>
                            <apex:pageBlockSection columns="1" id="otherDetailsSection">
                                <apex:inputField id="modallegalname" value="{!newform.Account_Name__c}" required="true"/>
                                <apex:inputField id="modaltradename" value="{!newform.Trade_Name__c}"/>                        
                                <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                                <apex:pageBlockSectionItem id="companyItemPhone">
                                    <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Branch_Office_Phone_National__c.Label}"/>
                                    <apex:inputField required="true" value="{!newForm.Branch_Office_Phone_National__c}" onblur="setInternationalAccountPhoneNo('phone');$j('.branch_office_phone__c').change();" id="companyphoneinput" style="width:79%"/>
                                 </apex:pageBlockSectionItem>        
                                <apex:pageBlockSectionItem id="companyItemFax">
                                    <apex:outputLabel value="{!$ObjectType.AMS_Pax_Accreditation_Form__c.fields.Branch_Office_Fax_National__c.Label}"/>
                                    <apex:inputField value="{!newForm.Branch_Office_Fax_National__c}" onblur="setInternationalAccountPhoneNo('fax');" id="companyfaxinput" style="width:79%"/>
                                </apex:pageBlockSectionItem>
                                <DSE:DS_DataQuality id="BranchPhoneMW"
                                    RecordRef="{!newForm}"
                                    FieldGroupName="Branch Phone"
                                    Edit="true"
                                    FormGroupStyle="form-group"
                                    RowStyle="row"
                                    LabelStyle="labelCol col-lg-6 labelText"
                                    InputStyle="col-lg-5"
                                    StatusStyle="col-lg-1 col-md-1 col-sm-1 col-xs-1 statusBoxMW"
                                    FormControlStyle="apcontainer wid">
                                </DSE:DS_DataQuality>
                                <apex:pageblocksectionitem rendered="{!NOT(isocountry.Hide_Tax_Number_VAT__c)}">
                                    <apex:outputlabel value="{!IF(isocountry.Tax_Number_label__c == null, $ObjectType.AMS_Pax_Accreditation_Form__c.fields.ISSP_AMS_VAT_Number_Input__c.Label, isocountry.Tax_Number_label__c)}" />
                                    <apex:outputpanel id="VATNumberInput">
                                        <apex:outputfield value="{!newCase.IFAP_Country_ISO__c}" rendered="{!isEUcountry}" />
                                        <apex:inputfield id="modalvatnumber" value="{!newForm.ISSP_AMS_VAT_Number_Input__c}" html-placeholder="{!isocountry.Tax_number_format__c}" onblur="if(this.value != '' && isEUcountry) {validateVAT(this.value.trim());}" required="true" />
                                        <apex:image value="/img/msg_icons/info16.png" style="margin-left:56%;margin-top:-9%" title="{!IF(isocountry.Tax_number_help_text__c == null, txtHelpTaxNumber, isocountry.Tax_number_help_text__c)}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
                                        <apex:actionstatus id="actValidVAT" startstyleclass="bg-info">
                                            <apex:facet name="start">
                                                {!$Label.ISSP_PAX_Validating_VAT_Number}
                                            </apex:facet>
                                        </apex:actionstatus>
                                    </apex:outputpanel>
                                </apex:pageblocksectionitem>
                                <apex:inputHidden value="{!newForm.Branch_Office_Phone__c}" id="companyphone"/>
                                <apex:inputHidden value="{!newForm.Branch_Office_FAX__c}" id="companyfax"/>
                                <apex:actionfunction name="validateVAT" action="{!validateVATNumber}" status="actValidVAT" rerender="VATNumberInput">
                                    <apex:param name="vatno" value="" assignto="{!vatNUmber}" />
                                </apex:actionfunction>
                                
                            </apex:pageBlockSection>
                            
                              
                    </apex:pageBlockSection>
                    <apex:pageBlockSection columns="1">
                        
                    </apex:pageBlockSection>
                  </apex:pageBlock>
              </div>
              <div class="modal-footer">
                    
                <apex:commandButton styleClass="btn btn-default" action="{!updateNoCAgencyInfo}" status="waitingStatus" value="{!$Label.ISSP_Submit}"
                                    oncomplete="if ({!formUpdated}) {closeModal3(); cancelFormUpdate();} this.removeAttribute('disabled');updateAllFields();initFieldsSettings();" onclick="this.disabled='disabled'" rerender="agencydetails,locationSection,accountMessages,newSales,legalNameSection"  />&nbsp;
                <button  type="button" class="btn btn-default"  onclick="cancelFormUpdate();cancelModalChanges(); return false;"  data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{!$Label.ISSP_Cancel}</span></button>
              </div>
            <script type="text/javascript">
            var natphoneacct = $j("input[name='{!$Component.updateAgency.companyBlock.companySection.otherDetailsSection.companyItemPhone.companyphoneinput}']");
            var phoneacct1 = $j('.branch_office_phone__c');
            var phoneacct2 = $j("input[name='{!$Component.updateAgency.companyBlock.companySection.otherDetailsSection.companyphone}']");
          
                natphoneacct.intlTelInput({
                    nationalMode: true,
                    defaultCountry: defaultHQCountry,
                    numberType: "FIXED_LINE",
                    utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
                });
                
                natphoneacct.intlTelInput("setNumber", phoneacct1.val());
                
                var natmobileacct = $j("input[name='{!$Component.updateAgency.companyBlock.companySection.otherDetailsSection.companyItemMobile.companymobileinput}']");
                var mobileacct = $j("input[name='{!$Component.updateAgency.companyBlock.companySection.otherDetailsSection.companymobile}']");
                
                 natmobileacct.intlTelInput({
                    nationalMode: true,
                    defaultCountry: defaultHQCountry,
                    numberType: "MOBILE",
                    utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
                });
                natmobileacct.intlTelInput("setNumber", mobileacct.val());
                
                var natfaxacct = $j("input[name='{!$Component.updateAgency.companyBlock.companySection.otherDetailsSection.companyItemFax.companyfaxinput}']");
                var faxacct = $j("input[name='{!$Component.updateAgency.companyBlock.companySection.otherDetailsSection.companyfax}']");
            
                 natfaxacct.intlTelInput({
                    nationalMode: true,
                    defaultCountry: defaultHQCountry,
                    numberType: "FIXED_LINE",
                    utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
                });
                
                natfaxacct.intlTelInput("setNumber", faxacct.val());
                
                function setInternationalAccountPhoneNo(p) {
                    if(p=='phone') {
                        phoneacct1.val(natphoneacct.intlTelInput("getNumber"));
                        phoneacct2.val(natphoneacct.intlTelInput("getNumber"));
                    } else if(p=='mobile') {
                        mobileacct.val(natmobileacct.intlTelInput("getNumber"));
                    } else {
                        faxacct.val(natfaxacct.intlTelInput("getNumber"));
                    }
                }
            </script>          
            </div>
          </div>
        </div>
        </apex:form> 
<!-- Modal New Agency Contact - Company -->
<apex:form id="newCompany">
<div class="modal fade" id="addNewCompanyModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" onclick="cancelCompanyUpdate(); return false;"  data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">{!$Label.ISSP_AMS_Add_Company}</h4>
      </div>
      <div class="modal-body">
          <apex:pageBlock >
           <apex:pageMessages id="companyMessages" />
        
         <apex:pageBlockSection id="companySection" columns="1">
                <apex:pageBlockSectionItem >
                     <apex:outputLabel value="{!IF(isocountry.Local_language_Agency_details_required__c, txtLocalAgencyDetailsCompanyNameENG, $ObjectType.Account.fields.Legal_name__c.Label)}"/>
                    <apex:inputField value="{!newContact.Name}" required="true"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!isocountry.Local_language_Agency_details_required__c}">
                 <apex:outputLabel value="{!txtLocalAgencyDetailsCompanyNameLocal}" />
                 <apex:outputPanel >
                    <apex:inputField value="{!newContact.Company_Name_Local__c}" required="true"/>
                    <apex:image value="/img/msg_icons/info16.png" style="margin-left: 43%;margin-top: -7%;" title="{!txtLocalAgencyDetailsNoLocalCompanyName}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip" />
                </apex:outputPanel>
             </apex:pageBlockSectionItem>
                <apex:inputField value="{!newContact.Registration_number__c}" required="true" />
                <apex:inputField value="{!newContact.IATACode__c}" onblur="fetchTravelAgent3(this.value.trim())"/>

                <apex:actionStatus id="loadingDetailsCompanyModal" startStyleClass="bg-info">
                    <apex:facet name="start" >
                        {!$Label.ISSP_Loading_Travel_Agency_Details}     
                    </apex:facet>
                </apex:actionStatus>

                <apex:outputPanel id="companyModalIataCodeValidation">
                    <apex:outputText value="{!$Label.ISSP_AMS_Invalid_IATA_Code}" styleClass="bg-danger" escape="false" rendered="{!AND(companyModalNameOfEmployer=='', iatacode!='')}"/>    
                    <apex:outputPanel rendered="{!AND(companyModalNameOfEmployer!='', iatacode!='')}">
                        <span style="font-weight: bold; color: #4a4a56;">{!$Label.ISSP_AMS_Name_of_employer} </span>{!companyModalNameOfEmployer} <br/>
                        <span style="font-weight: bold; color: #4a4a56;">{!$Label.ISSP_AMS_Address} </span> {!companyModalAddress}
                   </apex:outputPanel>
                </apex:outputPanel>                   

                <apex:inputField value="{!newContact.Financial_interest__c}" required="true"/>
          </apex:pageBlockSection>
          </apex:pageBlock>
      </div>
      
      <div class="modal-footer">
          <apex:commandButton action="{!NULL}" status="WaitingStatus" id="companySubmitBut" styleClass="btn btn-default" value="{!$Label.ISSP_Submit}" 
            oncomplete="createAgencyCompany(companyOwnerRecType);"
            onclick="this.disabled='disabled';" reRender="companyMessages"
            >
          </apex:commandButton>&nbsp;
        <button type="button" class="btn btn-default" onclick="cancelCompanyUpdate(); return false;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{!$Label.ISSP_Cancel}</span></button>
      </div>
    </div>
  </div>
</div>
   
</apex:form>

<!-- Modal Statement of International Sales -->
<apex:form id="newSales">
<div class="modal fade" id="addNewSalesModal" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" onclick="cancelSalesUpdate(); return false;"  data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">{!$Label.ISSP_AMS_Add_International_Sales}</h4>
      </div>
      <div class="modal-body">
          <apex:pageBlock id="salesBlock">
           <apex:pageMessages id="salesMessages" />
        <apex:inputHidden id="newSalesCurrency" value="{!newInternationalSales.CurrencyIsoCode}" />
         <apex:pageBlockSection id="salesSection" columns="1">
            <apex:pageBlockSectionItem >
                <apex:outputLabel value="{!$ObjectType.ISSP_AMS_Statement_International_Sales__c.fields.IATA_Member_Airline__c.Label}"/>
                <apex:selectList styleClass="member-airlines-select" id="memberairline" value="{!memberairlineid}" label="{!$ObjectType.ISSP_AMS_Statement_International_Sales__c.fields.IATA_Member_Airline__c.Label}" required="true" size="1">
                    <apex:selectOptions value="{!IATAMemberAirlines}"/>
                </apex:selectList>
            </apex:pageBlockSectionItem>
             <apex:pageBlockSectionItem id="salesSectionItem">
                <apex:outputLabel value="{!$ObjectType.ISSP_AMS_Statement_International_Sales__c.fields.Sales_Amount__c.Label} ({!newForm.CurrencyIsoCode})"/>
                <apex:outputPanel id="salesSectionPanel">
                    <apex:inputField value="{!newInternationalSales.Sales_Amount__c}" required="true"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>
          </apex:pageBlockSection>
          </apex:pageBlock>
      </div>
      
      <div class="modal-footer">
          <apex:commandButton action="{!createInternationalSales}" styleClass="btn btn-default" value="{!$Label.ISSP_Submit}"
            oncomplete="if ({!salesSaved}){closeModal4();cancelSalesUpdate();}this.removeAttribute('disabled');" onclick="this.disabled='disabled'" reRender="salesList, salesMessages">
         </apex:commandButton>&nbsp;
        <button type="button" class="btn btn-default" onclick="cancelSalesUpdate(); return false;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{!$Label.ISSP_Cancel}</span></button>
      </div>
    </div>
  </div>
</div>
    
    <script>
                        
        var natmobileacct1 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.locationSubSection.locationItemMobile.locationmobileinput}']");                
                            var mobileacct1 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.locationSubSection.locationmobile}']");
                            
                             natmobileacct1.intlTelInput({
                                nationalMode: true,
                                defaultCountry: defaultHQCountry,
                                numberType: "MOBILE",
                                utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
                            });
                            
                            
                            var natfaxacct1 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.locationSubSection.locationItemFax.locationfaxinput}']");
                            var faxacct1 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.locationSubSection.locationfax}']");
                        
                             natfaxacct1.intlTelInput({
                                nationalMode: true,
                                defaultCountry: defaultHQCountry,
                                numberType: "FIXED_LINE",
                                utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
                            });

                            var natphoneacct1 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.locationSubSection.locationItemPhone.locationphoneinput}']");
                            var phoneacct1 = $j('.branch_office_phone__c');
                            var phoneacct2 = $j("input[name='{!$Component.AMSForm.AMSBlock.locationSection.locationSubSection.locationphone}']");
                      
                            natphoneacct1.intlTelInput({
                                nationalMode: true,
                                defaultCountry: defaultHQCountry,
                                numberType: "FIXED_LINE",
                                utilsScript: "{!URLFOR($Resource.InternationalPhoneNumberFormat, '/intl-tel-input-master/lib/libphonenumber/build/utils.js')}"
                            });

                            natmobileacct1.intlTelInput("setNumber", mobileacct1.val());
                            
                            natfaxacct1.intlTelInput("setNumber", faxacct1.val());

                            natphoneacct1.intlTelInput("setNumber", phoneacct1.val());


                            
                            
                            function setInternationalAccountPhoneInfo(p) {
                                if(p=='phone') {
                                    phoneacct1.val(natphoneacct1.intlTelInput("getNumber"));
                                    phoneacct2.val(natphoneacct1.intlTelInput("getNumber"));
                                } else if(p=='mobile') {
                                    mobileacct1.val(natmobileacct1.intlTelInput("getNumber"));
                                } else {
                                    faxacct1.val(natfaxacct1.intlTelInput("getNumber"));
                                }
                                        }                                       


                            
                
    </script>
   
</apex:form>

     </div>   
     </div>
     </div>
         <c:ISSP_CustomFooter />
         </div>
       
    </body>  
</html>
    </apex:page>