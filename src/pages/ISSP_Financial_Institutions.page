<apex:page controller="ISSP_Financial_Institutions" cache="false" sidebar="false" showHeader="false" applyBodyTag="false" applyHtmlTag="false" standardStylesheets="false">
	<html>
  		<c:ISSP_Header />
  		<body>
  			<script type="text/javascript">
  				function showTermsAndConditionsModal() {
  					$('[id$="termsAndConsitionsFIModal"]').css('display', 'block');
  					changeContinueButtonState();
  					$('[id$="errorMessagesTCModal"]').css('display', 'none');	
  				}

  				function hideTermsAndConditionsModal() {
  					$('[id$="termsAndConsitionsFIModal"]').css('display', 'none');
  				}

  				function changeContinueButtonState() {
  					if($('[id$="tcModalAgreeCheckbox"]').prop("checked"))
  						$('[id$="tcModalConfirmButton"]').removeAttr('disabled');
  					else
  						$('[id$="tcModalConfirmButton"]').attr('disabled','disabled');
  				}

  				function disableTCModalButtons() {
  					$('[id$="tcModalConfirmButton"]').attr('disabled','disabled');
  					$('[id$="tcModalCloseButton"]').attr('disabled','disabled');
  					$('[id$="tcModalAgreeCheckbox"]').attr('disabled','disabled');
  					$('[id$="tcModalCloseButtonSecondary"]').attr('disabled','disabled');
  				}

  				function enableTCModalButtons() {
  					$('[id$="tcModalConfirmButton"]').removeAttr('disabled');
  					$('[id$="tcModalCloseButton"]').removeAttr('disabled');
  					$('[id$="tcModalAgreeCheckbox"]').removeAttr('disabled');
  					$('[id$="tcModalCloseButtonSecondary"]').removeAttr('disabled');
  				}
  			</script>

  			<c:ISSP_CustomNavigation />
  			<div class="container">
  				<div id="contentWrapper">
  					<div>
		                <apex:image value="{!URLFOR($Resource.IATA_Logo_Large)}" width="138" height="102" style="float: left;"/>
		            </div>
		            <div style="padding-top: 16px; padding-left: 44px;">
		                <h3>Financial Institution Insurance Providers</h3>
		                <apex:outputText value="The following Financial Institutions provide Financial Security Insurance in your country" escape="false"/>
		            </div>
		            <apex:form >

		            	<!--<apex:actionFunction name="termsAndConditionsModal" action="{!showTermsAndConditions}" reRender="termsAndConsitionsFIModalPanel"/>-->
		            	<apex:actionFunction name="reRenderErrorMessagesTCModal" reRender="errorMessagesTCModal"/>
		            	<!--<apex:actionFunction name="reRenderErrorRequestLoading" reRender="requestLoading"/>-->
		            	<apex:actionFunction name="submitTCModal" action="{!createPortalAppRight}" reRender="requestLoading" oncomplete="if ({!currentErrorMessage != ''}) { enableTCModalButtons(); reRenderErrorMessagesTCModal(); } return false;"/>
		            	
			            <apex:commandButton styleClass="btn_iata_success btn" value="ola" onclick="showTermsAndConditionsModal(); return false;" reRender="" rendered="{!NOT(hasGDIAppRight)}"/>

					    <div class="modal" id="termsAndConsitionsFIModal" tabindex="-1" role="dialog">
					    	<apex:outputPanel layout="block" id="myModalContent"> 
						      	<div class="modal-dialog" role="document">
						        	<div class="modal-content">
						          		<div class="modal-header">
						            		<button id="tcModalCloseButtonSecondary" type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="hideTermsAndConditionsModal();">&times;</button>
						            		<h4 class="modal-title">Terms and Conditions</h4>
						          		</div>
						          		<div class="modal-body">
						          			<apex:outputPanel id="errorMessagesTCModal"> 
								                <div class="alert alert-danger" style="display:{!IF(currentErrorMessage == '','none','')}">
								                  	<strong>{!$Label.ISSP_Error}</strong>
								                  	<!--<apex:repeat value="{!errorMessage}" var="er" id="theRepeat">-->
								                      	<p><apex:outputText value="{!currentErrorMessage}" escape="false"/></p>
								                  	<!--</apex:repeat>-->
								                </div>
								            </apex:outputPanel>
						            		<p>
						            			<b>
						              				<apex:outputText value="By applying for your Accreditation Security to be provided to IATA by Euler Hermes, you consent to IATA sharing with Euler Hermes information it holds which is relevant to your financial standing, whether obtained directly from you when applying for IATA Accreditation or which IATA has maintained throughout your period of membership of IATA"/>
						            			</b>
						            		</p>
						            		<p>
						            			<apex:inputCheckbox id="tcModalAgreeCheckbox" value="{!termsAndConditions}" onchange="changeContinueButtonState();" required="true" selected="{!termsAndConditions}"/>
						            			<apex:outputText value="&nbsp;I agree" escape="false"/>
						            		</p>
						            		<apex:outputPanel id="requestLoading">
						            			<div style="text-align: center; display:{!IF(gdiPolling,'','none')}">
						            				<apex:actionPoller id="provisioningPoller" action="{!pollingStatus}" reRender="requestLoading, errorMessagesTCModal" interval="5" enabled="{!gdiPolling}" oncomplete="if(!{!gdiPolling}) { enableTCModalButtons(); }"/>
						         	 				<img src="{!URLFOR($Resource.IataLoadingImage)}"/><br/>
						         	 				<b>{!$Label.ANG_ISSP_UserProvisioningWait}</b>
						         	 			</div>
						            		</apex:outputPanel>
						         	 	</div>
						         	 	<div class="modal-footer">
						         	 		<apex:commandButton id="tcModalConfirmButton" styleClass="btn_iata_success btn" value="Continue" onclick="disableTCModalButtons(); submitTCModal(); return false;" reRender=""/>
						         	 		<apex:commandButton id="tcModalCloseButton" styleClass="btn btn-secondary" value="Close" onclick="hideTermsAndConditionsModal(); return false;" reRender=""/>
									    </div>
						        	</div>
						      	</div>
					      	</apex:outputPanel>
					    </div>
			    	</apex:form>
  				</div>
  			</div>
  			<c:ISSP_CustomFooter />
  		</body>
  	</html>
</apex:page>