<apex:page controller="ISSP_LocalGroups" action="{!init}" standardStylesheets="false" showHeader="false" sidebar="false"  applyBodyTag="false" applyHtmlTag="false">
<html>
    <c:ISSP_Header communityName="{!communityName}"></c:ISSP_Header>

    <script src="{!URLFOR($Resource.DataTables,'DataTables-1.10.15/js/jquery.dataTables.min.js')}"/>
    <script src="{!URLFOR($Resource.DataTables,'DataTables-1.10.15/js/dataTables.bootstrap.min.js')}"/>
    <script src="{!URLFOR($Resource.DataTables,'DataTables-1.10.15/extensions/Responsive/js/dataTables.responsive.min.js')}"/>
    <script src="{!URLFOR($Resource.DataTables,'DataTables-1.10.15/extensions/Responsive/js/responsive.bootstrap.min.js')}"/>
    <link rel="stylesheet" href="{!URLFOR($Resource.ISSP_LocalGroups, '/css/main.css')}"/>

<script>
  $(document).ready( function () {
    // init datatable
    var tbl = $('.table-pagination').DataTable({
      "bSort" : false,
      "dom": '<"top">rt<"bottom"lp><"clear"i>',
      "language": {
              "lengthMenu": "{!$Label.ISSP_Display_Records_per_page}",
              "zeroRecords": "{!$Label.ISSP_Nothing_found}",
              "info": "{!$Label.ISSP_Showing_page}",
              "infoEmpty": "{!$Label.ISSP_No_records_available}",
              "infoFiltered": "{!$Label.ISSP_filtered_from_total_records}",
              "search": "{!$Label.ISSP_Search}",
              "paginate": {
                "next": "{!$Label.ISSP_Next}",
                "previous": "{!$Label.ISSP_Previous}"
              }
          }
    });
    // search box
    $('#table-pagination-search').keyup(function() {
        tbl.search( this.value ).draw();
    } );
    
    // add filters only for certain columns
    $('.table-pagination thead th.headerRowFilter').each( function (i) {
        if ([0,1,2,3,4].indexOf(i)>-1) {
            var title = $('th.headerRow')[i].textContent;
            var select = $('<select class="select-filter" data-index="'+i+'"></select>');
            //var select = $('<select class="selectpicker" data-style="btn-primary" data-index="'+i+'"></select>');
            select.append( '<option value="" selected>' + title + '</option>' )
            // get all distinct values and creates an option value
            tbl.column(i).data().unique().sort().each( function ( d, j ) {
                select.append( '<option value="'+d+'">'+d+'</option>' )
            } );
            $(this).html( select );
        }
    } );
    // add filter event
    $(".select-filter").on( 'change', function () {
        if ($(this).val()=='') {
            tbl
                .column( $(this).attr("data-index"))
                .search( '' )
                .draw();
        } else {
            tbl
                .column( $(this).attr("data-index"))
                .search( '^'+$(this).val()+'$', true, false )
                .draw();
        }
    } );
  });
</script>

<body>

    <div class="container">
        <c:ISSP_CustomNavigation communityName="{!communityName}"/>

        <apex:form id="mainForm">
            <apex:pageMessages />

            <div class="row">
                <div class="col-xs-12 service-header">
                    <div class="row">&nbsp;</div>
                    <div class="row ">
                        <div class="col-xs-10 page-title">
                            {!$Label.ISSP_Local_Groups_Industry_Title}
                        </div>
                        <div class="col-xs-2">
                            <apex:outputLink styleclass="header-link-right" value= "{!URLFOR($Page.ISSP_LocalGroupsCSV)}">
                                {!$Label.ISSP_Local_Groups_Export_CSV}
                            </apex:outputlink>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12 page-subtitle">
                            {!$Label.ISSP_Local_Groups_Industry_Description}
                        </div>
                    </div>
                    <div class="row">&nbsp;</div>
                    <div class="row">&nbsp;</div>
                    <div class="row">&nbsp;</div>
                    <div class="row">&nbsp;</div>
                    <div class="row">
                        <div class="col-xs-9">
                        </div>
                        <div class="col-xs-3 row-buttons">
                            <input id="table-pagination-search" class="form-control" onkeypress="enterKey(event);" placeholder="{!$Label.ISSP_Search}" type="text"/>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MAIN TABLE  -->
            <div id="table-container">
            <table class="table table-condensed table-pagination">
                <thead>
                    <tr class="headerRowFilter">
                        <apex:repeat value="{!listFieldName}" var="fieldname">
                            <th class="headerRowFilter"></th>
                        </apex:repeat>
                    </tr>
                    <tr class="headerRow">
                        <apex:repeat value="{!listFieldName}" var="fieldname">
                            <th class="headerRow">
                                <apex:outputText value="{!$ObjectType.Participant__c.fields[fieldname].label}" rendered="{!AND(fieldName!='Contact__c',fieldName!='Country__c')}"/>
                                <apex:outputText value="{!$Label.ISSP_Local_Groups_Country}" rendered="{!fieldname=='Country__c'}"/>
                                <apex:outputText value="{!$Label.ISSP_Local_Groups_Contact_Name}" rendered="{!fieldName=='Contact__c'}"/>
                            </th>
                        </apex:repeat>
                    </tr>
                </thead>
                <tbody>
                    <apex:repeat value="{!listParticipant}" var="item">
                      <tr>
                        <apex:repeat value="{!listFieldName}" var="fieldname">
                            <td>
                                <apex:outputText value="{!item[fieldname]}" rendered="{!AND(fieldName!='Contact__c',fieldName!='Country__c',fieldName!='Local_Group_Type__c')}"/>
                                <apex:outputText value="{!item.Local_Governance__r.Local_Governance_type__c}" rendered="{!fieldName=='Local_Group_Type__c'}"/>
                                <apex:outputText value="{!item.Local_Governance__r.Country__r.Name + item.Local_Governance__r.Cluster__r.Name}" rendered="{!fieldName=='Country__c'}"/>
                                <apex:outputLink value="/ISSP_Contact?id={!item.Contact__c}&mid=M4S1" rendered="{!fieldName=='Contact__c'}">{!item.Contact__r.Name}</apex:outputLink>
                            </td>
                        </apex:repeat>
                      </tr>
                    </apex:repeat>
                </tbody>
            </table>
            </div>
        </apex:form>

        <c:ISSP_CustomFooter communityName="{!communityName}"/>
    </div><!-- end container-->

</body>
</html>
</apex:page>