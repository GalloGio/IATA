<apex:page showHeader="false" sidebar="false" applyHtmlTag="fasle" applyBodyTag="false" standardStylesheets="false" renderAs="pdf" controller="AMS_CertificateForPrintController">
	<html>
	<head>
		<title>Certificate</title>

		<style>
			@page{
				size: A4 landscape;
				margin:2cm 0.5cm 1.5cm;
			}

			html, body{
				height: 100%;
				font-family: Arial, sans-serif;
				margin: 0;
				padding: 0;
			}

			.certificate-page{
				/*page-break-before:always;*/
				position: relative;
				height: 100%;
				text-align: center;

			}
			.certificate{
				position: absolute;
				top: 50%;
				width: 100%;
				height: 200px;
				margin-top: -100px; 

				vertical-align: middle;
				font-size: 45px;
				font-style: italic;
			}

			h1{
				font-size: 1em;
				margin: 0;
				font-weight: bolder;
			}
			h1 span{
				display: block;
				font-size: 0.8em;
			}
			h1 .address{font-weight: normal;}
			p{
				margin: 0;
				font-size: 1.5em;
				color: #bbb;
				font-weight: bold;
				font-style: normal;
			}
		</style>
	</head>
	<body>
		<apex:repeat value="{!certificates}" var="page">
		<apex:repeat value="{!page}" var="acc">
		<div class="certificate-page">
			<div class="certificate">
				<h1>
					<span class="iata-code">
						<apex:outputText value="{0}-{1} {2} {3}" rendered="{!AND(acc.Location_Class__c <> 'C', acc.Location_Class__c <> 'R', acc.Location_Class__c <> 'I', acc.Location_Class__c <> 'Q')}">
							<apex:param value="{!LEFT(acc.IATACode__c, 2)}"/>
							<apex:param value="{!RIGHT(LEFT(acc.IATACode__c, 3), 1)}"/>
							<apex:param value="{!RIGHT(LEFT(acc.IATACode__c, 7), 4)}"/>
							<apex:param value="{!RIGHT(LEFT(acc.IATACode__c, 8), 1)}"/>
						</apex:outputText> 
						<apex:outputText value="{0}-{1} {2} {3} {4}" rendered="{!OR(acc.Location_Class__c == 'C', acc.Location_Class__c == 'R', acc.Location_Class__c == 'I', acc.Location_Class__c == 'Q')}">
							<apex:param value="{!LEFT(acc.IATACode__c, 2)}"/>
							<apex:param value="{!RIGHT(LEFT(acc.IATACode__c, 3), 1)}"/>
							<apex:param value="{!RIGHT(LEFT(acc.IATACode__c, 7), 4)}"/>
							<apex:param value="{!LEFT(acc.CASS_Number__c, 3)}"/>
							<apex:param value="{!acc.Check_Digit__c}"/>
						</apex:outputText> 
					</span>
					{!IF( acc.Region_formula__c == 'China & North Asia', acc.Name, IF(ISBLANK(acc.TradeName__c), acc.Name, acc.TradeName__c))}
					<span class="address"><apex:outputText value="{!acc.BillingCity & ', '}" rendered="{!acc.Location_Class__c == 'P'}" /> <apex:outputText value="{!acc.IATA_ISO_Country__r.Name}"/></span>
				</h1>
				<p>{!IF(ISBLANK($CurrentPage.Parameters.year), YEAR(TODAY()), $CurrentPage.Parameters.year)}</p>
			</div>
		</div>
		</apex:repeat>
		</apex:repeat>
	</body>
	</html>
</apex:page>