<apex:page standardController="EBC_Campaign__c" extensions="vfIECEBC_Campaign,vfIECEBC_CampaignRecipient" applyHtmlTag="false" applyBodyTag="false" sidebar="false" showheader="false" standardStylesheets="false" language="en" docType="html-5.0" action="{!pageLoad}">
	<apex:composition template="IECEBC_Layout">
        <apex:define name="pageHeadAdditions">
            <!-- Start of Page <head> -->
            <title>eBroadcast Campaign - Select recipients</title>
            <!-- End of Page </head> -->
        </apex:define>
        <apex:define name="pageScriptAdditions">
            <!-- If any page specific .js, add them here -->
        </apex:define>
        <apex:define name="pageContent">
            <!-- Start of Page Content -->
            <main class="main-content">
                <div class="inner-wrapper">
                    <c:IECEBC_ProgressComponent currentStepNumber="{!currentStepNumber}" campaign="{!EBC_Campaign__c}" />
            
                    <h1 class="page-title">Recipients</h1>
                    
                    <apex:form >
                        
                        <div class="footer-actions text-right">
                            <ul class="list actions">
                                <apex:outputText rendered="{!campaign.Is_Step2_Writable__c}">
	                                <li><apex:commandLink action="{!previous}" styleClass="button secondary" value="Previous" /></li>
                                </apex:outputText>
                                <apex:outputText rendered="{!campaign.Is_Step2_Writable__c}">
	                                <li><apex:commandLink action="{!saveAndExit}" reRender="pageMessagesBlock" styleClass="button secondary" value="Save and Exit" /></li>
                                </apex:outputText>
                                <apex:outputText rendered="{!campaign.Is_Step2_Writable__c}">
	                                <li><apex:commandLink action="{!saveAndContinue}" reRender="pageMessagesBlock" styleClass="button" value="Save and Continue" /></li>
                                </apex:outputText>
                                <apex:outputText rendered="{!NOT(campaign.Is_Step2_Writable__c)}">
	                                <li><apex:commandLink action="{!previous}" value="Previous" styleClass="button secondary" /></li>
                                </apex:outputText>
                                <apex:outputText rendered="{!NOT(campaign.Is_Step2_Writable__c)}">
	                                <li><apex:commandLink action="{!next}" value="Next" styleClass="button" /></li>
                                </apex:outputText>
                            </ul>
                        </div>
                    </apex:form>
                    
                    
                    <apex:outputText id="recipientsCount" />
                    
                    <a href="#" onclick="updateRecipientsCount('{!$Component.recipientsCount}'); return false;">Refresh count</a>
                    <script type="text/javascript">
                    	function updateRecipientsCount(elementId) {
                            var script = document.createElement('script');
                            script.src = "{!$Page.IECEBC_CampaignRecipientsCnt}?elementId=" + elementId
                            
                            document.getElementsByTagName('head')[0].appendChild(script);
                        }
                    </script>
                    
                </div>
            </main>
            <!-- End of Page Content -->
        </apex:define>
    </apex:composition>
</apex:page>