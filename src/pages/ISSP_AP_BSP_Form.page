<apex:page controller="ISSP_APProcess" showHeader="false" sidebar="false" standardStylesheets="true" applyBodyTag="false" applyHtmlTag="false">
    <c:iss_ap_css />
     
    <script>
    function hideTextECCB(myValue){
        var theValue = document.getElementById(myValue).value; 
        if (theValue == 'Yes'){
            document.getElementById('merchantnumbers').style.display='block';
            document.getElementById('noECCB').style.display='none';
            
        }
        else{
            document.getElementById('merchantnumbers').style.display='none';
            document.getElementById('noECCB').style.display='block';
        }
    }
    
    function changePercentBox(myBox, myCheckBox, myPanel){
        var thisBox = document.getElementById(myBox);
        var thisCheckBox = document.getElementById(myCheckBox);
        var thisPanel = document.getElementById(myPanel);
        if (thisCheckBox.checked == true){
            thisPanel.style.display='block';
        }
        else{
            thisPanel.style.display='none';
            thisBox.value = '';
        }
    }
   
    function onlyNumbers(event) {
        var event = event || window.event; // for trans-browser compatibility
        var charCode = event.which || event.keyCode;
     
        if (charCode > 31 && (charCode < 37 || charCode > 57))
            return false;

        return true;                
    }
    
    function checkPercentage(box){
        var thisBox = document.getElementById(box);
        var value = thisBox.value
        value = value.replace(/,/g, ".");
        value = parseFloat(value);
        if (isNaN(value)){
            value = "";
        }
        else if (value < 0){
            value = 0;
        }
        else if (value > 100){
            value = 100;
        }
        thisBox.value = value;
    }
    
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })
    </script>
    
    <!-- Modal -->
<div class="modal fade" id="ModalCountryReqs" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">{!strLOB} {!apcountry} - Country Requirements</h4>
      </div>
      <div class="modal-body">
        <apex:panelGrid columns="3" styleClass="countryReqsGrid" rowClasses="whiterow,bluerow" columnClasses="col1,col2,col3">
                        
                        <!-- Local Representation Mandatory -->
                        <apex:outPutText value="Local representation mandatory:"/>
                        <apex:outputField value="{!countryRequirement.Local_Representation_Mandatory__c}" />
                        <apex:outPutField value="{!countryRequirement.Local_Representation_Mandatory_com__c}"/>
                        
                        <!-- Does the airline need to have a local accountant or any kind of 3rd party for taxation issues? -->
                        <apex:outPutText value="Local accountant mandatory:"/>
                        <apex:outPutField value="{!countryRequirement.Local_accountant_mandatory__c}" />
                        <apex:outPutField value="{!countryRequirement.Local_accountant_mandatory_com__c}"/>
                        
                        <!-- Local VAT (or any equivalent to VAT like GST, RUC, RUT, NIT) mandatory?  -->
                        <apex:outPutText value="Local VAT (or equivalent such as GST, RUC, RUT, NIT) mandatory:"/>
                        <apex:outPutField value="{!countryRequirement.Local_VAT_Mandatory__c}" />  
                        <apex:outPutField value="{!countryRequirement.Local_VAT_Mandatory_com__c}"/>
                        
                        <!-- Foreign VAT accepted? (eg: Home country VAT of the airline)  -->
                        <apex:outPutText value="Foreign VAT accepted:"/>
                        <apex:outPutField value="{!countryRequirement.Foreign_VAT_accepted__c}" />            
                        <apex:outPutField value="{!countryRequirement.Foreign_VAT_accepted_com__c}"/>
                        
                        <!-- Can an airline have a special VAT status (or any special taxation status)? -->
                        <apex:outPutText value="Airline can have a special VAT status:"/>    
                        <apex:outPutField value="{!countryRequirement.Special_VAT_status_allowed__c}" />
                        <apex:outPutField value="{!countryRequirement.Special_VAT_status_allowed_com__c}"/>
                        
                        <!-- Does the airline need to have a Local Representation for Fiscal requirements? -->
                        <apex:outPutText value="Airline needs Local Representation for Fiscal requirements:"/>
                        <apex:outPutField value="{!countryRequirement.Local_Representation_for_Fiscal_requirem__c}"/>
                        <apex:outPutField value="{!countryRequirement.Local_Representation_for_Fiscal_req_com__c}"/>
                        
                        <!-- Currency of the Settlement which must be the same as of the bank account in case the airline select as settlement mode: Local Bank Mandate -->
                        <apex:outPutText value="Currency of the Settlement must be the same as the bank account in case airline selects settlement mode:"/>
                        <apex:outPutField value="{!countryRequirement.Currency_of_the_Settlement__c}"/>
                        <apex:outPutField value="{!countryRequirement.Currency_of_the_Settlement_com__c}"/>
                        
                        <!-- Does this operation have dual currencies? -->
                        <apex:outPutText value="Operation has dual currencies:"/>
                        <apex:outPutField value="{!countryRequirement.Dual_currencies__c}"/>
                        <apex:outPutField value="{!countryRequirement.Dual_currencies_com__c}"/>
                        
                        <!-- Can any airline (regardless of having a local representation or not) open a local bank account in the currency of the settlement? -->
                        <apex:outPutText value="Airline can (regardless of local representation or not) open a local bank account in the settlement currency:"/>
                        <apex:outPutField value="{!countryRequirement.bank_account_in_of_the_settlement__c}"/>
                        <apex:outPutField value="{!countryRequirement.bank_account_in_of_the_settlement_com__c}"/>
                        
                        <!-- Is it legally mandatory for the airlines to give commission to agencies? -->
                        <apex:outPutText value="Legally mandatory for airlines to give commission to agencies:"/>
                        <apex:outPutField value="{!countryRequirement.Mandatory_to_give_commission_to_agencies__c}"/>
                        <apex:outPutField value="{!countryRequirement.Mandatory_to_give_commission_to_agen_com__c}"/>
                        
                        <!-- Are there any government requirements that are included in the joining package? -->
                        <apex:outPutText value="Government requirements are included in the joining package:"/>
                        <apex:outPutField value="{!countryRequirement.Government_requirements__c}"/>
                        <apex:outPutField value="{!countryRequirement.Government_requirements_com__c}"/>
                        
                        <!-- Which type of address is accepted  inserted into ISS systems (BSPLink, CASSLink etc..)? -->
                        <apex:outPutText value="Which type of address is accepted, inserted into ISS systems (BSPLink, CASSLink etc..):"/>   
                        <apex:outPutField value="{!countryRequirement.Type_of_address_accepted__c}"/>
                        <apex:outPutField value="{!countryRequirement.Type_of_address_accepted_com__c}"/>
                        
                        <!-- VAT no. always inserted into ISS systems? (BSPLink, Casslink etc..) -->
                        <apex:outPutText value="VAT no. is always inserted into ISS systems (BSPLink, Casslink etc..:"/>
                        <apex:outPutField value="{!countryRequirement.VAT_no_always_inserted_into_ISS_systems__c}"/>
                        <apex:outPutField value="{!countryRequirement.VAT_no_always_ins_into_ISS_systems_com__c}"/>
                        
                        <!-- General Commment -->
                        <apex:outPutText value="General Comment - {!StrLOB} {!apcountry}"/>
                        <apex:outPutText escape="false" value="&nbsp;"/>
                        <apex:outPutField value="{!countryRequirement.Comments__c}"/>
                    </apex:panelGrid>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="pageNav" style="display:{!IF(isStep3&&isBSP,'inline-block','none')}">
        <p class="LOB">{!strLoB}</p>
        <div style="border-top: 1px #fff dotted; padding-bottom: 3px;">
            <p>JUMP TO:</p>
        </div>
        <p><a href="#top">Top</a></p>
        <p><a href="#nav_one">1.Participation</a></p>
        <p><a href="#nav_two">2.Airline info</a></p>
        <p><a href="#nav_three">3.Contact info</a></p>
        <p><a href="#nav_four">4.Subscriptions</a></p>
        <p><a href="#nav_five">5.Credit Card</a></p>
        <apex:outputLink value="#nav_six" rendered="{!OR(apcountryisocode='BR',apcountryisocode='AR',apcountryisocode='MX',apcountryisocode='CA',apcountryisocode='CO')}">6. Additional Info</apex:outputLink>
        <div style="border-top: 1px #fff dotted; padding-top: 5px; padding-bottom: 5px;">
            <a data-toggle="modal" data-target="#ModalCountryReqs" href="#">Country Requirements</a>
        </div>
    </div>
    
     <div class="panel-primary">
            <div class="panel-heading head_panel_green">
                <h3 class="panel-title">Airline Participation Joining Process</h3>
            </div>
    <div class="panel-body" id="body-enquiries">
        <div class="progress">
            <div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" style="width: 25%;">
            A. Participation Country &amp; Type
            </div>
            <div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="0" style="width: 25%;">
            B. {!strLoB} Country Requirements
            </div>
            <div class="progress-bar" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 25%;">
            C. BSP Joining Form
            </div>
            <div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 25%;">
            D. Submit to IATA
            </div>
        </div>
        
        <apex:form id="BSPForm" styleClass="inline">
            <apex:pageBlock mode="edit">
            
            <apex:pageBlockButtons id="blockButtons" >
                <apex:commandButton action="{!saveBSPFormAndGoBack}" value="Previous" rerender="loadStatusSpinner" status="loadStatusSpinner"/>&nbsp;
                <apex:commandButton action="{!saveBSPFormAndGoForward}" value="Next"  rerender="loadStatusSpinner" status="loadStatusSpinner"/>                
                <apex:commandButton styleclass="apbutton" action="{!saveBSPFormAndLeave}" value="Save Draft and Leave" rerender="loadStatusSpinner" status="loadStatusSpinner" style="float:right"/>
            </apex:pageBlockButtons>
            <apex:pageMessages />
            <div class="apcontainer">
               <apex:pageBlockSection title="Thank you for your interest in expanding your IATA {!strLoB} participation" columns="1" >  
                    <apex:facet name="header">
                        <apex:outputpanel >
                            <apex:outputText style="font-weight:bold;font-size:15px;float:left;" value="Thank you for your interest in expanding your IATA {!strLoB} participation"/>
                        </apex:outputpanel>
                    </apex:facet>           
                    <apex:outputText >
                        <div class="aplabel">This form must be fully completed and submitted on-line.</div>
                        <div class="aplabel" style="margin: 5px 0px 10px 0px">By agreeing with the Terms and Conditions, the Airline representative submitting this form confirms that they are authorized to do so and accepts the charges and fees related to the Airline  participation in IATA Settlement Systems as per the applicable Passenger and/or Cargo Agency Resolutions.</div>
                        
                        <div style="color:#a31717; font-weight:bold; margin:20px 0px 10px 0px;border: 0px !important;">Note: the fields marked in red and with a "*" are required before you can submit your application.<br/>However, you can save the incomplete draft application and come back later to fill all the required fields before submitting it to IATA.</div>
                    </apex:outputText>
                </apex:pageBlockSection>
                <span id="nav_one"></span>
                
                <apex:pageBlockSection columns="2">
                    <apex:facet name="header">
                            1. Participation in BSP  
                    </apex:facet>
                    <tr><td colspan="4" class="aplabel">BSP Country your Airline wishes to participate in: <span style="font-size: 110%;">{!newCase.BSPCountry__c}</span></td></tr>
                     <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                         <apex:pageBlockSectionItem >
                            <apex:outputLabel value="* Desired commencement date" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputField value="{!newForm.Desired_commencment_date__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="* Type of participation desired" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputField value="{!newForm.Type_of_participation_desired__c}" />
                        </apex:pageBlockSectionItem>
                    
                    <tr><td colspan="4" class="aplabel">Contact person responsible for this {!strLoB} application</td></tr>
                     
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Social Title" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField required="{!isMandatory}" value="{!newForm.Contact_Resp_Salutation__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* First Name" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Contact_Resp_F_Name__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Last Name" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Contact_Resp_L_Name__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Email" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Contact_Resp_Email__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Job Title" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Contact_Resp_Job_Title__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Phone" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Contact_Resp_Phone__c}" />
                    </apex:pageBlockSectionItem>
                     
                </apex:pageBlockSection>
                
                <span id="nav_two"></span>
                   <apex:pageBlockSection columns="2">
                    <apex:facet name="header">
                        <apex:outputpanel >
                            2. Airline information
                        </apex:outputpanel>
                    </apex:facet>
                    <apex:outputText label="Legal Name of the Airline" value="{!strParentLegalName}"/>
                    <apex:outputText label="Airline trade name" value="{!strParentTradeName}"/>
                    
                    <apex:outputText label="Airline Designator Code (2 character code)" value="{!strParentDesignator}"/>
                    <apex:outputText label="Airline Prefix Code (3 digit code)" value="{!strParentIATACode}"/>
                    
                    <apex:outputText value="{0}<br/>{1}<br/>{2}" escape="false" label="Airline Registered Head Office Address">
                        <apex:param value="{!strParentBillingStreet}"/>
                        <apex:param value="{!strParentBillingCity},&nbsp;{!strParentBillingCode}"/>
                        <apex:param value="{!strParentBillingState},&nbsp;{!strParentBillingCountry}"/>
                    </apex:outputText>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Is your Airline registered in {!apcountry} under a different name?" />
                        <apex:outputPanel >
                            <apex:inputField value="{!newForm.Airline_Registered_under_other_name__c}" />
                            <apex:image value="/img/msg_icons/info16.png" title="If YES, please provide your Airline's local name in {!apcountry}" html-data-placement="right" html-data-toggle="tooltip"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                         
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="VAT/Tax number in your home country" for="vathomeno" />
                         <apex:inputText id="vathomeno" value="{!newForm.VAT_Tax_number_in_your_home_country__c}" />
                    </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem rendered="{!NOT(OR(apcountryisocode='BR',apcountryisocode='EC',apcountryisocode='MX',apcountryisocode='VE'))}">
                            <apex:outputLabel value="VAT/Tax number in BSP {!apcountry}" for="vatbspno" />
                            <apex:inputText id="vatbspno" value="{!newForm.BSP_Country_VAT_Tax_number__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem rendered="{!OR(apcountryisocode='EC',apcountryisocode='VE')}">
                            <apex:outputLabel value="{!CASE(apcountryisocode, 'EC', '* Your airlines VAT/RUC Number', '* Please provide the Registro Informacion Fiscal (RIF) information')}" for="vatrut" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputText id="vatrut" value="{!newForm.BSP_Country_VAT_Tax_number__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem rendered="{!NOT(OR(apcountryisocode='BR',apcountryisocode='CR',apcountryisocode='MX',apcountryisocode='IT'))}">
                            <apex:outputLabel value="Please specify other TAX Identification" />
                            <apex:inputField value="{!newForm.Other_TAX_Identification__c}" />
                        </apex:pageBlockSectionItem>
                    
                        <apex:pageBlockSectionItem rendered="{!OR(apcountryisocode='IT',apcountryisocode='CR')}">
                            <!-- <apex:outputLabel value="{!CASE(apcountryisocode, 'IT', '* Italian Fiscal code', '* Please indicate your airline&apos;s Fiscal ID c?dula juridica')}" for="othertaxid" style="color:#a31717; font-weight: bold !important;"/> -->
                            <apex:outputLabel value="{!CASE(apcountryisocode, 'IT', '* Italian Fiscal code', '* Please indicate your airline\'s Fiscal ID c?dula juridica')}" for="othertaxid" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputText id="othertaxid" value="{!newForm.Other_TAX_Identification__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem rendered="{!OR(apcountryisocode='EC',apcountryisocode='VE')}">
                            <apex:outputLabel for="contribtype" value="* Type of Contributor {!CASE(apcountryisocode, 'EC', '(RUC)', '(RIF)')} applicable to your Airline" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputField id="contribtype" value="{!newForm.Airline_s_Fiscal_Status__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem rendered="{!apcountryisocode='CO'}">
                            <apex:outputLabel for="rutname" value="* Name appearing in the RUT" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputField id="rutname" value="{!newForm.Name_Appearing_in_VAT__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem rendered="{!apcountryisocode='CO'}">
                            <apex:outputLabel for="COLcontribtype" value="* Type of Contributor applicable to your Airline" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputField id="COLcontribtype" value="{!newForm.Colombia_Type_of_Contributor__c}" />
                        </apex:pageBlockSectionItem> 
                        
                        <apex:pageBlockSectionItem rendered="{!apcountryisocode='CY'}">
                            <apex:outputLabel for="turkeybased" value="* Please advise if your airline is a Turkey based Airline" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputField id="turkeybased" value="{!newForm.Cyprus_Turkey_based_Airline__c}" />
                        </apex:pageBlockSectionItem>
                    <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                       
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel for="onlinecarrier" value="Is your airline an online carrier in BSP {!apcountry}?" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:outputPanel >
                            <apex:inputField id="onlinecarrier" value="{!newForm.Online_carrier_in_the_BSP_country__c}" />
                            <apex:image value="/img/msg_icons/info16.png" title="<u>Online carrier:</u> Airline operates scheduled air services within the country/area of the BSP. <br/><u>Offline carrier:</u> Airline does not operate scheduled air services within the country/area of the BSP" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel for="bspflights" value="Please indicate the flights the airline operates in BSP {!apcountry}" />
                         <apex:inputField id="bspflights" value="{!newForm.Flights_operated_in_the_BSP_country__c}" />
                    </apex:pageBlockSectionItem>
                    
                    <tr><td colspan="4" class="aplabel">Airline local address in BSP {!apcountry}</td></tr>
                    <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel for="aladdress" value="Address" />
                            <apex:inputField id="aladdress" value="{!newForm.BSP_Local_address__c}" />
                        </apex:pageBlockSectionItem>
                        <apex:outputText ><!--empty: move following field to next row --></apex:outputText> 
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel for="zip" value="Zip code" />
                             <apex:inputText id="zip" value="{!newForm.BSP_Local_Zip_Code__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel for="city" value="City" />
                            <apex:inputField id="city" value="{!newForm.BSP_Local_City__c}" />
                        </apex:pageBlockSectionItem>
                    </apex:pageBlockSection>
                    
                <span id="nav_three"></span>
                <apex:pageBlockSection title="3. Contact Information" columns="2">
                    <apex:facet name="header">
                        <apex:outputpanel >
                            3. Contact Information
                        </apex:outputpanel>
                    </apex:facet>
                
                    <tr>
                        <td colspan="4" class="aplabel">            
                            In this section we need the different contacts to communicate to our stakeholders. Having the right contact will benefit the Airline and IATA in future communications.
                        </td>
                    </tr>
                    <tr><td colspan="4" style="padding-top:10px;"><strong>Contact Data</strong> - <mark>to be communicated to ETSP (E-Ticketing Service Provider)</mark></td></tr>
                <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel for="etspsalutation" value="* Social title" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputField id="etspsalutation" value="{!newForm.ETSP_Contact_Salutation__c}" />
                        </apex:pageBlockSectionItem>
                        <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="* First Name" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputField value="{!newForm.ETSP_Contact_F_Name__c}" label=""/>
                        </apex:pageBlockSectionItem>    
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="* Last Name" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputField value="{!newForm.ETSP_Contact_L_Name__c}" label=""/>
                        </apex:pageBlockSectionItem>    
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="* Job Title" style="color:#a31717; font-weight: bold !important;"/>
                            <apex:inputField value="{!newForm.ETSP_Contact_Job_Title__c}" label=""/>
                        </apex:pageBlockSectionItem>    
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Physical Address" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.ETSP_Contact_Address__c}" />
                    </apex:pageBlockSectionItem>    
                    
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Email Address" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.ETSP_Contact_Email__c}" />
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Phone number" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.ETSP_Contact_Phone__c}" html-placeholder="with country code"/>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Fax"/>                
                        <apex:inputField value="{!newForm.ETSP_Contact_Fax__c}" html-placeholder="with country code"/>
                    </apex:pageBlockSectionItem>
                    <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                        
                   <tr><td colspan="4" style="padding-top:10px;"><strong>Finance / Administration Contact Person &amp; Title</strong> - <mark>to appear in BSPLink master table</mark></td></tr>
                    <apex:outputText ><!--empty: move following field to next row --></apex:outputText> 
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Social Title" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Fin_Adm_Contact__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:outputText ><!--empty: move following field to next row --></apex:outputText> 
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* First Name" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Fin_Adm_Contact_F_Name__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Last Name" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Fin_Adm_Contact_L_Name__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Job Title" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Fin_Adm_Contact_Job_Title__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Phone number" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Fin_Adm_Contact_Phone__c}" html-placeholder="with country code" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Email Address" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Fin_Adm_Contact_Email__c}" />
                    </apex:pageBlockSectionItem>         
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Physical Address" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:outputPanel >
                            <apex:inputField value="{!newForm.Fin_Adm_Contact_Address__c}" />
                            <apex:image style="vertical-align:top; margin-left:3px" value="/img/msg_icons/info16.png" title="Enter a local address if this is required in the country requirements. To appear on billing reports." html-data-html="true" html-data-placement="right" html-data-toggle="tooltip"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Zip Code" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Fin_Adm_Contact_Zip_Code__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* City" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Fin_Adm_Contact_City__c}" />
                    </apex:pageBlockSectionItem>                
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Country" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:selectList style="width:300px" value="{!newForm.Fin_Adm_Contact_Country__c}" required="false" size="1">
                            <apex:selectOptions value="{!items}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                    
                    <tr><td colspan="4" style="padding-top:10px;"><strong>{!bspLinkContact} Contact details</strong> - <mark>To appear as registered user in {!bspLinkContact} and for contact details in ADMs/ACMs. If not provided, Finance details will appear.</mark></td></tr>
                    <apex:outputText ><!--empty: move following field to next row --></apex:outputText> 
                    <apex:inputField value="{!newForm.BSPLink_ASD_China_Contact__c}" label="First Name"/>
                    <apex:inputField value="{!newForm.BSPLink_ASD_China_Contact_L_Name__c}" label="Last name"/>
                    <apex:inputField value="{!newForm.BSPLink_ASD_China_Contact_Phone__c}" label="Phone Number"/>
                    <apex:inputField value="{!newForm.BSPLink_ASD_China_Contact_Email__c}" label="E-mail address"/>
                </apex:pageBlockSection>
                
                <span id="nav_four"></span>
                <apex:pageBlockSection title="4. Product Subscriptions" columns="2">
                    <apex:facet name="header">
                        <apex:outputpanel >
                            4. Product Subscriptions
                        </apex:outputpanel>
                    </apex:facet>
                    
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Does your Airline wish to receive HOT files?" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Receive_HOT_files__c}" />
                    </apex:pageBlockSectionItem>            
                    <apex:inputField value="{!newForm.Hot_files_delivery_format__c}" label="If YES, please specify delivery format"/>
                    
                    <apex:pageBlockSectionItem helpText="Must be 4 chars in length">
                        <apex:outputLabel value="If iiNET please provide your account number"/>
                        <apex:inputField value="{!newForm.IINET_account_number__c}"/>
                    </apex:pageBlockSectionItem>  
                    
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* What BSPlink access level does your Airline require?" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:outputPanel >
                             <apex:inputField value="{!newForm.BSPLink_access_level_requested__c}" />
                            <apex:image value="/img/msg_icons/info16.png" title="Please let us know if you are interested in HOMU access by adding a case comment to the associated case after submitting your application (accessible in My Cases area)." html-data-html="true" html-data-placement="right" html-data-toggle="tooltip"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Does your Airline wish to participate in any Commission Control?" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:outputPanel >
                            <apex:inputField value="{!newForm.Participate_in_any_Commission_Control__c}" />
                            <apex:image value="/img/msg_icons/info16.png" title="If YES please contact IATA for details" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Does your Airline wish to participate in any Net Remit scheme?" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:outputPanel >
                            <apex:inputField value="{!newForm.Participate_in_any_Remit_scheme__c}" />
                            <apex:image value="/img/msg_icons/info16.png" title="If YES please contact IATA for details" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>                
                </apex:pageBlockSection>
                
                <span id="nav_five"></span>
                <apex:pageBlockSection title="5. Credit Card Processing Information" columns="1">
                    <apex:facet name="header">
                        <apex:outputpanel >
                            5. Credit Card Processing Information
                        </apex:outputpanel>
                    </apex:facet>
                <tr class="aplabel">
                        <td colspan="2">Please complete this section if your airline accepts credit card transactions.
                            <div class="bg-info" style="margin-top:10px;">Please note that if you accept credit cards but do not wish to participate in the BSP ECCB, we will instruct our Data Processing Centre to send you a file to your BSPLink inbox. It will be your responsibility to send this information to your bank or credit card acquirer.
                            </div><br/></td>
                 </tr>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Does your Airline accept Payment Cards for BSP ticket issuance by Travel Agents?" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Accept_payment_Cards_for_BSP_ticket__c}" />
                    </apex:pageBlockSectionItem>                   
                   <apex:pageBlockSectionItem >
                       <apex:outputLabel value="Which Card brand does your Airline accept for BSP ticket issuance by Travel Agents?"/>
                       <apex:inputField value="{!newForm.Card_brand_accepted_for_BSP_ticket__c}" />
                   </apex:pageBlockSectionItem>          
                    <apex:inputField value="{!newForm.Other_Card_brand_accepted_for_BSP_ticket__c}" label="Other card brand"/>
                    </apex:pageBlockSection>
                    <apex:pageBlockSection >
                        <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Does your Airline wish to join BSP Electronic Credit Card Billing Scheme (ECCB), where BSP produces card clearing files and forwards them to your Acquirer or processor?" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.Join_BSP_ECCB__c}" label="" id="joinECCB" onchange="hideTextECCB('{!$Component.joinECCB}');"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!apcountryisocode='KR'}">
                        <apex:outputLabel value="* Does your Airline wish to participate in the local credit card billing and settlement scheme at this time?" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:outputPanel >
                            <apex:inputField value="{!newForm.Local_CC_Settlement_Scheme__c}"/>
                            <apex:image value="/img/msg_icons/info16.png" title="Participation in the local credit card scheme is optional. An Airline can choose to apply for the local credit card scheme at any time after the joining process." html-data-placement="right" html-data-toggle="tooltip"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    </apex:pageBlockSection>
                  
                <div id="noECCB" class="bg-warning" style="{!IF (newForm.Join_BSP_ECCB__c == 'No', 'border: 0px !important;', 'display:none')}">
                    Note! if NO, it will be the airline's sole responsibility to process any eventual credit card payment based on the DPC report (= HOT file if subscribed as indicated above).<br/>
                </div>
                <div class="aplabel" id="merchantnumbers" style="{!IF (newForm.Join_BSP_ECCB__c == 'Yes', 'border: 0px !important;', 'display:none')}">        
                    
                    <div>Please provide Merchant number for each card brand accepted and the name of your acquirer or processor to which BSP shall send the data for your card sales:</div>
                    
                    <apex:pageBlockSection title="" columns="2" showHeader="false">
                        <div class="aplabel">VISA (VI)</div>
                        <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                        <apex:inputField value="{!newForm.Visa_merchant_number__c}" label="Merchant Number"/>
                        <apex:inputField value="{!newForm.Visa_Name_of_Acquirer_or_Processor__c}" label="Name of Acquirer or Processor"/>
                        
                        <br/><div class="aplabel">American Express (AX)</div>
                        <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                        <apex:inputField value="{!newForm.American_Express_Merchant_Number__c}" label="Merchant Number"/>
                        <apex:inputField value="{!newForm.American_Express_Name_of_Acquirer__c}" label="Name of Acquirer or Processor"/>
                        
                        <br/><div class="aplabel">Diners (DC)</div>
                        <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                        <apex:inputField value="{!newForm.Diners_Merchant_Number__c}" label="Merchant Number"/>
                        <apex:inputField value="{!newForm.Diners_Name_of_Acquirer__c}" label="Name of Acquirer or Processor"/>
                        
                        <br/><div class="aplabel">Master Card (CA)</div>
                        <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                        <apex:inputField value="{!newForm.Master_Card_Merchant_Number__c}" label="Merchant Number"/>
                        <apex:inputField value="{!newForm.Master_Card_Name_of_Acquirer__c}" label="Name of Acquirer or Processor"/>
                    </apex:pageBlockSection>
                </div>
                
                <span id="nav_six"></span>
                <!-- BRAZIL / MEXICO - START -->
                <apex:pageBlockSection title="6. Additional Information - {!CASE(apcountryisocode, 'BR', 'Local VAT # (CNPJ - Certificado Nacional de Personas juridicas)', 'Local VAT - RFC #')}" rendered="{!OR(apcountryisocode='BR',apcountryisocode='MX')}">
                
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* {!CASE(apcountryisocode, 'BR','CNPJ', 'RFC')} # to be entered in IATA Systems" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:outputPanel >
                            <apex:inputField value="{!newForm.BSP_Country_VAT_Tax_number__c}" />
                            <apex:image value="/img/msg_icons/info16.png" title="{!CASE(apcountryisocode, 'BR', 'Format : XX.XXX.XXX/XXXX-XX. Must be that of the Bank Beneficiary Account Holder.', 'As per local law the RFC number (Local VAT no.) must correspond with the Local Fiscal Address of the Airline Participant and should be provided to IATA')}" html-data-html="true" html-data-placement="right" html-data-toggle="tooltip"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!apcountryisocode='BR'}">
                        <apex:outputLabel value="* Does the {!CASE(apcountryisocode, 'BR','CNPJ', 'RFC')} # provided correspond with the Bank Beneficiary Account Holder?" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.AP_BR_BankBeneficiary_Account_Holder__c}" />
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Address to be inserted in IATA systems" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.AP_BR_Address_To_Insert__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!apcountryisocode='BR'}">
                        <apex:outputLabel value="* Does the supplied address correspond with the CNPJ # provided?" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:inputField value="{!newForm.AP_BR_Address_CNP__c}" />
                        
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSection title="Please enclose" columns="1" rendered="{!apcountryisocode='BR'}">
                        1) A copy of the CNPJ Certification<br/>
                        2) The ANAC Authorization or Publication provided by the Offical Gazetta
                        
                        <apex:inputFile style="width:100%" id="fileToUpload" value="{!fileBody}" filename="{!fileName}" />
                        <apex:commandButton id="btnUpload" value="Upload File" action="{!UploadFile}" />
                    </apex:pageBlockSection>
                    
                    <!-- Attachment List -->
                    <apex:pageBlockSection title="Attachments" rendered="{!apcountryisocode='BR'}">
                        <apex:pageBlockTable value="{!attachList}" var="attach" >
                            <apex:column value="{!attach.Name}" />
                        </apex:pageBlockTable>
                    </apex:pageBlockSection>
                </apex:pageBlockSection>
                <!--  END OF Brazil / MEX  -->
                
                <!-- ARGENTINA - START -->
                <apex:pageBlockSection columns="2" rendered="{!apcountryisocode='AR'}">
                    <apex:facet name="header">
                            <apex:outputText style="font-weight:bold;font-size:15px;float:left;" value="6. Additional Information - Clave Bancaria Unificada (CBU)"/>    
                    </apex:facet>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* Please provide your CBU" style="color:#a31717; font-weight: bold !important;"/>
                        <apex:outputPanel >
                            <apex:inputField value="{!newForm.Clave_Bancaria_Unificada_CBU__c}" />
                            <apex:image value="/img/msg_icons/info16.png" title="The CBU, usually referred to as the Bank Code, consists of 22 digits and is mandatory for Airline settlements." html-data-placement="right" html-data-toggle="tooltip"/>
                        </apex:outputPanel>
                        
                    </apex:pageBlockSectionItem>
                    <apex:outputText ><!--empty: move following field to next row --></apex:outputText>
                    
                    <apex:pageBlockSection columns="1">
                        <apex:facet name="header">
                            Please provide copies of the following documents:
                        </apex:facet>
                        <apex:pageBlockSectionItem >   
                        a.  Permission granted by the Civil Aviation Authority (Administracion Nacional de Aviacion Civil  -- ANAC) for your Airline to operate regular flights in Argentina. If you are joining the BSP through a General Sales Agent (GSA), permission should be granted to the GSA, authorizing tickets sales in the country.<br/><br/>
                        b.  Fiscal ID registration number (Clave Unica de Identificacion Tributaria  -- CUIT) granted by the Fiscal Authority (AFIP).  If you are joining the BSP through a GSA, the GSA's fiscal ID number/CUIT will be accepted.<br/><br/>
                        c.  Registered in-laws and Power of Attorney to show your Airline's representation in Argentina.  If you are joining the BSP through a GSA, a copy of the GSA agreement must be presented.
                        </apex:pageBlockSectionItem>   
                            <apex:inputFile style="width:100%" id="fileToUpload" value="{!fileBody}" filename="{!fileName}" />
                            <apex:commandButton id="btnUpload" value="Upload File" action="{!UploadFile}" />
                        </apex:pageBlockSection>
                    
                    <!-- Attachment List -->
                    <apex:pageBlockSection columns="1">
                        <apex:facet name="header">
                            Attachments
                        </apex:facet>
                            <apex:pageBlockTable value="{!attachList}" var="attach" >
                                <apex:column value="{!attach.Name}" />
                            </apex:pageBlockTable>
                    </apex:pageBlockSection>
                </apex:pageBlockSection>
                
                <!-- COLOMBIA - START -->
                <apex:pageBlockSection title="6. Additional Information - ICA Taxes" columns="2" rendered="{!apcountryisocode='CO'}">
                    <tr class="aplabel">
                        <td colspan="2">City where the Industry and Commerce Tax (ICA) percentage applies.<br/>If your Airline is legally obliged to pay ICA in more than one city, please identify all cities and indicate the applicable ICA percentage.</td>
                    </tr>
                    <apex:pageBlockTable value="{!cityList}" var="city" columnsWidth="10%, 30%, 20%, 40%" >
                        <apex:column style="text-align:center" headerClass="columnTitleCenter" > 
                            <apex:facet name="header">
                               Selected
                            </apex:facet>
                            <apex:inputCheckBox value="{!city.selected}" id="theCheckBox" onchange="changePercentBox('{!$Component.thePercentBox}', '{!$Component.theCheckBox}', '{!$Component.thePanel}');" />
                        </apex:column>
                        <apex:column > 
                            <apex:facet name="header">
                               City
                            </apex:facet>
                            {!city.city}
                        </apex:column>
                        <apex:column > 
                            <apex:facet name="header">
                                ICA Percentage <br/><span style="font-weight:normal !important; font-style:italic">Please enter numbers and decimals only, e.g. [9.66/1000] or [9.66 x mil] should be entered as 9.66</span>
                            </apex:facet>
                            <apex:outputPanel id="thePanel" style="{!IF (city.selected, '', 'display:none')}" >
                                <apex:inputText onchange="checkPercentage('{!$Component.thePercentBox}')" onkeypress="return onlyNumbers(event);" value="{!city.percentage}" id="thePercentBox" />
                            </apex:outputPanel>
                        </apex:column>
                        <apex:column >
                        </apex:column>
                    </apex:pageBlockTable>
                </apex:pageBlockSection>
                
                <!-- CANADA - START -->
                <apex:pageBlockSection title="6. Local VAT Information" columns="1" rendered="{!apcountryisocode='CA'}">
                    <apex:outputText escape="false">
                        The following local VAT information is required for Airlines maintaining an office in Canada.<br/>
                    For Airlines with more than one office location in Canada, the information is needed only for the Main office.
                        <br/><br/>
                    GST = Goods and services tax (federal)<br/>
                    HST = Harmonized sales tax (federal+provincial)<br/>
                    QST = Quebec sales tax (provincial only Quebec)<br/>
                    <br/>
                        <b>The type of tax applicable depends on the province where the Canada main office is located.</b><br/>
                        Airlines with no direct/principal office in Canada and are being represented by a GSA are not required to provide the local VAT information of the GSA.
                    </apex:outputText>
                            
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel style="color:#a31717; font-weight: bold !important;" value="* Does your Airline have a direct/principal office in Canada?"/>
                        <apex:inputField value="{!newForm.Canada_Has_Principal_Office__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* If YES, please select the provincial location and GST/HST/QST information below?"/>
                        <apex:inputField value="{!newForm.Canada_Provincial_Offices__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="* GST/HST/QST information"/>
                        <apex:inputField value="{!newForm.Canada_LocalVAT_Info__c}"/>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
           </div>     
         </apex:pageBlock>
          
        </apex:form>
        
     </div>   
     </div>    
    
    <apex:actionStatus onstart="startLoading();" onstop="endLoading();" id="loadStatusSpinner"/>
    <style>
        .overlay {
            display: none;
            height: 100%;
            left: 0;
            position: fixed;
            top: 0;
            opacity: 0.3;
            -moz-opacity: 0.3;
            width: 100%;
            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=30)";
            filter: alpha(opacity=30);
            background: #000;
            -khtml-opacity: 0.3;
            z-index: 1000;
        }
        .loader {
            background: url('/img/loading32.gif') scroll no-repeat 0 0;
            width: 32px;
            height: 32px;
            position: absolute;
            left: 50%;
        }
    </style>
 
    <div id="load_scrl" class="loadingBox loader" style="display:none"> </div>
    <div class="loadingBox overlay"> </div>

    <script type="text/javascript">
        function startLoading(){
            $('#load_scrl').css('top', $(document).scrollTop() + 200);
            $('.loadingBox').show();
        }
        function endLoading(){
             $('.loadingBox').hide();
        }
    </script>
    
</apex:page>