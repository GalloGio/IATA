<apex:page controller="ISSP_ANG_ANNUAL_REVALIDATION" cache="false" sidebar="false" showHeader="false" standardStylesheets="true"
    applyBodyTag="false" applyHtmlTag="false">

    <html>

    <c:ISSP_Header communityName="{!communityName}"></c:ISSP_Header>

    <body>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/themes/default/style.min.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/jstree.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

        <style>
            .section-header {
                background-color: rgb(43, 120, 228);
                color: white;
                line-height: 1.42857143;
                padding: 8px;
                vertical-align: top;
                border-top: 1px solid #ddd;
            }

            .section-header>i {
                color: black;
                margin-right: 5px;
            }

            .pbBody {
                padding-left: 10px !important;
            }

            .pbBody a {
                color: #337ab7 !important
            }

            .bPageBlock {
                border-top-width: thin !important;
            }

            .bEditBlock input {
                vertical-align: top !important;
            }

            .btn {
                padding: 2px 12px !important;
            }

            .btn-primary {
                color: #fff !important;
                background: inherit !important;
                background-color: #337ab7 !important;
                border-color: #2e6da4 !important;
                border: 1px solid transparent !important;
                /*background: */
            }

            .tb-header {
                padding-right: 20px;
            }

            .modalrow {
                padding-top: 10px;
            }

            input+label {
                font-weight: normal;
            }

            ul li,
            ol li {
                margin-left: inherit;
                padding-left: inherit;
            }

            #contentWrapper {
                background: #fff !important;
                margin: 0 auto;
                max-width: 1170px;
            }

            .requiredText {
                display: none;
            }

            .dateFormat {
                display: none;
            }

            .errorMsg {
                color: #d74c3b
            }

            .progress-bar-off {
                color: #6BBBEA;
                font-weight: bold;
                background-image: none !important;
                background-color: transparent !important;

            }

            .progress-bare {
                float: left;
                width: 0;
                font-size: 12px;
                line-height: 20px;
                color: #fff;
                text-align: center;
                background-color: #337ab7;
                -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, .15);
                box-shadow: inset 0 -1px 0 rgba(0, 0, 0, .15);
                -webkit-transition: width .6s ease;
                -o-transition: width .6s ease;
                transition: width .6s ease;

            }

            body .bPageBlock .pbBody .pbSubheader {
                background-image: url('') !important;
                background-color: #1797c0;
                color: #fff;
            }

            body .bPageBlock .pbBody .summary-subsection .pbSubheader {
                background-image: url('') !important;
                background-color: initial;
                color: initial;
            }

            .pbSubheader {
                font-weight: bold;
                font-size: 15px;
            }

            .contact-detail {
                font-size: 12px;
                margin-bottom: 3px;
            }

            .tbFooter {
                text-align: right;
            }

            .requiredBlock {
                width: 5px !important;
            }

            .checkbox-td {
                text-align: center;
            }

            .summary-table th {
                text-align: center;
            }

            .summary-table td.dataCell {
                border: 1px solid #e0e3e5 !important;
            }

            .col1 {
                padding-bottom: 5px;
                width: 40%;
                vertical-align: text-top;
                font-weight: bold
            }

            .col1_regular {
                padding-bottom: 5px;
                width: 25%;
                vertical-align: text-top;
                font-weight: bold
            }

            .col2 {
                width: 60%;
                padding-left: 50px;
                vertical-align: text-top;
            }

            .col2_regular {
                width: 25%;
                padding-left: 50px;
                vertical-align: text-top;
            }

            .col2_4 {
                width: 10%;
                padding-left: 5px;
                vertical-align: text-top;
            }

            .col3 {
                width: 50%;
                vertical-align: text-top;
            }

            .col1_inner {
                width: 25%;
                vertical-align: text-top;
            }

            .col2_inner {
                width: 25%;
                vertical-align: text-top;
            }

            .row1 {
                padding-bottom: 16px;
                vertical-align: text-top;
            }

            .btn {
                background: none;
            }

            .colPanel1 {
                width: 30%;
                font-weight: bold;
                padding-bottom: 10px
            }

            .colPanel2 {
                width: 65%;
                font-weight: normal !important;
            }

            div.customTable {
                width: 100%;
            }

            div.customTable>div:nth-child(2n-1) {
                padding-top: 5px;
                width: 20%;
                float: left;
            }

            div.customTable>div:nth-child(2n) {
                padding-top: 5px;
                width: 80%;
                float: left;
            }
        </style>

        <script>
            function gotoStep1(myValue, nextStep) {
                console.log('myValue ' + myValue + ' nextStep ' + nextStep);
                //defaultHQCountry = '{!newCase.IFAP_Country_ISO__c}';
                if ($('#brcountry').css('display') == 'none') {
                    checkBranchAbroad(nextStep);
                }

                var $lists = $('select[name="' + '{!$Component.step1Form.step1Block.officetypelist}' + '"]');
                vOfficeType = $lists.val();
                var cargoAgentTypes = ["IATA Cargo Agent", "EACP Intermediary", "CASS Associate", "Courier", "Import Agent"];
                console.log('no empty voffice ' + vOfficeType);
                isAllowedCountry = 't';
            }
        </script>

        <div class="container">
            <div id="contentWrapper">
                <c:ISSP_CustomNavigation communityName="{!communityName}" />

                <apex:outputText rendered="{!isStep1}">
                    <div class="panel-primary">
                        <div class="panel-heading head_panel_green">
                            <h3 class="panel-title">{!$Label.ISSP_ANG_ANNUAL_REVALIDATION}</h3>
                        </div>
                        <div class="panel-body" id="body-enquiries">
                            <apex:form id="step1Form" styleClass="form-horizontal">
                                <apex:pageBlock id="step1Block" mode="edit">
                                    <!--Step Progress bar start -->

                                    <div class="progress">
                                        <div class="progress-bar progress-bar" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 22%">
                                            {!$Label.ISSP_ANG_Step1_ANNUAL_REV}
                                        </div>
                                        <div class="progress-bare progress-bar-off" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 22%">
                                            <apex:commandLink styleclass="btn btn-default" action="{!save}" onclick="gotoStep1('{!$Component.step1Form.step1Block.operationType}', '2');"
                                                value="{!$Label.ISSP_ANG_Step2_ANNUAL_REV}" id="Next3">
                                                <apex:param value="3" assignTo="{!step1GoToNumber}" name="step1GoToNumber" />
                                            </apex:commandLink>
                                        </div>
                                    </div>

                                    <apex:pageMessages id="msg" />
                                    <!--Step Progress bar End -->

                                    <apex:outputPanel>
                                        <div class="customTable">
                                            <!-- --------------- -->
                                            <!-- IATA CODES TREE -->
                                            <!-- --------------- -->
                                            <div>
                                                <div id="frmt">
                                                </div>
                                            </div>

                                            <!-- --------- -->
                                            <!-- WORK AREA -->
                                            <!-- --------- -->
                                            <div>
                                                <div>
                                                    <apex:outputText value="{!$Label.ISSP_ANG_ANNUAL_REV_WORK_AREA_TITLE}"></apex:outputText>
                                                    <div class="panel panel-default">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </apex:outputPanel>


                                    <!-- -------------- -->
                                    <!-- Bottom buttons -->
                                    <!-- -------------- -->
                                    <apex:pageBlockButtons location="bottom" style="padding-left:218px">
                                        <apex:actionStatus id="buttonLoadingStep1">
                                            <apex:facet name="stop">
                                                <apex:outputPanel>
                                                    <apex:commandButton styleclass="btn btn-default" style="margin-right:8px" action="{!cancel}" value="{!$Label.ISSP_Cancel}"
                                                        immediate="true" status="buttonLoadingStep1" reRender="step1Form" />
                                                    <apex:commandButton styleclass="btn btn-default" action="{!save}" onclick="gotoStep1('{!$Component.step1Form.step1Block.operationType}', '2');"
                                                        value="{!$Label.ISSP_Next}" status="buttonLoadingStep1" reRender="step1Form"
                                                    />
                                                </apex:outputPanel>
                                            </apex:facet>
                                            <apex:facet name="start">
                                                <apex:outputPanel>
                                                    <apex:commandButton styleclass="btn btn-default" style="margin-right:8px" value="{!$Label.ISSP_Cancel}..." disabled="true"
                                                        reRender="step1Form" />
                                                    <apex:commandButton styleclass="btn btn-default" value="{!$Label.ISSP_Next}..." disabled="true" reRender="step1Form" />
                                                </apex:outputPanel>
                                            </apex:facet>
                                        </apex:actionStatus>
                                    </apex:pageBlockButtons>

                                </apex:pageBlock>
                            </apex:form>
                        </div>
                    </div>
                </apex:outputText>

                <apex:outputText rendered="{!isStep2}">
                    <div class="panel-primary">
                        <div class="panel-heading head_panel_green">
                            <h3 class="panel-title">{!$Label.ISSP_ANG_Voluntary_Relinquishment}</h3>
                        </div>
                        <div class="panel-body" id="body-enquiries">
                            <apex:form>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-off" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 22%">
                                        <apex:commandLink styleclass="btn btn-default" action="{!goToStep1}" value="{!$Label.ISSP_ANG_Step1_ANNUAL_REV}" id="Prev1Submit"
                                        />
                                    </div>
                                    <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 22%">
                                        {!$Label.ISSP_ANG_Step2_ANNUAL_REV}
                                    </div>
                                </div>
                            </apex:form>
                            <apex:pageBlock>
                            </apex:pageBlock>
                        </div>
                    </div>

                    <!-- -------------- -->
                    <!-- Bottom buttons -->
                    <!-- -------------- -->
                    <apex:form id="tCondiForm">
                        <apex:pageMessages />

                        <apex:pageBlock>
                            <apex:pageBlockButtons location="bottom" style="padding-left:100px">
                                <apex:actionStatus id="buttonLoadingStep3">
                                    <apex:facet name="stop">
                                        <apex:outputPanel>
                                            <apex:commandButton styleclass="btn btn-default" style="margin-right:8px" action="{!goToStep1}" value="{!$Label.ISSP_Back}"
                                                immediate="true" status="buttonLoadingStep3" reRender="tCondiForm" />
                                            <apex:commandButton styleclass="btn btn-default" action="{!saveDraft}" value="{!$Label.ISSP_Save_Draft}" style="float:right"
                                                status="buttonLoadingStep3" reRender="tCondiForm" />
                                            <apex:commandButton styleclass="btn btn-default" action="{!submitForm}" value="{!$Label.ISSP_AMS_Submit_IATA}" status="buttonLoadingStep3"
                                                reRender="tCondiForm" />
                                        </apex:outputPanel>
                                    </apex:facet>
                                    <apex:facet name="start">
                                        <apex:outputPanel>
                                            <apex:commandButton styleclass="btn btn-default" style="margin-right:8px" value="{!$Label.ISSP_Back}..." disabled="true"
                                                reRender="tCondiForm" />
                                            <apex:commandButton styleclass="btn btn-default" value="{!$Label.ISSP_AMS_Submit_IATA}..." disabled="true" reRender="tCondiForm"
                                            />
                                            <apex:commandButton styleclass="btn btn-default" value="{!$Label.ISSP_Save_Draft}..." disabled="true" style="float:right"
                                                reRender="tCondiForm" />
                                        </apex:outputPanel>
                                    </apex:facet>
                                </apex:actionStatus>
                            </apex:pageBlockButtons>
                        </apex:pageBlock>
                    </apex:form>

                </apex:outputText>
            </div>

            <c:ISSP_CustomFooter />
        </div>
    </body>

    <script>
        $('#frmt').jstree(JSON.parse('{!tree}'));

        $('#frmt').on("changed.jstree", function (e, data) {

            if(data.selected.length == 1) {
                console.log(data.instance.get_node(data.selected[0]).text);
            }

        });
    </script>

    </html>
</apex:page>