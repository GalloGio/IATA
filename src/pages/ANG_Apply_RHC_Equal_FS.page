<apex:page controller="ANG_Apply_RHC_Equal_FS_Controller" showHeader="true" docType="html-5.0">
	<script>

	</script>

	<apex:sectionHeader title="Apply RHC equal FS"/>
	<apex:form>

		<apex:actionFunction name="changeInput" reRender="actionModeBlock"/>
		<apex:actionFunction name="enableSearchButton" reRender="searchButton"/>
        <apex:actionFunction name="getAgenciesTable" reRender="searchResultsBlock"/>
        <apex:actionFunction name="refreshPageSize" action="{!refreshPageSize}" status="fetchStatus" reRender="searchResultsBlock"/>

		<apex:pageBlock mode="edit">
			<apex:pageBlockSection columns="1" title="Action and Mode" id="actionModeBlock">

				<apex:pageblockSectionItem id="actionSelection">
				    <apex:outputLabel value="Action"/>
				    <apex:outputPanel>
				        <apex:selectList size="1" value="{!actionValue}" onchange="enableSearchButton();">
				            <apex:selectoptions value="{!actions}"/>
				        </apex:selectList>
				    </apex:outputPanel>
				</apex:pageblockSectionItem>

				<apex:pageblockSectionItem id="modeSelection">
				    <apex:outputLabel value="Mode"/>
				    <apex:outputPanel>
				        <apex:selectList size="1" value="{!modeValue}" onchange="changeInput(); enableSearchButton();">
				            <apex:selectoptions value="{!modes}"/>
				        </apex:selectList>
				    </apex:outputPanel>
				</apex:pageblockSectionItem>

				<apex:pageblockSectionItem id="bspSelection" rendered="{!modeValue == 'BSP'}">
				    <apex:outputLabel value="Select a BSP Code"/>
				    <apex:outputPanel>
				        <apex:selectList size="1" value="{!bspValue}" onchange="enableSearchButton();">
				            <apex:selectoptions value="{!bsps}"/>
				        </apex:selectList>
				    </apex:outputPanel>
				</apex:pageblockSectionItem>

				<apex:pageblockSectionItem id="iataCodeText" rendered="{!modeValue == 'IATA_Code'}">
				    <apex:outputLabel value="Please insert the IATA Code"/>
				    <apex:outputPanel>
				        <apex:inputText value="{!iataCode}" id="iataCodeInput" onkeyup="enableSearchButton();"/>
				    </apex:outputPanel>
				</apex:pageblockSectionItem>
				
			</apex:pageBlockSection>

			<apex:pageBlockButtons id="searchButtonBlock" location="bottom">
	    		<apex:commandButton value="Search Agencies" id="searchButton" disabled="{!OR(OR(actionValue == '', modeValue == ''), AND(modeValue == 'BSP', bspValue == ''), AND(modeValue == 'IATA_Code', iataCode == null))}" action="{!fetchAgencies}" onclick="getAgenciesTable"/>
	    		<apex:commandButton value="{!IF(actionValue == 'Apply_RHC', 'Apply RHC equal FS', 'Revert RHC equal FS')}" id="confirmButton" rendered="{!actionValue != ''}"/>
			</apex:pageBlockButtons>
		</apex:pageBlock>

		<apex:pageBlock mode="edit" id="searchResultsBlock" rendered="{!agencies != null}">
            <apex:pageBlockSection columns="1" title="Results">
            	<apex:PageMessages id="msgs"/>
				<apex:pageBlockTable value="{!agencies}" var="a" rendered="{!agencies.SIZE > 0}">
					<apex:column value="{!a.Name}"/>
					<apex:column value="{!a.IATACode__c}"/>
                    <apex:column value="{!a.Location_Class__c}"/>
                    <apex:column value="{!a.Location_Type__c}"/>
                    <apex:column value="{!a.Status__c}"/>
                    <apex:column value="{!a.IATA_ISO_Country__c}"/>
                    <apex:column value="{!a.IATA_ISO_Country__r.AMS_Settlement_System__c}"/>
				</apex:pageBlockTable>
            </apex:pageBlockSection>
            
            <apex:pageBlockButtons id="pageButtonBlock" location="bottom" rendered="{!modeValue == 'BSP'}">
                Display records per page &nbsp;
                <apex:selectList value="{!size}" size="1" onchange="refreshPageSize();">
					<apex:selectOptions value="{!paginationSizeOptions}"/>
				</apex:selectList>
				<apex:commandButton value="First Page" action="{!first}" disabled="{!ssController == null || NOT(ssController.hasPrevious)}" reRender="searchResultsBlock" rendered="{!ssController != null}"/>
				
				<apex:commandButton value="Previous Page" action="{!previous}" disabled="{!ssController == null || NOT(ssController.hasPrevious)}" reRender="searchResultsBlock" rendered="{!ssController != null}"/>
				
				<apex:commandButton value="Next Page" action="{!next}" disabled="{!ssController == null || NOT(ssController.hasNext)}" reRender="searchResultsBlock" rendered="{!ssController != null}"/>
				
				<apex:commandButton value="Last Page" action="{!last}" disabled="{!ssController == null || NOT(ssController.hasNext)}" reRender="searchResultsBlock" rendered="{!ssController != null}"/>
	    		
			</apex:pageBlockButtons>
 			
        </apex:pageBlock>
	</apex:form>
</apex:page>