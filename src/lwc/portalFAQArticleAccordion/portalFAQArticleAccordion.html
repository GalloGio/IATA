<template>
    <div class="bottomLightGrayBorder slds-m-around_small">
        <lightning-icon icon-name="utility:search" size="small"></lightning-icon>
        <lightning-input name="newRecipientTextInput"
            placeholder={label.CSP_SearchFAQ}
            class="hideInputLabel borderlessInput grayInputBackground grayInputPlaceholder searchStyle"
            value={searchText}
            onchange={onInputchange}>
        </lightning-input>
    </div>
    <!-- ARTICLES -->
    <div class="slds-p-vertical_xx-large slds-p-horizontal_x-large customBorderlessCardWhite">  
        <template if:true={hasArticles} for:each={articles} for:item="article">
            <div class="slds-p-vertical_medium slds-m-around_small borderStyle" key={article.id}>
                <div class="customCardTitleBox cursorPointer" onclick={articleSelected} data-item={article.label} data-id={article.id}>
                    <lightning-icon class="darkBlueIcon" if:true={article.open} icon-name="utility:chevrondown" size="xx-small" data-item={article.label} data-id={article.id}></lightning-icon>
                    <lightning-icon class="darkBlueIcon" if:false={article.open} icon-name="utility:chevronright" size="xx-small" data-item={article.label} data-id={article.id}></lightning-icon>
                    <span class="slds-p-left_small text-bold" data-item={article.label} data-id={article.id}>{article.label}</span>
                </div>        
                <div if:true={article.open} class="slds-p-vertical_x-large text-xsmall" style="transition: height 0.3s ease;" data-item={article.label}>
                    <!-- ARTICLE -->
                    <div class="slds-m-bottom_medium">
                        <lightning-formatted-rich-text value={article.value}></lightning-formatted-rich-text>
                    </div>
                    
                    <!-- FEEDBACK -->
                    <div if:false={article.feedback} class="slds-m-vertical_x-large slds-p-around_large WarningRectangle">
                        <lightning-layout horizontal-align="spread">
                            <lightning-layout-item class="text-bold">
                                {label.CSP_ArticleHelpful}
                            </lightning-layout-item>
                            <lightning-layout-item class="cursorPointer"> 
                                <lightning-icon class="slds-p-around_x-small" icon-name="utility:up" size="x-small" onclick={feedbackStatus} data-item={article.id} data-title={article.label} data-number={article.number} data-option="true"></lightning-icon>
                                <lightning-icon class="slds-p-around_x-small" icon-name="utility:down" size="x-small" onclick={renderModal} data-item={article.id} data-title={article.label} data-number={article.number} data-option="false"></lightning-icon>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>

                    <div if:true={article.feedback} class="slds-m-vertical_x-large slds-p-around_large WarningRectangle">
                        <lightning-layout horizontal-align="spread">
                            <lightning-layout-item>
                                {label.CSP_ThanksFeedback}
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>

                    <!-- RELATED ARTICLES -->
                    <div class="slds-p-vertical_x-large">
                        <c-portal-f-a-q-related-article article={articleInfo}></c-portal-f-a-q-related-article>
                    </div>
                    <!-- REACHS US BANNER -->
                    <div class="slds-p-vertical_x-large">
                        <c-portal-f-a-q-reach-us-banner category={category} topic={topic} sub-topic={subTopic}></c-portal-f-a-q-reach-us-banner>
                    </div> 
                </div>
            </div>
        </template>
        <template if:false={hasArticles}>
            <!-- REACHS US BANNER -->
            <div class="slds-p-vertical_x-large">
                <c-portal-f-a-q-reach-us-banner category={category} topic={topic} sub-topic={subTopic}></c-portal-f-a-q-reach-us-banner>
            </div>
        </template>
    </div>

    <!-- FEEDBACK DOWN OPTION -->
    <template if:true={renderedModal}>
        <div class="modal">
            <div class="customPopupInteriorHalfScreenCentered">
                <!-- HEADER -->
                <div class="slds-p-around_medium modalHeader">
                    {label.CSP_FeedbackTitle}
                </div>
                
                <!-- BODY -->
                <div class="slds-p-around_medium customWhiteBackground">
                    <div class="slds-p-vertical_large modalBody">
                        {label.CSP_FeedbackBody}
                    </div>                        
                </div>

                <div class="aroundLightGrayBorder slds-p-around_small" >
                    <lightning-textarea
                        class="hideInputLabel borderlessInput grayInputPlaceholder"
                        value={articleComments}
                        onchange={feedbackComments}>
                    </lightning-textarea>
                </div>

                <!-- FOOTER -->
                <div class="slds-p-around_medium topLightGrayBorder customWhiteBackground">
                    <div class="slds-m-around_xxx-small">
                            <div class="slds-grid slds-gutters">
                                <div class="slds-col">
                                    <button class="uiButton containedButton containedButton-size" onclick={saveFeedback}>{label.CSP_Submit}</button>
                                </div>
                                <div class="slds-col">
                                    <button class="containedButtonAlt uiButton" onclick={renderModal}>{label.CSP_Cancel}</button>
                                </div>
                            </div>
                    </div>        
                </div>
            </div>
        </div>
    </template>

    <!-- SUBMIT CONFIRMATION -->
    <template if:true={renderConfirmation}>
        <div class="slds-backdrop slds-backdrop_open">
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open"
                style="text-align: center;">
                <lightning-icon icon-name="action:approval" alternative-text="Approved" size="large"
                    class="overlap-top-center"></lightning-icon>
                <div class="slds-modal__container customModal">
                    <div>
                        <h2 id="modal-heading-01"
                            class="slds-text-heading_medium slds-hyphenate slds-align_absolute-center slds-p-top_xx-large">
                            {label.CSP_ThanksFeedback}
                        </h2>
                    </div>
                    <div class="slds-align_absolute-center">
                        <h2 class="text-xxsmall slds-p-top_small slds-align_absolute-center darkgrey-text">
                            {label.CSP_FeedbackBody2}
                        </h2>
                    </div>
                    <div class="slds-align_absolute-center slds-m-around_x-large">
                        <div class="slds-grid slds-gutters">
                            <div class="slds-col">
                                <button class="containedButtonAlt"
                                    onclick={redirectSupport}>
                                    {label.csp_GoToSupport}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </template>    
</template>