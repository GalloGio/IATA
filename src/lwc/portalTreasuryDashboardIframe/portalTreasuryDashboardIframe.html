<template>


    <template if:false={loading}>

        <!-- DASHBOARD HEADER -->
        <div class="slds-col slds-size_1-of-1 slds-small-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1">

            <!-- REPORT NAME -->
            <div class="text-medium text-darkGray text-bold slds-float_left">
                {reportLabel}
            </div>
            <!-- REPORT NAME END -->

            <!-- FULL SCREEN ICON -->
            <template if:true={showEnlarge}>
                <button class="slds-button slds-button_icon slds-float_right top10" onclick={enlarge}>
                    <img class="slds-button_icon small-icon" src={expandIcon}>
                </button>
            </template>
            <!-- FULL SCREEN ICON END -->

            <!-- COLLAPSE/ENLARGE ICONS -->
            <template if:true={showCollapse}>

                <button class="slds-button slds-button_icon slds-float_right slds-m-right_small top10 rotate180 iconCollapse" onclick={collapse}>
                    <img class="slds-button_icon small-icon" src={collapseIcon}>
                </button>

                <button class="slds-button slds-button_icon slds-float_right slds-m-right_small top10 iconCollapseExpand slds-hide" onclick={collapse}>
                    <img class="slds-button_icon small-icon" src={collapseIcon}>
                </button>

            </template>
            <!-- COLLAPSE/ENLARGE ICONS END -->


        </div>
        <!-- DASHBOARD HEADER END -->



        <div class="slds-col slds-size_1-of-1 slds-small-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-vertical_small slds-float_left iframeCard borderless">

            <!-- STANDARD SIZE DASHBOARD -->
            <template if:false={shrink}>
                    <div class="resp-container">
                        <iframe class="resp-iframe" src={powerBiSource}></iframe>
                    </div>
            </template>
            <!-- STANDARD SIZE DASHBOARD END -->


            <!-- SMALL SIZE DASHBOARD -->
            <template if:true={shrink}>

                <!-- PREMIUM USER - DASHBOARD VISIBLE -->
                <template if:true={isPremiumUser}>
                    <div class="collapsible-content">
                        <div class="resp-container-shrink">
                            <!--<iframe class="resp-iframe" src={powerBiSource} style={style}></iframe>-->
                            <iframe class="resp-iframe" src={powerBiSource}></iframe>
                        </div>
                    </div>
                </template>
                <!-- PREMIUM USER - DASHBOARD VISIBLE -->


                <!-- NOT PREMIUM USER - DASHBOARD BLURRED -->
                <template if:false= {isPremiumUser}>

                    <div class="collapsible-content">

                    <div class="centered">
                        <div class="requestButton"><button class="containedButtonSlim" onclick={requestAccessClicked}>Request Access</button></div>
                        <div class="overlay">
                            <div class="overlay-in"></div>
                            <div class="resp-container-shrink">
                                <iframe class="resp-iframe" src={powerBiSource} ></iframe>
                            </div>
                        </div>
                    </div>

                    </div>

                    <!--<div class="centered">
                        <span class="requestButton"><button class="containedButtonSlim" onclick={requestAccessClicked}>Request Access</button></span>
                        <div class="overlay">
                            <div class="overlay-in"></div>
                            <iframe src={powerBiSource} style={style}></iframe>
                        </div>
                    </div>-->

                </template>
                <!-- NOT PREMIUM USER - DASHBOARD BLURRED END -->


            </template>
            <!-- SMALL SIZE DASHBOARD END -->

        </div>



        <!-- DASHBOARD FULLSCREEN START -->
        <div class="myModal slds-hide">
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_large">
                <div class="slds-modal__container">
                    <!-- modal header start -->
                    <header class="slds-modal__header slds-modal__header_empty">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeModal}>
                            <lightning-icon icon-name="utility:close"
                                            alternative-text="close"
                                            variant="inverse"
                                            size="small" ></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <!--<h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Modal Header</h2>-->
                    </header>
                    <!-- modal body start -->
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeModal}>
                            <lightning-icon icon-name="utility:close"
                                            alternative-text="close"
                                            variant="inverse"
                                            size="small" ></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>

                        <!-- DIV FOR POWER BI -->
                        <div class="iframeBig"></div>

                    </div>
                    <!-- modal footer start-->

                </div>
            </section>

            <div class="slds-backdrop slds-backdrop_open"></div>
        </div>
        <!-- DASHBOARD FULLSCREEN END -->


        <!-- REQUEST PREMIUM ACCESS -->
        <div class="requestAccessModal" if:true={showRequestAccess}>
            <div class="requestAccessContainer">
                <div class="slds-p-horizontal_large slds-p-vertical_large mediumTitle text-bold text-small">
                    <span class="slds-float_right slds-m-horizontal_x-small close-mark" onclick={abortRequest}>
                        <lightning-icon icon-name="utility:close" size="x-small" class="cursorPointer" onclick={abortRequest}></lightning-icon>
                    </span>
                    <span>{accessModalHeader}</span>
                </div>
                <!-- MODAL BODY -->
                    <div class="slds-p-vertical_small slds-p-horizontal_large slds-size_1-of-1 customWhiteBackground">
                        <div if:true={requestingAccess}>
                            <lightning-spinner alternative-text="Loading" size="large"></lightning-spinner>
                        </div>
                        <lightning-formatted-rich-text class="richTextlinks introMessage"
                                                       value={accessModalBody}>
                        </lightning-formatted-rich-text>
                    </div>

                <div class="slds-p-around_medium topLightGrayBorder customWhiteBackground slds-clearfix center">
                    <button class="containedButtonAlt containedButton-size slds-m-horizontal_small" onclick={abortRequest}>
                        Cancel
                    </button>
                    <button class="containedButton containedButton-size slds-m-horizontal_small" onclick={requestPremiumAccess}>
                        Confirm
                    </button>
                </div>

                <!--<template if:true={requestingAccess}>
                    <div class="slds-m-around_xx-large slds-is-relative">
                        <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
                    </div>
                </template>-->

            </div>
        </div>
        <!-- REQUEST PREMIUM ACCESS END -->

        <!-- SUCCESS MODAL -->
        <div class="requestAccessModal" if:true={showSuccessModal}>
            <div class="requestAccessContainer">
                <div class="slds-p-horizontal_large slds-p-vertical_large mediumTitle text-bold text-small">
                    <lightning-formatted-rich-text class="richTextlinks introMessage"
                                                   value={labels.ISSP_Access_Requested}>
                    </lightning-formatted-rich-text>
                </div>
                <div class="slds-p-around_medium topLightGrayBorder customWhiteBackground slds-clearfix">
                    <lightning-formatted-rich-text class="richTextlinks introMessage"
                                                   value={labels.ISSP_Thanks_for_request}>
                    </lightning-formatted-rich-text>
                </div>
                <div class="slds-p-around_medium topLightGrayBorder customWhiteBackground slds-clearfix">
                    <div class="slds-align_absolute-center">
                        <lightning-button class="containedButton" label="Close" variant="neutral"
                                          onclick={reloadPage}>
                        </lightning-button>
                    </div>
                </div>
            </div>
        </div>
        <!-- SUCCESS MODAL END -->


    </template>



    <!-- SPINNER -->
    <template if:true={loading}>
        <div class="slds-m-around_xx-large ">
            <lightning-spinner class="spinnerContainer" alternative-text="Loading" size="medium"></lightning-spinner>
        </div>
    </template>


</template>