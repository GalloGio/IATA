<template>

    <div if:true={showBackdrop} class="slds-backdrop slds-backdrop_open" style={mainBackground} onclick={close}></div>

    <template if:false={displayAcceptTerms}>
        <c-portal-accept-terms oncloseacceptterms={logOut} onacceptterms={acceptTerms}></c-portal-accept-terms>
    </template>

    <div class="headerContainer">
        <div class="slds-grid slds-wrap maxWidthHeader">

            <!-- MODAL -->
            <template if:true={openmodel}>
                <section role="dialog" aria-modal="true" style="z-index: 10005;" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header headerTitle">
                            <span>{labels.NotificationDetail}</span>
                            <span class="slds-float_right slds-m-horizontal_x-small close-mark" onclick={closeModal}>
                                <lightning-icon icon-name="utility:close" size="x-small" class="cursorPointer"
                                    onclick={closeModal}></lightning-icon>
                            </span>
                        </header>

                        <div class="slds-is-relative addOverflow">
                            <div class="slds-p-around_large slds-p-horizontal_small slds-p-horizontal_large background">

                                <div class="slds-p-top_small modalType">
                                    <span
                                        class="notificationCenterTextsize text-xxsmall slds-m-left_large notificationTitle">{notification.typeNotification}</span>
                                    <span class="notificationCenterTextsize text-xxsmall slds-m-left_large">
                                        <lightning-formatted-date-time value={notification.createdDate} year="2-digit"
                                            month="short" day="2-digit" hour="numeric" minute="numeric">
                                        </lightning-formatted-date-time>
                                    </span>
                                </div>
                                <div class="slds-hyphenate text-xsmall slds-m-left_large slds-p-top_small">
                                    {notification.subject}
                                </div>
                                <div class="text-xsmall slds-m-left_large slds-p-top_small"
                                    style="text-align: justify; text-justify: inter-word;">
                                    <lightning-formatted-rich-text value={notification.message}>
                                    </lightning-formatted-rich-text>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>


                <!-- END MODAL -->
            </template>

            <div class="customBlueBackground headerBar headerBarLeft headerBarLeftRightWidth slds-show_medium"></div>
            <div class="headerBarLogo slds-p-horizontal_x-small slds-show_medium">
                <span onclick={navigateToHomePage}>
                    <img src={logoIcon}>
                </span>
            </div>
            <div class="slds-col customBlueBackground headerBar headerBarRight">
                <span>
                    <div class="slds-grid headerBarConatiner">
                        <div class={buttonServiceStyle} onclick={navigateToServices}>
                            <img class="slds-m-right_small" src={servicesIcon} />
                            <span
                                class="text-xsmall text-white slds-p-right_x-small tabText slds-show_large">{labels.ISSP_Services}</span>
                        </div>
                        <div class={buttonSupportStyle} onclick={navigateToSupport}>
                            <img class="slds-m-right_small" src={supportIcon} />
                            <span
                                class="text-xsmall text-white slds-p-right_x-small tabText slds-show_large">{labels.CSP_Support}</span>
                        </div>
                        <div class="slds-col_bump-left headerBarButton headerButtonProfileContainer">
                            <img class="slds-m-left_x-small headerButtonProfileIcon" src={profileIcon} />
                            <img class="slds-m-left_x-small headerButtonProfileIconOver" src={profileIconBlue} />
                            <span
                                class="text-xsmall text-white slds-p-left_small slds-p-right_x-small tabText slds-show_large">{labels.ICCS_Profile}</span>
                            <img class="slds-p-right_x-small headerButtonProfileArrow" src={arrowIcon} />
                            <img class="slds-p-right_x-small headerButtonProfileArrowOver" src={arrowIconBlue} />
                            <div class="openProfile customCardWhite">
                                <span class="slds-p-around_small text-xsmall text-black profileOption"
                                    onclick={navigateToMyProfile}>{labels.ISSP_MyProfile}</span>
                                <span if:true={displayCompanyTab}
                                    class="slds-p-around_small text-xsmall text-black profileOption"
                                    onclick={navigateToCompanyProfile}>{labels.CSP_CompanyProfile}</span>
                                <span class="slds-p-around_small text-xsmall text-black profileOption"
                                    onclick={navigateToCases}>{labels.CSP_Cases}</span>
                                <span class="slds-p-around_small text-xsmall text-black profileOption"
                                    onclick={navigateToChangePassword}> {labels.ISSP_Reset_Password} </span>
                                <span class="slds-p-around_small text-xsmall text-black profileOption"
                                    onclick={logOut}>{labels.CSP_LogOut}</span>
                            </div>
                        </div>
                        <div class="slds-m-horizontal_medium slds-p-left_x-small slds-p-vertical_xx-small headerButtonNotificationsContainer"
                            style={headerButtonNotificationsContainerStyle} onclick={toggleNotifications}>
                            <div class="slds-p-horizontal_xx-small notificationNumber text-darkGray"
                                style={notificationNumberStyle}>{numberOfNotifications}</div>
                            <img style={headerButtonNotificationsStyle} src={notificationIcon} />
                            <div class="headerButtonNotificationsCloseIcon"
                                style={headerButtonNotificationsCloseIconStyle}>
                                <div class="closeButton"> + </div>
                            </div>
                        </div>

                        <div class="openNotifications customCardWhite slds-m-horizontal_medium"
                            style={openNotificationsStyle}>
                            <div style={displayBodyStyle}>
                                <div
                                    class="slds-m-around_large notificationCenterTitle text-bold text-medium text-black">
                                    {labels.NotificationCenter} </div>
                                <!--lightning-tabset class="tabContent" tabNotificationCenter-->
                                <lightning-tabset class="tabNotificationCenter">
                                    <div if:true={userAdmin}>
                                        <!-- ALL NOTIFICATION TAB-->
                                        <lightning-tab label={allNotificationTab}>
                                            <div if:true={totalNotification}>
                                                <hr class="hrConfig">
                                                <div
                                                    class="slds-hyphenate text-xsmall slds-m-left_large slds-p-top_medium">
                                                    {labels.CSP_You_Dont_Have_Notifications}
                                                </div>
                                            </div>
                                            <div if:false={totalNotification}>
                                                <template for:each={notificationsList} for:item='not'>
                                                    <hr key={not.id} class="hrConfig">
                                                    <div key={not.id} class={not.styles}>
                                                        <div key={not.id} class="text-bold notificationBox"
                                                            style={displayNotificationStyle} data-item={not.id}>
                                                            <div class="slds-p-top_small" data-item={not.id}>
                                                                <span
                                                                    class="notificationCenterTextsize text-xxsmall slds-m-left_large notificationTitle"
                                                                    data-item={not.id}>{not.typeNotification}</span>
                                                                <span
                                                                    class="notificationCenterTextsize text-xxsmall slds-m-left_large"
                                                                    data-item={not.id}>
                                                                    <lightning-formatted-date-time
                                                                        value={not.createdDate} year="2-digit"
                                                                        month="short" day="2-digit" hour="numeric"
                                                                        minute="numeric">
                                                                    </lightning-formatted-date-time>
                                                                </span>
                                                                <template if:true={not.isNotification}>
                                                                    <template if:false={not.viewed}>
                                                                        <span class="circle cursorPointer tooltipMark"
                                                                            data-item={not.id} data-changebody="1"
                                                                            onclick={onClickAllNotificationsView}>
                                                                            <span class="tooltiptext" data-item={not.id}
                                                                                data-changebody="1"
                                                                                onclick={onClickAllNotificationsView}>{labels.MarkAsRead}</span>
                                                                        </span>
                                                                    </template>
                                                                </template>
                                                            </div>

                                                            <div class="notificationBody text-xsmall slds-m-left_large slds-p-top_small"
                                                                data-item={not.id}>
                                                                <template if:true={not.isNotification}>
                                                                    <span class="cursorPointer" data-item={not.id}
                                                                        data-changebody="1" onclick={openmodal}>
                                                                        {not.subject}
                                                                    </span>
                                                                </template>
                                                                <template if:false={not.isNotification}>
                                                                    <span class="cursorPointer" data-item={not.id}
                                                                        data-changebody="1"
                                                                        onclick={onClickAllNotificationsView}>
                                                                        {not.subject}
                                                                    </span>
                                                                </template>
                                                            </div>

                                                        </div>
                                                    </div>

                                                </template>
                                                <hr class="hrConfig">
                                            </div>
                                        </lightning-tab>
                                    </div>

                                    <!-- ANNOUNCEMENT TAB-->
                                    <lightning-tab label={announcementTab}>
                                        <div if:true={announcementNumber}>
                                            <hr class="hrConfig">
                                            <div class="slds-hyphenate text-xsmall slds-m-left_large slds-p-top_medium">
                                                {labels.CSP_You_Dont_Have_Announcements}
                                            </div>
                                        </div>
                                        <div if:false={announcementNumber}>
                                            <template for:each={notificationsList} for:item='not'>
                                                <template if:true={not.isNotification}>
                                                    <hr key={not.id} class="hrConfig">
                                                    <div key={not.id} class={not.styles}>
                                                        <div key={not.id} class="text-bold notificationBox"
                                                            style={displayNotificationStyle} data-item={not.id}>
                                                            <div class="slds-p-top_small" data-item={not.id}>
                                                                <span
                                                                    class="notificationCenterTextsize text-xxsmall slds-m-left_large notificationTitle"
                                                                    data-item={not.id}>{not.typeNotification}</span>
                                                                <span
                                                                    class="notificationCenterTextsize text-xxsmall slds-m-left_large"
                                                                    data-item={not.id}>
                                                                    <lightning-formatted-date-time
                                                                        value={not.createdDate} year="2-digit"
                                                                        month="short" day="2-digit" hour="numeric"
                                                                        minute="numeric">
                                                                    </lightning-formatted-date-time>
                                                                </span>
                                                                <template if:false={not.viewed}>
                                                                    <span
                                                                        class="circle cursorPointer slds-m-right_small tooltipMark"
                                                                        data-item={not.id} data-changebody="1"
                                                                        onclick={onClickAllNotificationsView}>
                                                                        <span class="tooltiptext" data-item={not.id}
                                                                            data-changebody="1"
                                                                            onclick={onClickAllNotificationsView}>{labels.MarkAsRead}</span>
                                                                    </span>
                                                                </template>
                                                            </div>
                                                            <div class="notificationBody text-xsmall slds-m-left_large slds-p-top_small"
                                                                data-item={not.id}>
                                                                <span class="cursorPointer" data-item={not.id}
                                                                    data-changebody="1" onclick={openmodal}>
                                                                    {not.subject}
                                                                </span>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </template>
                                            </template>
                                            <hr class="hrConfig">
                                        </div>
                                    </lightning-tab>


                                    <!-- TASK TAB-->
                                    <div if:true={userAdmin}>
                                        <lightning-tab label={taskTab}>
                                            <div if:true={taskNumber}>
                                                <hr class="hrConfig">
                                                <div
                                                    class="slds-hyphenate text-xsmall slds-m-left_large slds-p-top_medium">
                                                    {labels.CSP_You_Dont_Have_Tasks}
                                                </div>
                                            </div>
                                            <div if:false={taskNumber}>
                                                <template for:each={notificationsList} for:item='not'>
                                                    <template if:false={not.isNotification}>
                                                        <hr key={not.id} class="hrConfig">
                                                        <div key={not.id} class={not.styles}>
                                                            <div key={not.id} class="text-bold notificationBox"
                                                                style={displayNotificationStyle} data-item={not.id}>
                                                                <div class="slds-p-top_small" data-item={not.id}>
                                                                    <span
                                                                        class="notificationCenterTextsize text-xxsmall slds-m-left_large notificationTitle"
                                                                        data-item={not.id}>{not.typeNotification}</span>
                                                                    <span
                                                                        class="notificationCenterTextsize text-xxsmall slds-m-left_large"
                                                                        data-item={not.id}>
                                                                        <lightning-formatted-date-time
                                                                            value={not.createdDate} year="2-digit"
                                                                            month="short" day="2-digit" hour="numeric"
                                                                            minute="numeric">
                                                                        </lightning-formatted-date-time>
                                                                    </span>
                                                                </div>
                                                                <div class="notificationBody text-xsmall slds-m-left_large slds-p-top_small"
                                                                    data-item={not.id}>
                                                                    <span class="cursorPointer" data-item={not.id}
                                                                        data-changebody="1"
                                                                        onclick={onClickAllNotificationsView}>
                                                                        {not.subject}
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </template>
                                                </template>
                                                <hr class="hrConfig">
                                            </div>
                                        </lightning-tab>
                                    </div>
                                </lightning-tabset>
                            </div>
                        </div>

                        <div class="headerMarginRight slds-m-horizontal_medium slds-p-left_x-small slds-m-vertical_xx-small cursorPointer"
                            onclick={goToAdvancedSearchPage}>
                            <img src={searchWhiteIcon} />
                        </div>
                    </div>
                </span>
            </div>
        </div>
    </div>
</template>