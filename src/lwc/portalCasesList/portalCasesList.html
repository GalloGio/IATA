<template>
    <div class="slds-grid slds-wrap slds-gutters_medium slds-p-top_x-large">
        <!-- Search bar and buttons -->
        <div class="slds-text-align_right slds-p-horizontal_small slds-p-vertical_xx-small slds-col slds-size_1-of-1 slds-medium-size_3-of-12 slds-large-size_3-of-12">
            <div class="bottomLightGrayBorder slds-m-vertical_small inputFilter">
                <img src={searchIconUrl}>
                <lightning-input name="newRecipientTextInput"
                    placeholder={label.CSP_SearchingOn}
                    class="hideInputLabel borderlessInput grayInputBackground grayInputPlaceholder searchStyle"
                    onkeyup={handleKeyUp}
                    onchange={handleInputChange}
                    value={filteringObject.searchText}>
                </lightning-input>
            </div>
        </div>
        <div class="slds-text-align_right slds-p-horizontal_small slds-p-vertical_xx-small slds-col slds-size_1-of-1 slds-medium-size_3-of-12 slds-large-size_3-of-12">
            <!-- FILTER -->
            <button if:true={filtered} class="slds-button_icon slds-button__icon_right filterButton fullWidth" onclick={openCasesFilterModal}>
                {label.CSP_Filtered}
                <img class="slds-float_right" src={filteredIconUrl}>
            </button>
            <button if:false={filtered} class="slds-button_icon slds-button__icon_right filterButton fullWidth" onclick={openCasesFilterModal}>
                {label.CSP_Filter}<img class="slds-float_right" src={filterIconUrl}>
            </button>
        </div>
        <!-- LIST VIEW -->
        <div class="slds-text-align_right slds-p-horizontal_small slds-p-vertical_xx-small slds-col slds-size_1-of-1 slds-medium-size_3-of-12 slds-large-size_3-of-12">    
            <lightning-button label={label.CSP_MyCases} class="containedButton fullWidth" onclick={changeToUserCasesTableView} if:true={viewNormalUserCasesTableViewButton}></lightning-button>
            <lightning-button label={label.CSP_CompanyCases} class="containedButton fullWidth" onclick={changeToAdminCasesTableView} if:true={viewAdminUserCasesTableViewButton}></lightning-button>
        </div>
        <div class="slds-text-align_right slds-p-horizontal_small slds-p-vertical_xx-small slds-col slds-size_1-of-1 slds-medium-size_3-of-12 slds-large-size_3-of-12">
            <lightning-button label={label.CSP_FAQReachUsBanner_ButtonText} class="containedButton fullWidth" onclick={openReachUs}></lightning-button>
        </div>
    </div>

    <!-- Cases list datatable -->
    <div class="customCardWhite slds-m-vertical_small">
        <div class="slds-m-around_medium">
            <div if:true={loading} class="spinnerContainer">
                <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
            </div>
            <div if:false={loading}>
                <div if:true={viewResults} class="casesListWrapper">
                    <lightning-datatable 
                        key-field="Id" 
                        data={casesList} 
                        columns={columns} 
                        hide-checkbox-column min-column-width="140" class="casesListTableClass">
                    </lightning-datatable>
                    <div class="endOfTableCases"></div>
                    <div if:true={loadingMoreResults} class="spinnerContainer">
                        <lightning-spinner class="background-white" alternative-text="Loading"></lightning-spinner>
                    </div>
                </div>
                <div if:false={viewResults}>
                    <c-portal-no-cases-banner></c-portal-no-cases-banner>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL -->
    <div if:true={viewCasesFiltersModal}>
        <section aria-modal="true" class="slds-modal slds-fade-in-open" style="z-index: 10000;">
            <div class="modal">
                <div class="customPopupInteriorHalfScreenCentered">
                    <!-- Popup Header -->
                    <div class="slds-p-horizontal_large slds-p-vertical_medium headerTitle">
                        <span class="modalTitle">{label.CSP_Filter}</span>
                        <span class="slds-float_right slds-m-horizontal_x-small close-mark" onclick={closeCasesFilterModal}>
                            <lightning-icon icon-name="utility:close" size="x-small" class="cursorPointer"
                                onclick={closeCasesFilterModal}></lightning-icon>
                        </span>
                    </div>
                    <div class="customWhiteBackground">
                        <div class="slds-p-horizontal_medium">

                            <!-- Country pick -->
                            <div class="slds-p-around_xx-small">
                                <div class="slds-p-horizontal_large slds-p-vertical_medium">
                                    <lightning-combobox
                                        class="cursorPointerComboBox text-xxsmall customPickList"
                                        label={label.CSP_Search_Case_Country} value={filteringObject.casesComponent.caseCountryFilter}
                                        placeholder=" " options={countryPickOptions}
                                        onchange={countryPickOnchangeHandler}>
                                    </lightning-combobox>
                                </div>
                            </div>
                        </div>

                            <div class="slds-grid slds-p-horizontal_medium">

                            <!-- Creation Date (from) -->
                            <div class="slds-col slds-size_1-of-2 slds-p-around_xx-small">
                                <div class="slds-p-horizontal_large slds-p-vertical_medium" >
                                    <lightning-input 
                                        class="customPickList dateField" 
                                        type="date" 
                                        onchange={dateFromOnchangeHandler}
                                        value={filteringObject.casesComponent.dateFromFilter}
                                        label={label.CSP_DateFrom}>
                                    </lightning-input>
                                </div>
                            </div>

                            <!-- Creation Date (to) -->
                                <div class="slds-col slds-size_1-of-2 slds-p-around_xx-small">
                                    <div class="slds-p-horizontal_large slds-p-vertical_medium" >
                                        <lightning-input 
                                            class="customPickList dateField" 
                                            type="date" 
                                            onchange={dateToOnchangeHandler}
                                            value={filteringObject.casesComponent.dateToFilter}
                                            label={label.CSP_DateTo}>
                                        </lightning-input>
                                    </div>  
                                </div>
                            </div>

                            <!-- Contacts pick -->
                            <div class="slds-p-around_xx-small">
                                <div class="slds-p-horizontal_large slds-p-vertical_medium" if:true={viewContactsFilterPicklist}>
                                    <lightning-combobox
                                        class="cursorPointerComboBox text-xxsmall customPickList"
                                        label={label.ISSP_Contact} value={filteringObject.casesComponent.caseContactFilter}
                                        placeholder=" " options={contactPickOptions}
                                        onchange={contactPickOnchangeHandler}>
                                    </lightning-combobox>
                                </div>
                            </div>

                        <!-- BUTTON -->
                        <div class="slds-align_absolute-center slds-p-around_large slds-grid slds-wrap topLightGrayBorder" style="text-align: center;">
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-button variant="base" label={label.CSP_RemoveAllFilters}
                                    onclick={resetFilters} class="slds-p-right_small blueCustomButtonLink">
                                </lightning-button>
                            </div>
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-button variant="brand" label={label.CSP_Apply}
                                    onclick={applyFilters} class="slds-m-right_medium containedButton fullWidth">
                                </lightning-button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</template>