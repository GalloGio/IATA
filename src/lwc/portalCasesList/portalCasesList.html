<template>

    <div class="slds-grid slds-wrap slds-gutters_direct-small slds-m-top_x-large">

        <!-- Search bar and buttons -->
        <div class="slds-m-vertical_small slds-col slds-size_1-of-1" >
            <div class="slds-grid slds-wrap slds-gutters_direct-small">
                
                <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2" >
                    <div class="bottomLightGrayBorder inputFilter">
                        <img src={searchIconUrl}>
                        <lightning-input name="newRecipientTextInput"
                            placeholder={label.CSP_SearchingOn}
                            class="hideInputLabel borderlessInput grayInputBackground grayInputPlaceholder searchStyle"
                            onkeyup={handleKeyUp}
                            onchange={handleInputChange}
                            value={filteringObject.searchText}>
                        </lightning-input>
                    </div>
                </div>

                <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-text-align_right" >
                    <button class="slds-m-right_small slds-button slds-button_icon slds-button_icon-container slds-button__icon_right filterButton" onclick={openCasesFilterModal} if:true={isFiltered} title="Filtered">
                        {label.CSP_Filtered}<img style="padding-left: 7rem;" src={filterIconUrl}>
                    </button>
                    <button class="slds-m-right_small slds-button slds-button_icon slds-button_icon-container slds-button__icon_right filterButton" onclick={openCasesFilterModal} if:false={isFiltered} title="Filter">
                        {label.CSP_Filter}<img style="padding-left: 7rem;" src={filterIconUrl}>
                    </button>
                    <lightning-button label={label.CSP_MyCases} class="containedButton" onclick={changeToUserCasesTableView} if:true={viewNormalUserCasesTableViewButton}></lightning-button>
                    <lightning-button label={label.CSP_CompanyCases} class="containedButton" onclick={changeToAdminCasesTableView} if:true={viewAdminUserCasesTableViewButton}></lightning-button>
                </div>
            </div>
        </div>

        <!-- Cases list datatable -->
        <div class="slds-col slds-size_1-of-1" >
            <div class="customCardWhite">
                <div class="slds-m-around_medium">

                    <div if:true={loading} class="spinnerContainer">
                        <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
                    </div>
                    
                    <div if:false={loading}>
                        <div if:true={viewResults} >
                            <lightning-datatable key-field="Id" data={casesList} columns={columns} hide-checkbox-column min-column-width="140"></lightning-datatable>
                            <div class="endOfTableCases"></div>
                            <div if:true={loadingMoreResults} class="spinnerContainer">
                                <lightning-spinner class="background-white" alternative-text="Loading"></lightning-spinner>
                            </div>
                        </div>
                        <div if:false={viewResults}>
                            <c-portal-no-cases-banner></c-portal-no-cases-banner>
                        </div>
                    </div>

                </div>
            </div>    

        </div>

    </div>




    <!-- MODAL -->
    <div if:true={viewCasesFiltersModal}>
        <section aria-modal="true" class="slds-modal slds-fade-in-open" style="z-index: 10000;">
            <div class="modal">
                <div class="customPopupInteriorHalfScreenCentered">
    
                    <!-- Popup Header -->
                    <div class="slds-p-horizontal_large slds-p-vertical_medium headerTitle">
                        <span class="modalTitle">Filter</span>
                        <span class="slds-float_right slds-m-horizontal_x-small close-mark" onclick={closeCasesFilterModal}>
                            <lightning-icon icon-name="utility:close" size="x-small" class="cursorPointer"
                                onclick={closeCasesFilterModal}></lightning-icon>
                        </span>
                    </div>
    
                    <div class="customWhiteBackground">

                        <!-- Country pick -->
                        <div class="slds-p-horizontal_large slds-p-vertical_medium" >
                            <lightning-combobox
                                class="cursorPointerComboBox text-xxsmall customPickList "
                                label="Country" value={filteringObject.casesComponent.caseCountryFilter}
                                placeholder=" " options={countryPickOptions}
                                onchange={countryPickOnchangeHandler}>
                            </lightning-combobox>
                        </div>

                        <!-- Contacts pick -->
                        <div class="slds-p-horizontal_large slds-p-vertical_medium" if:true={viewContactsFilterPicklist}>
                            <lightning-combobox
                                class="cursorPointerComboBox text-xxsmall customPickList "
                                label="Contact" value={filteringObject.casesComponent.caseContactFilter}
                                placeholder=" " options={contactPickOptions}
                                onchange={contactPickOnchangeHandler}>
                            </lightning-combobox>
                        </div>

                        <!-- BUTTON -->
                        <div class="slds-align_absolute-center slds-p-around_large slds-grid slds-wrap topLightGrayBorder" style="text-align: center;">
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-button variant="base" label="Remove All Filters"
                                    onclick={resetFilters} class="slds-p-right_small blueCustomButtonLink">
                                </lightning-button>
                            </div>
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-button variant="brand" label="Apply"
                                    onclick={applyFilters} class="slds-m-right_medium containedButton">
                                </lightning-button>
                            </div>
                        </div>

                    </div>
                </div>
                
            </div>
        </section>
    </div>

</template>