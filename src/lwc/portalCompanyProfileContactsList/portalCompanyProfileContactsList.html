<template>
    <div if:true={contactsLoaded} class="fadeInCss">

        <div class="slds-grid slds-wrap">
            <div class="slds-col slds-size_1-of-1">
                <div class="slds-grid slds-wrap slds-grid_align-end slds-m-top_x-large slds-gutters_direct-x-small">

                    <!-- DOWNLOAD CSV -->
                    <div class="slds-col slds-small-size_1-of-2 slds-medium-size_2-of-12 slds-large-size_1-of-5 slds-p-vertical_medium cursorPointer buttonAlignment" onclick={getAllContactsToExport}>
                        <lightning-button class="slds-align-middle text-bold text-xsmall" variant="base" 
                            label={label.ISSP_Download}>
                        </lightning-button>
                        <lightning-icon class="slds-p-left_small darkBlueIcon" icon-name="utility:download" size="x-small"></lightning-icon>
                    </div>

                    <!-- APPROVE -->
                    <div if:true={showManageButtons} class="slds-col slds-small-size_1-of-2 slds-medium-size_2-of-12 slds-large-size_1-of-5 slds-p-vertical_x-small">
                        <lightning-button variant="brand" label={label.ISSP_Activate}
                            class="containedButtonSmaller fullWidth" onclick={grantAccess} data-item="approve">
                        </lightning-button>
                    </div>

                    <!-- DECLINE -->
                    <div if:true={showManageButtons} class="slds-col slds-small-size_1-of-2 slds-medium-size_2-of-12 slds-large-size_1-of-5 slds-p-vertical_x-small">
                        <lightning-button variant="brand" label={label.ISSP_Inactivate}
                            class="containedButtonSmaller fullWidth" onclick={denyAccess} data-item="inactive">
                        </lightning-button>
                    </div>

                    <!-- ASSESSMENT CONTRACT -->
                    <div class="slds-col slds-small-size_1-of-2 slds-medium-size_2-of-12 slds-large-size_1-of-5 slds-p-vertical_x-small">
                        <lightning-button variant="brand" label={label.ISSP_Assign_IFAP}
                            title={label.ISSP_Assign_IFAP} onclick={navigateToIFAP}
                            class="containedButtonSmaller fullWidth">
                        </lightning-button>
                    </div>

                    <!-- LIST VIEW -->
                    <div class="slds-col slds-small-size_1-of-2 slds-medium-size_2-of-12 slds-large-size_1-of-5 slds-p-vertical_x-small">
                        <lightning-button variant="brand" label={label.csp_CreateNewContact} 
                            title={label.csp_CreateNewContact} disabled={contactsNotLoaded}
                            onclick={createContact} class="containedButtonSmaller fullWidth">
                        </lightning-button>
                    </div>

                </div>
            </div>


            <div class="slds-col slds-size_1-of-1">
                <div class="slds-grid slds-wrap">
                    <!-- SEARCH -->
                    <div class="slds-col slds-small-size_1-of-1 slds-medium-size_1-of-3">
                        <div class="bottomLightGrayBorder slds-m-around_small inputFilter">
                            <img src={searchColored}>
                            <lightning-input name="contact-search" type="text" value={contactsFilteringObject.searchInput}
                                placeholder={label.csp_Find_Branch}
                                onchange={onchangeContactsSearchText}
                                class="borderlessInput hideInputLabel grayInputBackground grayInputPlaceholder searchStyle">
                            </lightning-input>
                        </div>
                    </div>
                    <!-- ALPHA FILTERS -->
                    <div class="slds-col slds-small-size_1-of-1 slds-medium-size_2-of-3 alphaFiltersDiv">
                        <template for:each={alphaFilters} for:item="alphaFilter">
                            <span key={alphaFilter.letter} data-item={alphaFilter.letter} class="text-xxxsmall text-darkGray ">
                                <span if:true={alphaFilter.selected} data-item={alphaFilter.letter}
                                    class="slds-m-left_x-small text-bold text-red alphaFilterSelected" >
                                    {alphaFilter.letter}
                                </span>
                                <span if:false={alphaFilter.selected} data-item={alphaFilter.letter}
                                    class="slds-m-left_x-small cursorPointer highlightAlphaFilter" onclick={changeAlphaFilterLetter}>
                                    {alphaFilter.letter}
                                </span>

                            </span>
                        </template>
                    </div>
                </div>
            </div>
        </div>
        

        <div class="slds-grid slds-wrap slds-m-top_x-small">
            <c-portal-contact-list is-account="false" object-name="Contact" class="fullWidth"
                default-sort={contactsFilteringObject.sortField} fields-list={contactFields}
                fields-list-to-create={fieldsListToCreate} records={contacts} wrapper={contactsWrapper}
                openmodel={openmodel} recordid={recordid} accountid={accountid}
                objectid={objectid} ongetcontacts={resetContactsList} fetching={contactsNotLoaded}
                onrefreshview={resetContactsList} onsearchrecords={resetContactsList} search-key={contactsFilteringObject.searchInput} onmanageusers={manageUsers}
                action-name={action}>
            </c-portal-contact-list>

        </div>

        <!-- PAGINATION -->
        <!--<c-portal-paginator pagination-object-parent={paginationObject} onselectedpage={handleSelectedPage}></c-portal-paginator>-->
    </div>

    <div if:false={contactsLoaded} class="spinnerContainer fadeInCss">
        <lightning-spinner class="background-superLightGray" alternative-text="Loading"></lightning-spinner>
    </div>
    
</template>