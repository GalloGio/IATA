<template>
    <div class="customCard">
        <template if:true={loading}>
            <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
        </template>
        <template if:false={loading}>

            <!-- Case details accordion -->
            <div>
                <div class="slds-p-around_medium customCardTitleBox cursorPointer" onclick={toggleCaseDetailsSection}>
                  <lightning-icon data-caseicon class="darkBlueIcon" if:false={showCaseDetailsSection}
                        icon-name="utility:chevronright" size="xx-small"></lightning-icon>
                    <span class="slds-p-left_large">{labels.CaseDetails}</span>
                </div>
                <div data-casediv class="slds-p-around_medium collapsed">
                    <div class="slds-grid slds-wrap slds-p-horizontal_large">
                        <!-- ROW 1 -->
                        <div if:true={hasTopic}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2 slds-p-around_medium">
                            <span class="grey">{labels.Topic__c}</span><br />
                            <span>{caseDetails.Topic__c}</span>
                        </div>
                        <div if:true={hasSubtopic}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2 slds-p-around_medium">
                            <span class="grey">{labels.Subtopic__c}</span><br />
                            <span>{caseDetails.Subtopic__c}</span>
                        </div>

                        <!-- ROW 2 -->
                        <div if:true={hasRegion}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2 slds-p-around_medium">
                            <span class="grey">{labels.Region__c}</span><br />
                            <span>{caseDetails.Region__c}</span>
                        </div>
                        <div if:true={hasCountryConcerned}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2 slds-p-around_medium">
                            <span class="grey">{labels.Country_concerned__c}</span><br />
                            <span>{caseDetails.Country_concerned__c}</span>
                        </div>

                        <!-- ROW 3 -->
                        <div if:true={hasAccountConcerned}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2 slds-p-around_medium">
                            <span class="grey">{labels.RelatedAccount}</span><br />
                            <span>{caseDetails.Account_Concerned__r.IATACode__c}</span>
                        </div>
                        <div if:true={hasTypeOfCasePortal}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2 slds-p-around_medium">
                            <span class="grey">{labels.Type_of_case_Portal__c}</span><br />
                            <span>{caseDetails.Type_of_case_Portal__c}</span>
                        </div>

                        <!-- ROW 4 -->
                        <div if:true={hasDescription}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-p-around_medium">
                            <span class="grey">{labels.Description}</span><br />
                            <span>{caseDetails.Description}</span>
                        </div>

                        <!-- ROW 5 -->
                        <!-- ROW 6 -->
                        <div if:true={optionBuilder}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2 slds-p-around_medium">
                            <div if:true={optionBuilder.isSidraCase}>
                                <span class="grey">{labels.Email}</span><br />
                                <span> <lightning-formatted-email value={caseDetails.Contact.Email} ></lightning-formatted-email></span>
                            </div>
                        </div>

                        <!-- ROW 7 -->
                        <div if:true={optionBuilder}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2 slds-p-around_medium">
                            <div if:true={optionBuilder.isSidraCase}>
                                <span class="grey"> {labels.CSP_IATA_Country} </span><br />
                                <span> {caseDetails.BSPCountry__c} </span>
                            </div>
                        </div>

                        <!-- ROW 8 -->
                        <div if:true={optionBuilder}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2 slds-p-around_medium">
                            <div if:true={optionBuilder.isSidraCase}>
                                <div if:true={caseDetails.Update_AIMS_IRR__c}>
                                    <span class="grey"> {labels.ISSP_SIDRA_Irregularity_Date} </span><br />
                                    <span> <lightning-formatted-date-time value={caseDetails.Update_AIMS_IRR__c}></lightning-formatted-date-time></span>
                                </div>
                            </div>
                        </div>
                        <div if:true={hasSurveyLink}
                             class="slds-col slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-p-around_medium">
                            <span class="grey">{labels.ISSP_Survey}</span><br />
                            <a class="text-blue" href={surveyLink} target="_blank">{labels.Open}</a>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Documents accordion -->
            <div class="topLightGrayBorder">
                <div  class="slds-p-around_medium customCardTitleBox cursorPointer"
                    onclick={toggleDocumentsDetailsSection}>                  
                    <lightning-icon data-docicon class="darkBlueIcon" if:false={showDocumentsSection}
                        icon-name="utility:chevronright" size="xx-small"></lightning-icon>
                    <span class="slds-p-left_large">{labels.DocumentsLabel}</span><span if:true={showNrDocs}>({nrDocs})</span>
                </div>
                <div data-docdiv class="slds-p-around_medium slds-medium-size_1-of-1 slds-m-around-large collapsed" style="transition: height 0.8s ease;">
                    <c-attachment-list-cmp shownorecords=false parentid={caseId} isportal=true
                        show-modal={showAddDocsModal} 
                        no-attachment-msg={labels.AddDocumentsMsg} 
                        onupdateddocs={updateNdocs}
                        accepted-formats={acceptedFormats}>
                    </c-attachment-list-cmp>

                </div>
            </div>

        </template>
    </div>

</template>